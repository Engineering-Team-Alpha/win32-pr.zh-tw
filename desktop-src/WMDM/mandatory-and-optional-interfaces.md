---
title: 必要和選用介面
description: 必要和選用介面
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:
- Windows Media 裝置管理員，介面
- 裝置管理員，介面
- 程式設計指南，介面
- 服務提供者，介面
- 建立服務提供者，介面
- interfaces
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6aaa28db79fe8bc3cd159219cffb35f5434645ea
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103672499"
---
# <a name="mandatory-and-optional-interfaces"></a><span data-ttu-id="54b68-109">必要和選用介面</span><span class="sxs-lookup"><span data-stu-id="54b68-109">Mandatory and Optional Interfaces</span></span>

<span data-ttu-id="54b68-110">下表說明服務提供者要執行的必要和選用介面和方法。</span><span class="sxs-lookup"><span data-stu-id="54b68-110">The following table describes the mandatory and optional interfaces and methods for service providers to implement.</span></span> <span data-ttu-id="54b68-111">必須執行具有一或多個強制方法的所有介面。</span><span class="sxs-lookup"><span data-stu-id="54b68-111">All the interfaces with one or more mandatory methods must be implemented.</span></span> <span data-ttu-id="54b68-112">強制方法無法傳回 WMDM \_ E \_ NOTSUPPORTED 或 E \_ >notimpl。</span><span class="sxs-lookup"><span data-stu-id="54b68-112">A mandatory method cannot return WMDM\_E\_NOTSUPPORTED or E\_NOTIMPL.</span></span>



| <span data-ttu-id="54b68-113">介面和方法</span><span class="sxs-lookup"><span data-stu-id="54b68-113">Interface and method</span></span>                                                                                                                  | <span data-ttu-id="54b68-114">實選項</span><span class="sxs-lookup"><span data-stu-id="54b68-114">Implementation option</span></span>                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="54b68-115">**IMDServiceProvider::EnumDevices**</span><span class="sxs-lookup"><span data-stu-id="54b68-115">**IMDServiceProvider::EnumDevices**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices)                                                             | <span data-ttu-id="54b68-116">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-116">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-117">**IMDServiceProvider::GetDeviceCount**</span><span class="sxs-lookup"><span data-stu-id="54b68-117">**IMDServiceProvider::GetDeviceCount**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount)                                                       | <span data-ttu-id="54b68-118">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-118">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-119">**IMDServiceProvider2::CreateDevice**</span><span class="sxs-lookup"><span data-stu-id="54b68-119">**IMDServiceProvider2::CreateDevice**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice)                                                         | <span data-ttu-id="54b68-120">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-120">Optional.</span></span> <span data-ttu-id="54b68-121">此方法必須針對 PnP 和 Windows 檔案總管支援進行實作為。</span><span class="sxs-lookup"><span data-stu-id="54b68-121">This method must be implemented for PnP and Windows Explorer support.</span></span>                                                                                                                                                                    |
| [<span data-ttu-id="54b68-122">**IMDSPDevice::EnumStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-122">**IMDSPDevice::EnumStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-enumstorage)                                                                           | <span data-ttu-id="54b68-123">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-123">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-124">**IMDSPDevice::GetDeviceIcon**</span><span class="sxs-lookup"><span data-stu-id="54b68-124">**IMDSPDevice::GetDeviceIcon**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon)                                                                       | <span data-ttu-id="54b68-125">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-125">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-126">**IMDSPDevice::GetFormatSupport**</span><span class="sxs-lookup"><span data-stu-id="54b68-126">**IMDSPDevice::GetFormatSupport**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getformatsupport)                                                                 | <span data-ttu-id="54b68-127">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-127">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-128">**IMDSPDevice::GetManufacturer**</span><span class="sxs-lookup"><span data-stu-id="54b68-128">**IMDSPDevice::GetManufacturer**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer)                                                                   | <span data-ttu-id="54b68-129">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-129">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-130">**IMDSPDevice：： GetName**</span><span class="sxs-lookup"><span data-stu-id="54b68-130">**IMDSPDevice::GetName**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getname)                                                                                   | <span data-ttu-id="54b68-131">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-131">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-132">**IMDSPDevice::GetPowerSource**</span><span class="sxs-lookup"><span data-stu-id="54b68-132">**IMDSPDevice::GetPowerSource**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getpowersource)                                                                     | <span data-ttu-id="54b68-133">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-133">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-134">**IMDSPDevice::GetSerialNumber**</span><span class="sxs-lookup"><span data-stu-id="54b68-134">**IMDSPDevice::GetSerialNumber**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getserialnumber)                                                                   | <span data-ttu-id="54b68-135">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-135">Optional.</span></span> <span data-ttu-id="54b68-136">針對受保護的內容傳輸，Windows Media 裝置管理員使用 **IMDSPStorageGlobals：： GetSerialNumber**。</span><span class="sxs-lookup"><span data-stu-id="54b68-136">For protected content transfer, Windows Media Device Manager uses **IMDSPStorageGlobals::GetSerialNumber**.</span></span>                                                                                                                              |
| [<span data-ttu-id="54b68-137">**IMDSPDevice：： GetStatus**</span><span class="sxs-lookup"><span data-stu-id="54b68-137">**IMDSPDevice::GetStatus**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getstatus)                                                                               | <span data-ttu-id="54b68-138">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-138">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-139">**IMDSPDevice：： GetType**</span><span class="sxs-lookup"><span data-stu-id="54b68-139">**IMDSPDevice::GetType**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-gettype)                                                                                   | <span data-ttu-id="54b68-140">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-140">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-141">**IMDSPDevice：： GetVersion**</span><span class="sxs-lookup"><span data-stu-id="54b68-141">**IMDSPDevice::GetVersion**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getversion)                                                                             | <span data-ttu-id="54b68-142">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-142">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-143">**IMDSPDevice::SendOpaqueCommand**</span><span class="sxs-lookup"><span data-stu-id="54b68-143">**IMDSPDevice::SendOpaqueCommand**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand)                                                               | <span data-ttu-id="54b68-144">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-144">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-145">**IMDSPDevice2::GetCanonicalName**</span><span class="sxs-lookup"><span data-stu-id="54b68-145">**IMDSPDevice2::GetCanonicalName**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname)                                                               | <span data-ttu-id="54b68-146">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-146">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-147">**IMDSPDevice2::GetFormatSupport2**</span><span class="sxs-lookup"><span data-stu-id="54b68-147">**IMDSPDevice2::GetFormatSupport2**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2)                                                             | <span data-ttu-id="54b68-148">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-148">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-149">**IMDSPDevice2::GetSpecifyPropertyPages**</span><span class="sxs-lookup"><span data-stu-id="54b68-149">**IMDSPDevice2::GetSpecifyPropertyPages**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages)                                                 | <span data-ttu-id="54b68-150">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-150">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-151">**IMDSPDevice2::GetStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-151">**IMDSPDevice2::GetStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getstorage)                                                                           | <span data-ttu-id="54b68-152">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-152">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-153">**IMDSPDeviceControl 介面**</span><span class="sxs-lookup"><span data-stu-id="54b68-153">**IMDSPDeviceControl Interface**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol)                                                                            | <span data-ttu-id="54b68-154">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-154">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-155">**IMDSPEnumDevice：： Clone**</span><span class="sxs-lookup"><span data-stu-id="54b68-155">**IMDSPEnumDevice::Clone**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-clone)                                                                               | <span data-ttu-id="54b68-156">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-156">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-157">**IMDSPEnumDevice：： Next**</span><span class="sxs-lookup"><span data-stu-id="54b68-157">**IMDSPEnumDevice::Next**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-next)                                                                                 | <span data-ttu-id="54b68-158">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-158">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-159">**IMDSPEnumDevice：： Reset**</span><span class="sxs-lookup"><span data-stu-id="54b68-159">**IMDSPEnumDevice::Reset**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-reset)                                                                               | <span data-ttu-id="54b68-160">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-160">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-161">**IMDSPEnumDevice：： Skip**</span><span class="sxs-lookup"><span data-stu-id="54b68-161">**IMDSPEnumDevice::Skip**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-skip)                                                                                 | <span data-ttu-id="54b68-162">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-162">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-163">**IMDSPEnumStorage：： Clone**</span><span class="sxs-lookup"><span data-stu-id="54b68-163">**IMDSPEnumStorage::Clone**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-clone)                                                                             | <span data-ttu-id="54b68-164">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-164">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-165">**IMDSPEnumStorage：： Next**</span><span class="sxs-lookup"><span data-stu-id="54b68-165">**IMDSPEnumStorage::Next**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-next)                                                                               | <span data-ttu-id="54b68-166">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-166">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-167">**IMDSPEnumStorage：： Reset**</span><span class="sxs-lookup"><span data-stu-id="54b68-167">**IMDSPEnumStorage::Reset**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-reset)                                                                             | <span data-ttu-id="54b68-168">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-168">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-169">**IMDSPEnumStorage：： Skip**</span><span class="sxs-lookup"><span data-stu-id="54b68-169">**IMDSPEnumStorage::Skip**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-skip)                                                                               | <span data-ttu-id="54b68-170">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-170">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-171">**IMDSPObject：： Close**</span><span class="sxs-lookup"><span data-stu-id="54b68-171">**IMDSPObject::Close**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-close)                                                                                       | <span data-ttu-id="54b68-172">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-172">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-173">**IMDSPObject：:D elete**</span><span class="sxs-lookup"><span data-stu-id="54b68-173">**IMDSPObject::Delete**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-delete)                                                                                     | <span data-ttu-id="54b68-174">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-174">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-175">**IMDSPObject：： Move**</span><span class="sxs-lookup"><span data-stu-id="54b68-175">**IMDSPObject::Move**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-move)                                                                                         | <span data-ttu-id="54b68-176">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-176">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-177">**IMDSPObject：： Open**</span><span class="sxs-lookup"><span data-stu-id="54b68-177">**IMDSPObject::Open**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-open)                                                                                         | <span data-ttu-id="54b68-178">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-178">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-179">**IMDSPObject：： Read**</span><span class="sxs-lookup"><span data-stu-id="54b68-179">**IMDSPObject::Read**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-read)                                                                                         | <span data-ttu-id="54b68-180">如果需要 Windows Media Player 支援) ，則強制 (。</span><span class="sxs-lookup"><span data-stu-id="54b68-180">Mandatory (if Windows Media Player support is desired).</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="54b68-181">**IMDSPObject：： Rename**</span><span class="sxs-lookup"><span data-stu-id="54b68-181">**IMDSPObject::Rename**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-rename)                                                                                     | <span data-ttu-id="54b68-182">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-182">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-183">**IMDSPObject：： Seek**</span><span class="sxs-lookup"><span data-stu-id="54b68-183">**IMDSPObject::Seek**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-seek)                                                                                         | <span data-ttu-id="54b68-184">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-184">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-185">**IMDSPObject：： Write**</span><span class="sxs-lookup"><span data-stu-id="54b68-185">**IMDSPObject::Write**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-write)                                                                                       | <span data-ttu-id="54b68-186">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-186">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-187">**IMDSPObjectInfo 介面**</span><span class="sxs-lookup"><span data-stu-id="54b68-187">**IMDSPObjectInfo Interface**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo)                                                                                  | <span data-ttu-id="54b68-188">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-188">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-189">**IMDSPRevoked 介面**</span><span class="sxs-lookup"><span data-stu-id="54b68-189">**IMDSPRevoked Interface**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked)                                                                                        | <span data-ttu-id="54b68-190">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-190">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-191">**IMDSPStorage::CreateStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-191">**IMDSPStorage::CreateStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-createstorage)                                                                     | <span data-ttu-id="54b68-192">只有當 *dwAttributes* 是 WMDM 檔案 ATTR 檔案時，才是必要的 \_ \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="54b68-192">Mandatory only if *dwAttributes* is WMDM\_FILE\_ATTR\_FILE.</span></span>                                                                                                                                                                                        |
| [<span data-ttu-id="54b68-193">**IMDSPStorage::EnumStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-193">**IMDSPStorage::EnumStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-enumstorage)                                                                         | <span data-ttu-id="54b68-194">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-194">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-195">**IMDSPStorage：： GetAttributes**</span><span class="sxs-lookup"><span data-stu-id="54b68-195">**IMDSPStorage::GetAttributes**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getattributes)                                                                     | <span data-ttu-id="54b68-196">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-196">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-197">**IMDSPStorage：： GetDate**</span><span class="sxs-lookup"><span data-stu-id="54b68-197">**IMDSPStorage::GetDate**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getdate)                                                                                 | <span data-ttu-id="54b68-198">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-198">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-199">**IMDSPStorage：： GetName**</span><span class="sxs-lookup"><span data-stu-id="54b68-199">**IMDSPStorage::GetName**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getname)                                                                                 | <span data-ttu-id="54b68-200">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-200">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-201">**IMDSPStorage::GetRights**</span><span class="sxs-lookup"><span data-stu-id="54b68-201">**IMDSPStorage::GetRights**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getrights)                                                                             | <span data-ttu-id="54b68-202">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-202">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-203">**IMDSPStorage：： GetSize**</span><span class="sxs-lookup"><span data-stu-id="54b68-203">**IMDSPStorage::GetSize**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getsize)                                                                                 | <span data-ttu-id="54b68-204">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-204">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-205">**IMDSPStorage::GetStorageGlobals**</span><span class="sxs-lookup"><span data-stu-id="54b68-205">**IMDSPStorage::GetStorageGlobals**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals)                                                             | <span data-ttu-id="54b68-206">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-206">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-207">**IMDSPStorage::SendOpaqueCommands**</span><span class="sxs-lookup"><span data-stu-id="54b68-207">**IMDSPStorage::SendOpaqueCommands**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand)                                                           | <span data-ttu-id="54b68-208">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-208">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-209">**IMDSPStorage：： SetAttributes**</span><span class="sxs-lookup"><span data-stu-id="54b68-209">**IMDSPStorage::SetAttributes**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-setattributes)                                                                     | <span data-ttu-id="54b68-210">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-210">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-211">**IMDSPStorage2::CreateStorage2**</span><span class="sxs-lookup"><span data-stu-id="54b68-211">**IMDSPStorage2::CreateStorage2**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-createstorage2)                                                                 | <span data-ttu-id="54b68-212">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-212">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-213">**IMDSPStorage2::GetAttributes2**</span><span class="sxs-lookup"><span data-stu-id="54b68-213">**IMDSPStorage2::GetAttributes2**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getattributes2)                                                                 | <span data-ttu-id="54b68-214">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-214">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-215">**IMDSPStorage2::GetStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-215">**IMDSPStorage2::GetStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getstorage)                                                                         | <span data-ttu-id="54b68-216">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-216">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-217">**IMDSPStorage2::SetAttributes2**</span><span class="sxs-lookup"><span data-stu-id="54b68-217">**IMDSPStorage2::SetAttributes2**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-setattributes2)                                                                 | <span data-ttu-id="54b68-218">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-218">Optional.</span></span>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="54b68-219">**IMDSPStorage3 介面**</span><span class="sxs-lookup"><span data-stu-id="54b68-219">**IMDSPStorage3 Interface**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3)                                                                                      | <span data-ttu-id="54b68-220">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-220">Optional.</span></span> <span data-ttu-id="54b68-221">但是，如果裝置參數 *UseMetadataViews* 設定為1，則必須實作為此介面，而 **IMDSPStorage3：： GetMetadata** 則會變成強制性，雖然 **IMDSPStorage3：： >setmetadata** 仍然是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="54b68-221">However, if the device parameter *UseMetadataViews* is set to 1, this interface must be implemented, and **IMDSPStorage3::GetMetadata** becomes mandatory, although **IMDSPStorage3::SetMetadata** is still optional.</span></span>                    |
| [<span data-ttu-id="54b68-222">**IMDSPStorageGlobals::GetCapabilities**</span><span class="sxs-lookup"><span data-stu-id="54b68-222">**IMDSPStorageGlobals::GetCapabilities**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities)                                                   | <span data-ttu-id="54b68-223">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-223">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-224">**IMDSPStorageGlobals：： GetDevice**</span><span class="sxs-lookup"><span data-stu-id="54b68-224">**IMDSPStorageGlobals::GetDevice**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice)                                                               | <span data-ttu-id="54b68-225">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-225">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-226">**IMDSPStorageGlobals::GetRootStorage**</span><span class="sxs-lookup"><span data-stu-id="54b68-226">**IMDSPStorageGlobals::GetRootStorage**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage)                                                     | <span data-ttu-id="54b68-227">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-227">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-228">**IMDSPStorageGlobals::GetSerialNumber**</span><span class="sxs-lookup"><span data-stu-id="54b68-228">**IMDSPStorageGlobals::GetSerialNumber**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber)                                                   | <span data-ttu-id="54b68-229">僅限 PDDRM 的必要。</span><span class="sxs-lookup"><span data-stu-id="54b68-229">Mandatory for PDDRM only.</span></span> <span data-ttu-id="54b68-230">否則為選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-230">Optional otherwise.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="54b68-231">**IMDSPStorageGlobals：： GetStatus**</span><span class="sxs-lookup"><span data-stu-id="54b68-231">**IMDSPStorageGlobals::GetStatus**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus)                                                               | <span data-ttu-id="54b68-232">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-232">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-233">**IMDSPStorageGlobals::GetTotalBad**</span><span class="sxs-lookup"><span data-stu-id="54b68-233">**IMDSPStorageGlobals::GetTotalBad**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad)                                                           | <span data-ttu-id="54b68-234">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-234">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-235">**IMDSPStorageGlobals::GetTotalFree**</span><span class="sxs-lookup"><span data-stu-id="54b68-235">**IMDSPStorageGlobals::GetTotalFree**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree)                                                         | <span data-ttu-id="54b68-236">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-236">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-237">**IMDSPStorageGlobals::GetTotalSize**</span><span class="sxs-lookup"><span data-stu-id="54b68-237">**IMDSPStorageGlobals::GetTotalSize**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize)                                                         | <span data-ttu-id="54b68-238">Mandatory。</span><span class="sxs-lookup"><span data-stu-id="54b68-238">Mandatory.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="54b68-239">**IMDSPStorageGlobals：： Initialize**</span><span class="sxs-lookup"><span data-stu-id="54b68-239">**IMDSPStorageGlobals::Initialize**</span></span>](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-initialize)                                                             | <span data-ttu-id="54b68-240">選擇性。</span><span class="sxs-lookup"><span data-stu-id="54b68-240">Optional.</span></span> <span data-ttu-id="54b68-241">如果裝置支援這種功能，則應該執行此方法。</span><span class="sxs-lookup"><span data-stu-id="54b68-241">This method should be implemented if the device supports this functionality.</span></span> <span data-ttu-id="54b68-242">如果未執行此方法，除了任何其他旗標以外， **IMDSPStorageGlobals：： GetCapabilites** 還必須傳回 WMDM \_ STORAGECAP \_ not \_ add。</span><span class="sxs-lookup"><span data-stu-id="54b68-242">If this method is not implemented, **IMDSPStorageGlobals::GetCapabilites** must return WMDM\_STORAGECAP\_NOT\_INITIALIZABLE in addition to any other flags.</span></span> |
| <span data-ttu-id="54b68-243">[**IMDSPDevice3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)[**IMDSPObject2**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)</span><span class="sxs-lookup"><span data-stu-id="54b68-243">[**IMDSPDevice3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)[**IMDSPObject2**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)</span></span><br/> [<span data-ttu-id="54b68-244">**IMDSPStorage4**</span><span class="sxs-lookup"><span data-stu-id="54b68-244">**IMDSPStorage4**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4)<br/> | <span data-ttu-id="54b68-245">支援 Windows Media Player 的自動同步處理所需</span><span class="sxs-lookup"><span data-stu-id="54b68-245">Required to support automatic synchronization with Windows Media Player</span></span>                                                                                                                                                                            |



 

## <a name="related-topics"></a><span data-ttu-id="54b68-246">相關主題</span><span class="sxs-lookup"><span data-stu-id="54b68-246">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="54b68-247">**建立服務提供者**</span><span class="sxs-lookup"><span data-stu-id="54b68-247">**Creating a Service Provider**</span></span>](creating-a-service-provider.md)
</dt> </dl>

 

 





