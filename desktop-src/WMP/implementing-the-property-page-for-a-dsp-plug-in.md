---
title: 執行 DSP 外掛程式的屬性頁
description: 執行 DSP 外掛程式的屬性頁
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Windows Media Player 外掛程式、音訊 DSP
- 外掛程式、音訊 DSP
- 數位信號處理外掛程式，音訊屬性
- DSP 外掛程式、音訊屬性
- 音訊 DSP 外掛程式，屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103839683"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="1a676-108">執行 DSP 外掛程式的屬性頁</span><span class="sxs-lookup"><span data-stu-id="1a676-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="1a676-109">Windows Media Player 可以顯示每個 DSP 外掛程式的屬性頁，讓使用者設定變更外掛程式行為的值。</span><span class="sxs-lookup"><span data-stu-id="1a676-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="1a676-110">使用者可以從 [選項] 對話方塊的 [ **外掛程式** ] 索引標籤中 **，按一下要** 選取的 DSP 外掛程式名稱，然後按一下 [內容]，以存取此屬性頁。</span><span class="sxs-lookup"><span data-stu-id="1a676-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="1a676-111">Windows Media Player 外掛程式 Wizard 範例程式碼提供屬性頁的預設實作為，其中包含單一編輯方塊，可從使用者接收代表音訊音量比例因數的值。</span><span class="sxs-lookup"><span data-stu-id="1a676-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="1a676-112">當使用者按一下 [套用] 時，屬性頁面會將此值傳遞至外掛程式 **物件，讓** 外掛程式可以變更在處理期間用來調整磁片區的值。</span><span class="sxs-lookup"><span data-stu-id="1a676-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="1a676-113">關於屬性頁物件</span><span class="sxs-lookup"><span data-stu-id="1a676-113">About the Property Page Object</span></span>

<span data-ttu-id="1a676-114">屬性頁物件是可實 **IPropertyPage** 介面的 COM 物件。</span><span class="sxs-lookup"><span data-stu-id="1a676-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="1a676-115">外掛程式 wizard 所產生的範例程式碼會使用 **IPropertyPage** 的 ATL 執行，其記載于 MSDN 上的 Visual C++ 檔中。</span><span class="sxs-lookup"><span data-stu-id="1a676-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="1a676-116">您的程式碼至少應該提供 **IPropertyPage：： OnInitDialog** 的覆寫執行，它會處理在屬性頁開啟時所發生的事件，以及 **IPropertyPage：： Apply**（可處理 **使用者按一下 [** 套用] 時所發生的事件）。</span><span class="sxs-lookup"><span data-stu-id="1a676-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="1a676-117">外掛程式 wizard 會產生每個事件處理常式的範例程式碼。</span><span class="sxs-lookup"><span data-stu-id="1a676-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="1a676-118">**OnInitDialog** 的範例會從登錄抓取值，讓它可以顯示目前的縮放比例設定。</span><span class="sxs-lookup"><span data-stu-id="1a676-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="1a676-119">**Apply** 的範例執行會透過測試來驗證使用者輸入，以確保它落在指定的範圍內，然後將值保存到登錄中，然後將值傳遞 (如果 DSP 外掛程式屬性 put 方法的有效) （名為 **put \_ scale**）。</span><span class="sxs-lookup"><span data-stu-id="1a676-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="1a676-120">此外，您還需要新增程式碼來處理使用者變更您在屬性頁中提供的控制項值時所發生的事件。</span><span class="sxs-lookup"><span data-stu-id="1a676-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="1a676-121">例如，外掛程式 wizard 會執行名為 **OnChangeScale** 的函式，此函式只會在使用者變更屬性頁面上編輯方塊中的文字時，藉由呼叫 **SetDirty** 方法，並將引數值 **設為 TRUE**，就能 **啟用 [套用**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="1a676-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="1a676-122">關於屬性頁對話方塊資源</span><span class="sxs-lookup"><span data-stu-id="1a676-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="1a676-123">屬性頁的使用者介面會儲存為對話方塊資源。</span><span class="sxs-lookup"><span data-stu-id="1a676-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="1a676-124">您可以藉由在 [專案工作區] 視窗中選取 [ **ResourceView** ] 索引標籤，然後開啟 **對話方塊** 資料夾，再按兩下屬性頁資源名稱，輕鬆地在 Visual Studio 中查看及編輯 [屬性頁] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="1a676-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="1a676-125">Visual Studio 中的對話方塊資源編輯器提供您所需的工具，以將控制項加入至 [屬性頁] 對話方塊，並建立對應至適當 Windows 訊息的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1a676-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="1a676-126">如需有關如何在 Visual Studio 中使用資源編輯器的詳細資訊，請參閱 Visual Studio 說明。</span><span class="sxs-lookup"><span data-stu-id="1a676-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="1a676-127">關於 ISpecifyPropertyPages</span><span class="sxs-lookup"><span data-stu-id="1a676-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="1a676-128">如果 DSP 外掛程式提供屬性頁，外掛程式必須執行 **ISpecifyPropertyPages** 介面。</span><span class="sxs-lookup"><span data-stu-id="1a676-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="1a676-129">這個介面只包含一個方法： **ISpecifyPropertyPages：： GetPages**。</span><span class="sxs-lookup"><span data-stu-id="1a676-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="1a676-130">這是將屬性頁面與 DSP 外掛程式產生關聯的方法。</span><span class="sxs-lookup"><span data-stu-id="1a676-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="1a676-131">Windows Media Player 會在使用者叫用屬性頁時呼叫這個方法，傳遞 CAUUID 類型的參數，也就是 Guid 的計數陣列。</span><span class="sxs-lookup"><span data-stu-id="1a676-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="1a676-132">**GetPages** 的範例外掛程式會以單一 GUID （即外掛程式屬性頁物件的類別識別碼）填滿此結構。</span><span class="sxs-lookup"><span data-stu-id="1a676-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="1a676-133">Windows Media Player 接著會使用類別識別碼來建立屬性頁物件。</span><span class="sxs-lookup"><span data-stu-id="1a676-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="1a676-134">您可能會注意到， **GetPages** 的範例會使用 **COTASKMEMALLOC** 來配置 GUID 結構的記憶體。</span><span class="sxs-lookup"><span data-stu-id="1a676-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="1a676-135">呼叫者（在此案例中 Windows Media Player）的責任是使用 **CoTaskMemFree** 來釋放記憶體。</span><span class="sxs-lookup"><span data-stu-id="1a676-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="1a676-136">如需 CAUUID 結構的詳細資訊，請參閱 Platform SDK 檔。</span><span class="sxs-lookup"><span data-stu-id="1a676-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="1a676-137">關於 Proxy/Stub DLL</span><span class="sxs-lookup"><span data-stu-id="1a676-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="1a676-138">若要讓 DSP 外掛程式在 Windows Vista 上執行的 Windows Media Player 11 中運作，您必須為自訂介面提供 proxy/stub DLL，以用於將設定中的變更從 [屬性頁] 對話方塊傳達給外掛程式類別。</span><span class="sxs-lookup"><span data-stu-id="1a676-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="1a676-139">透過這類介面所進行的方法呼叫，必須在跨進程或單元界限進行呼叫時封送處理。</span><span class="sxs-lookup"><span data-stu-id="1a676-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="1a676-140">最新版的外掛程式 wizard 會建立範例 proxy/存根 DLL 專案。</span><span class="sxs-lookup"><span data-stu-id="1a676-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a676-141">相關主題</span><span class="sxs-lookup"><span data-stu-id="1a676-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a676-142">**執行音訊 DSP 外掛程式**</span><span class="sxs-lookup"><span data-stu-id="1a676-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




