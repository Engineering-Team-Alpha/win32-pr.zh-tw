---
title: 命令事件
description: 命令事件
ms.assetid: 3e180286-dfa0-4b34-90ee-3267ed6f48af
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5647e7eac3aaba0a6094be6b52cc3726eba34ad7
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023445"
---
# <a name="command-event"></a>命令事件

\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**描述**
</dt> <dd>

當使用者選擇 (用戶端的) 命令時發生。

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**語法**
</dt> <dd>

**子***代理程式* \_ **命令** **(ByVal** *userinput> * * * )**



| 部分        | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *Userinput>* | 識別伺服器所傳回的 [**命令**](/windows/desktop/lwef/the-command-object) 物件。 <br/> 您可以從 [**命令**](/windows/desktop/lwef/the-command-object) 物件存取下列屬性：<br/> CharacterID <br/> 字串值，識別接收命令的字元 (識別碼) 名稱。 <br/> [**Name**](name-property.md)<br/> 字串值，識別命令 (識別碼) 的名稱。<br/> [**信賴度**](confidence-property.md)<br/> 長整數值，指出命令的信賴評分。 <br/> [**語音**](voice-property.md) <br/> 識別命令語音文字的字串值。<br/> Alt1Name <br/> 字串值，用來識別下一個 (第二個) 最佳命令的名稱。<br/> Alt1Confidence <br/> 長整數值，指出下一個 (第一個) 最佳命令的信賴分數。<br/> Alt1Voice <br/> 字串值，可識別下一個最佳替代命令相符的語音文字。<br/> Alt2Name <br/> 字串值，識別第三個最佳命令相符項的名稱。<br/> Alt2Confidence <br/> 長整數，識別第三個最佳命令相符項的信賴分數。<br/> Alt2Voice <br/> 字串值，識別第三個最佳命令相符的語音文字。<br/> [**計數**](count-property.md) <br/> 長整數值，指出傳回的替代專案數目。<br/> |



 

</dd> </dl>

### <a name="remarks"></a>備註

當您的應用程式為輸入-主動，且使用者透過朗讀輸入或字元的快顯功能表選擇命令時，伺服器會通知您此事件。 此事件會傳回 [**計數**](count-property.md) 中可能相符的命令數目，以及這些相符專案的名稱、信賴評分和語音文字。

如果語音輸入觸發這個事件，伺服器會傳回一個字串來識別 [**Name**](name-property.md) 參數中最符合的專案，以及 Alt1Name 和 Alt2Name 中的第二個和第三個相符專案。 空字串表示輸入不符合您的應用程式所定義的任何命令;例如，它可以是伺服器定義的其中一個命令。 如果命令符合代理程式的命令，則為。例如，隱藏， **名稱** 參數中會傳回空字串，但您仍會收到 [**聲音**](voice-property.md) 參數中聽到的文字。

您可能會在一個以上的專案中傳回相同的命令名稱。 [**信賴度**](confidence-property.md)、Alt1Confidence 和 Alt2Confidence 參數會將每個對應的語音辨識引擎所傳回的相對分數（範圍介於-100 到100）傳回。 [**Voice**](voice-property.md)、Alt1Voice 和 Alt2Voice 參數會傳回語音辨識引擎針對每個替代方案所符合的語音文字。 如果 [**Count**](count-property.md) 傳回零 (0) ，表示伺服器偵測到說輸入，但卻判斷沒有相符的命令。

如果語音輸入不是命令的來源，例如，如果使用者從字元的快顯功能表中選取命令，伺服器會傳回 [ [**名稱**](name-property.md)] 屬性中所選取命令 (識別碼) 的名稱。 它也會傳回 [**信賴**](confidence-property.md) 參數的值為100，而 [**語音**](voice-property.md) 參數的值為空字串 ( "" ) 。 Alt1Name 和 Alt2Name 也會傳回空字串。 Alt1Confidence 和 Alt2Confidence 會傳回零 (0) ，而 Alt1Voice 和 Alt2Voice 會傳回空字串。 [**Count**](count-property.md) 會傳回1。

> [!Note]  
> 並非所有的語音辨識引擎都可能會傳回此事件所有參數的所有值。 請洽詢您的引擎廠商，判斷引擎是否支援 Microsoft 語音 API 介面，以傳回替代專案和信賴分數。

 

 

