---
title: 如何設計網域著色器
description: 本主題說明如何設計網域著色器。
ms.assetid: 329d4eb9-8886-401d-8fb4-39e06886998f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2a01d6b006c5ffe3afa355abe5e662cb96aa1391
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104092896"
---
# <a name="how-to-design-a-domain-shader"></a><span data-ttu-id="1e981-103">如何：設計定義域著色器</span><span class="sxs-lookup"><span data-stu-id="1e981-103">How To: Design a Domain Shader</span></span>

<span data-ttu-id="1e981-104">網域著色器是三個階段中的第三個，可共同運作以實行 [鑲嵌](direct3d-11-advanced-stages-tessellation.md)式。</span><span class="sxs-lookup"><span data-stu-id="1e981-104">A domain shader is the third of three stages that work together to implement [tessellation](direct3d-11-advanced-stages-tessellation.md).</span></span> <span data-ttu-id="1e981-105">網域著色器會從輪廓著色器和 UV 座標中的已轉換控制點產生表面幾何。</span><span class="sxs-lookup"><span data-stu-id="1e981-105">The domain shader generates the surface geometry from the transformed control points from a hull shader and the UV coordinates.</span></span> <span data-ttu-id="1e981-106">本主題說明如何設計網域著色器。</span><span class="sxs-lookup"><span data-stu-id="1e981-106">This topics shows how to design a domain shader.</span></span>

<span data-ttu-id="1e981-107">針對固定函式鑲嵌所產生的每個點，都會叫用一次網域著色器。</span><span class="sxs-lookup"><span data-stu-id="1e981-107">A domain shader is invoked once for each point generated by the fixed function tessellator.</span></span> <span data-ttu-id="1e981-108">輸入是 \[ \] 修補程式點的 UV W 座標，以及來自輪廓著色器的所有輸出資料，包括控制點和修補常數。</span><span class="sxs-lookup"><span data-stu-id="1e981-108">The inputs are the UV\[W\] coordinates of the point on the patch, as well as all of the output data from the hull shader including control points and patch constants.</span></span> <span data-ttu-id="1e981-109">輸出是以任何想要的方式定義的頂點。</span><span class="sxs-lookup"><span data-stu-id="1e981-109">The output is a vertex defined in whatever way is desired.</span></span> <span data-ttu-id="1e981-110">如果輸出傳送至圖元著色器，輸出必須包含位置 (以 SV \_ 位置語義) 表示。</span><span class="sxs-lookup"><span data-stu-id="1e981-110">If the output is being sent to the pixel shader, the output must include a position (denoted with a SV\_Position semantic).</span></span>

<span data-ttu-id="1e981-111">**設計網域著色器**</span><span class="sxs-lookup"><span data-stu-id="1e981-111">**To design a domain shader**</span></span>

1.  <span data-ttu-id="1e981-112">定義網域屬性。</span><span class="sxs-lookup"><span data-stu-id="1e981-112">Define the domain attribute.</span></span>

    ```
    [domain("quad")]
    ```

    

    <span data-ttu-id="1e981-113">此網域是針對四個修補程式所定義。</span><span class="sxs-lookup"><span data-stu-id="1e981-113">The domain is defined for a quad patch.</span></span>

2.  <span data-ttu-id="1e981-114">宣告具有 [網域位置](/windows/desktop/direct3dhlsl/sv-domainlocation) 系統值的輪廓位置。</span><span class="sxs-lookup"><span data-stu-id="1e981-114">Declare the location on the hull with the [domain location](/windows/desktop/direct3dhlsl/sv-domainlocation) system value.</span></span>

    -   <span data-ttu-id="1e981-115">若有四個修補程式，請使用 float2。</span><span class="sxs-lookup"><span data-stu-id="1e981-115">For a quad patch, use a float2.</span></span>
    -   <span data-ttu-id="1e981-116">針對三個修補程式，請使用 float3 (barycentric 座標) </span><span class="sxs-lookup"><span data-stu-id="1e981-116">For a tri patch, use a float3 (for barycentric coordinates)</span></span>
    -   <span data-ttu-id="1e981-117">若為等值線，請使用 float2。</span><span class="sxs-lookup"><span data-stu-id="1e981-117">For an isoline, use a float2.</span></span>

    <span data-ttu-id="1e981-118">因此，四個修補程式的網域位置看起來像這樣：</span><span class="sxs-lookup"><span data-stu-id="1e981-118">Therefore, the domain location for a quad patch looks like this:</span></span>

    ```
    float2 UV : SV_DomainLocation
    ```

    

3.  <span data-ttu-id="1e981-119">定義其他輸入。</span><span class="sxs-lookup"><span data-stu-id="1e981-119">Define the other inputs.</span></span>

    <span data-ttu-id="1e981-120">其他輸入來自于輪廓著色器，並且是由使用者定義的。</span><span class="sxs-lookup"><span data-stu-id="1e981-120">The other inputs come from the hull shader and are user defined.</span></span> <span data-ttu-id="1e981-121">這包括 patch 的輸入控制點，其中可以有1到32點，以及輸入 patch 常數資料。</span><span class="sxs-lookup"><span data-stu-id="1e981-121">This includes the input control points for patch, of which there can be between 1 and 32 points, and input patch constant data.</span></span>

    <span data-ttu-id="1e981-122">控制點是使用者定義的，通常是使用如下所示的結構 (定義在 [如何：設計輪廓著色器](direct3d-11-advanced-stages-hull-shader-design.md)) ：</span><span class="sxs-lookup"><span data-stu-id="1e981-122">The control points are user defined, usually with a structure such as this one (defined in [How To: Design a Hull Shader](direct3d-11-advanced-stages-hull-shader-design.md)):</span></span>

    ```
    const OutputPatch<BEZIER_CONTROL_POINT, 16> bezpatch
    ```

    

    <span data-ttu-id="1e981-123">修補程式常數資料也是使用者定義的，而且看起來像是 [如何：設計輪廓著色器](direct3d-11-advanced-stages-hull-shader-design.md)) 中定義的 (：</span><span class="sxs-lookup"><span data-stu-id="1e981-123">The patch constant data is also user defined, and might look like this one (defined in [How To: Design a Hull Shader](direct3d-11-advanced-stages-hull-shader-design.md)):</span></span>

    ```
    HS_CONSTANT_DATA_OUTPUT input
    ```

    

4.  <span data-ttu-id="1e981-124">新增使用者定義的程式碼以計算輸出;這構成了網域著色器的主體。</span><span class="sxs-lookup"><span data-stu-id="1e981-124">Add user-defined code to compute the outputs; this makes up the body of the domain shader.</span></span>

    <span data-ttu-id="1e981-125">此結構包含使用者定義的網域著色器輸出。</span><span class="sxs-lookup"><span data-stu-id="1e981-125">This structure contains user-defined domain shader outputs.</span></span>

    ```
    struct DS_OUTPUT
    {
        float3 vNormal    : NORMAL;
        float2 vUV        : TEXCOORD;
        float3 vTangent   : TANGENT;
        float3 vBiTangent : BITANGENT;
        
        float4 vPosition  : SV_POSITION;
    };
    ```

    

    <span data-ttu-id="1e981-126">此函式會從鑲嵌) 採用每個輸入 UV (，並在此位置評估貝塞爾修補程式。</span><span class="sxs-lookup"><span data-stu-id="1e981-126">The function takes each input UV (from the tessellator) and evaluates the Bezier patch at this position.</span></span>

    ```
    [domain("quad")]
    DS_OUTPUT BezierEvalDS( HS_CONSTANT_DATA_OUTPUT input, 
                            float2 UV : SV_DomainLocation,
                            const OutputPatch<BEZIER_CONTROL_POINT, 16> bezpatch )
    {
        DS_OUTPUT Output;

        // Insert code to compute the output here.

        return Output;    
    }
    ```

    

    <span data-ttu-id="1e981-127">函數會針對 fixed 函數鑲嵌所產生的每個點叫用一次。</span><span class="sxs-lookup"><span data-stu-id="1e981-127">The function is invoked once for each point generated by the fixed function tessellator.</span></span> <span data-ttu-id="1e981-128">因為此範例使用四個修補程式，所以輸入網域位置 ([SV \_ DomainLocation](/windows/desktop/direct3dhlsl/sv-domainlocation)) 是 float2 (UV) ; 而三個修補程式會有 float3 輸入位置 (UVW barycentric 座標) ，而等值線會有 float2 輸入網域位置。</span><span class="sxs-lookup"><span data-stu-id="1e981-128">Since this example uses a quad patch, the input domain location ([SV\_DomainLocation](/windows/desktop/direct3dhlsl/sv-domainlocation)) is a float2 (UV); a tri patch would have a float3 input location (UVW barycentric coordinates), and an isoline would have a float2 input domain location.</span></span>

    <span data-ttu-id="1e981-129">函式的其他輸入會直接來自輪廓著色器。</span><span class="sxs-lookup"><span data-stu-id="1e981-129">The other inputs for the function come from the hull shader directly.</span></span> <span data-ttu-id="1e981-130">在此範例中，每一個都是一個 **貝塞爾 \_ 控制點 \_**，以及修補常數資料 (**HS \_ 常數 \_ 資料 \_ 輸出**) ，都是16個控制點。</span><span class="sxs-lookup"><span data-stu-id="1e981-130">In this example it is 16 control points each one being a **BEZIER\_CONTROL\_POINT**, as well as patch constant data (**HS\_CONSTANT\_DATA\_OUTPUT**).</span></span> <span data-ttu-id="1e981-131">在此範例中，輸出是包含任何資料所需 **DS \_ 輸出** 的頂點。</span><span class="sxs-lookup"><span data-stu-id="1e981-131">The output is a vertex containing any data desired - **DS\_OUTPUT** in this example.</span></span>

<span data-ttu-id="1e981-132">設計網域著色器之後，請參閱 [如何：建立網域著色器](direct3d-11-advanced-stages-domain-shader-create.md)。</span><span class="sxs-lookup"><span data-stu-id="1e981-132">After designing a domain shader, see [How To: Create a Domain Shader](direct3d-11-advanced-stages-domain-shader-create.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1e981-133">相關主題</span><span class="sxs-lookup"><span data-stu-id="1e981-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1e981-134">如何使用 Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="1e981-134">How to Use Direct3D 11</span></span>](how-to-use-direct3d-11.md)
</dt> <dt>

[<span data-ttu-id="1e981-135">鑲嵌式總覽</span><span class="sxs-lookup"><span data-stu-id="1e981-135">Tessellation Overview</span></span>](direct3d-11-advanced-stages-tessellation.md)
</dt> </dl>

 

 