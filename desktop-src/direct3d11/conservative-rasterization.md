---
title: Direct3D 11.3 保守的點陣化
description: 保守地柵格化可為圖元轉譯新增一些確定性，這對碰撞偵測演算法特別有用。
ms.assetid: 83F223C0-9282-4149-86CF-471B88829F76
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 003cb7e31c1380943318b34f9308f6b5e72d6e51
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104186071"
---
# <a name="direct3d-113-conservative-rasterization"></a><span data-ttu-id="f052a-103">Direct3D 11.3 保守的點陣化</span><span class="sxs-lookup"><span data-stu-id="f052a-103">Direct3D 11.3 Conservative Rasterization</span></span>

<span data-ttu-id="f052a-104">保守地柵格化可為圖元轉譯新增一些確定性，這對碰撞偵測演算法特別有用。</span><span class="sxs-lookup"><span data-stu-id="f052a-104">Conservative rasterization adds some certainty to pixel rendering, which is helpful in particular to collision detection algorithms.</span></span>

-   [<span data-ttu-id="f052a-105">概觀</span><span class="sxs-lookup"><span data-stu-id="f052a-105">Overview</span></span>](#overview)
-   [<span data-ttu-id="f052a-106">與管線的互動</span><span class="sxs-lookup"><span data-stu-id="f052a-106">Interactions with the pipeline</span></span>](#interactions-with-the-pipeline)
-   [<span data-ttu-id="f052a-107">執行詳細資料</span><span class="sxs-lookup"><span data-stu-id="f052a-107">Implementation details</span></span>](#implementation-details)
-   [<span data-ttu-id="f052a-108">API 摘要</span><span class="sxs-lookup"><span data-stu-id="f052a-108">API summary</span></span>](#api-summary)
-   [<span data-ttu-id="f052a-109">相關主題</span><span class="sxs-lookup"><span data-stu-id="f052a-109">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="f052a-110">概觀</span><span class="sxs-lookup"><span data-stu-id="f052a-110">Overview</span></span>

<span data-ttu-id="f052a-111">保守的點陣化表示所有圖元都是由轉譯的基本型別所涵蓋的所有圖元都是柵格化的，這表示會叫用圖元著色器。</span><span class="sxs-lookup"><span data-stu-id="f052a-111">Conservative rasterization means that all pixels that are at least partially covered by a rendered primitive are rasterized, which means that the pixel shader is invoked.</span></span> <span data-ttu-id="f052a-112">一般行為是取樣，如果已啟用保守的點陣化，則不會使用它。</span><span class="sxs-lookup"><span data-stu-id="f052a-112">Normal behavior is sampling, which is not used if conservative rasterization is enabled.</span></span>

<span data-ttu-id="f052a-113">保守的點陣化在許多情況下都很有用，包括對碰撞偵測、遮蔽剔除和可見度偵測有確定性。</span><span class="sxs-lookup"><span data-stu-id="f052a-113">Conservative rasterization is useful in a number of situations, including for certainty in collision detection, occlusion culling, and visibility detection.</span></span>

<span data-ttu-id="f052a-114">例如，下圖顯示使用保守點陣化所呈現的綠色三角形。</span><span class="sxs-lookup"><span data-stu-id="f052a-114">For example, the following figure shows a green triangle rendered using conservative rasterization.</span></span> <span data-ttu-id="f052a-115">棕色區域稱為「不確定性區域」，這是一個區域，其中舍入錯誤和其他問題會對三角形的精確維度新增一些不確定性。</span><span class="sxs-lookup"><span data-stu-id="f052a-115">The brown area is known as an "uncertainty region" - a region where rounding errors and other issues add some uncertainty to the exact dimensions of the triangle.</span></span> <span data-ttu-id="f052a-116">每個頂點的紅色三角形會顯示不確定性區域的計算方式。</span><span class="sxs-lookup"><span data-stu-id="f052a-116">The red triangles at each vertex show how the uncertainty region is calculated.</span></span> <span data-ttu-id="f052a-117">大型灰色方塊會顯示將呈現的圖元。</span><span class="sxs-lookup"><span data-stu-id="f052a-117">The large gray squares show the pixels that will be rendered.</span></span> <span data-ttu-id="f052a-118">粉紅色方塊顯示使用「左上角規則」所呈現的圖元，在三角形的邊緣與圖元邊緣相交時，即會開始播放。</span><span class="sxs-lookup"><span data-stu-id="f052a-118">The pink squares show pixels rendered using the "top-left rule", which comes into play as the edge of the triangle crosses the edge of the pixels.</span></span> <span data-ttu-id="f052a-119">可能會有誤報 (的圖元設定，但系統通常不會將其視為系統通常不會進行挑選的) 。</span><span class="sxs-lookup"><span data-stu-id="f052a-119">There can be false positives (pixels set that should not have been) which the system will normally but not always cull.</span></span>

![顯示左上方的規則](images/conservative-rasterization-0.png)

## <a name="interactions-with-the-pipeline"></a><span data-ttu-id="f052a-121">與管線的互動</span><span class="sxs-lookup"><span data-stu-id="f052a-121">Interactions with the pipeline</span></span>

<span data-ttu-id="f052a-122">如需有關保守圖，如何與圖形管線互動的許多詳細資料，請參閱 [D3D12 保守的光柵](/windows/desktop/direct3d12/conservative-rasterization)化。</span><span class="sxs-lookup"><span data-stu-id="f052a-122">For many details on how conservative rasterization interacts with the graphics pipeline, refer to [D3D12 Conservative rasterization](/windows/desktop/direct3d12/conservative-rasterization).</span></span>

## <a name="implementation-details"></a><span data-ttu-id="f052a-123">實作詳細資料</span><span class="sxs-lookup"><span data-stu-id="f052a-123">Implementation details</span></span>

<span data-ttu-id="f052a-124">Direct3D 12 中支援的光柵類型有時稱為「非常重要保守的點陣化」。</span><span class="sxs-lookup"><span data-stu-id="f052a-124">The type of rasterization supported in Direct3D 12 is sometimes referred to as "overestimated conservative rasterization".</span></span> <span data-ttu-id="f052a-125">此外，也有「低估的保守點陣化」概念，這表示只有經過轉譯的原始物件完全涵蓋的圖元才會進行柵格化。</span><span class="sxs-lookup"><span data-stu-id="f052a-125">There is also the concept of "underestimated conservative rasterization", which means that only pixels that are fully covered by a rendered primitive are rasterized.</span></span> <span data-ttu-id="f052a-126">您可以透過使用輸入涵蓋範圍資料，透過圖元著色器取得低估的保守點陣化資訊，而且只有非常重要的保守點陣化可作為光柵模式。</span><span class="sxs-lookup"><span data-stu-id="f052a-126">Underestimated conservative rasterization information is available through the pixel shader through the use of input coverage data, and only overestimated conservative rasterization is available as a rasterizing mode.</span></span>

<span data-ttu-id="f052a-127">如果基本型別的任何部分與圖元重迭，則會將該圖元視為涵蓋範圍，然後再進行柵格化。</span><span class="sxs-lookup"><span data-stu-id="f052a-127">If any part of a primitive overlaps a pixel, then that pixel is considered covered and is then rasterized.</span></span> <span data-ttu-id="f052a-128">當基本的邊緣或角落落在圖元的邊緣或角落時，「左上角規則」的應用程式就會是執行特定的。</span><span class="sxs-lookup"><span data-stu-id="f052a-128">When an edge or corner of a primitive falls along the edge or corner of a pixel, the application of the "top-left rule" is implementation-specific.</span></span> <span data-ttu-id="f052a-129">不過，對於支援退化三角形的執行，沿著邊緣或角落的退化三角形必須至少涵蓋一個圖元。</span><span class="sxs-lookup"><span data-stu-id="f052a-129">However, for implementations that support degenerate triangles, a degenerate triangle along an edge or corner must cover at least one pixel.</span></span>

<span data-ttu-id="f052a-130">保守的點陣化執行會因不同的硬體而異，而且會產生誤報，這表示它們可能會不正確地判斷所涵蓋的圖元。</span><span class="sxs-lookup"><span data-stu-id="f052a-130">Conservative rasterization implementations can vary on different hardware, and do produce false positives, meaning that they can incorrectly decide that pixels are covered.</span></span> <span data-ttu-id="f052a-131">發生這種情況的原因可能是因為執行特定的詳細資料，例如在柵格化中使用的固定點頂點座標中有基本的成長或貼齊錯誤。</span><span class="sxs-lookup"><span data-stu-id="f052a-131">This can occur because of implementation-specific details like primitive growing or snapping errors inherent in the fixed-point vertex coordinates used in rasterization.</span></span> <span data-ttu-id="f052a-132">針對固定點頂點座標 (的原因誤報) 有效的原因是，需要某些數量的誤報，才能讓執行作業對貼齊的頂點進行涵蓋範圍評估 (也就是已從浮點數轉換為轉譯器) 所使用16.8 固定點的頂點座標，但接受原始浮點數頂點座標所產生的涵蓋範圍。</span><span class="sxs-lookup"><span data-stu-id="f052a-132">The reason false positives (with respect to fixed point vertex coordinates) are valid is because some amount of false positives are needed to allow an implementation to do coverage evaluation against post-snapped vertices (i.e. vertex coordinates that have been converted from floating point to the 16.8 fixed-point used in the rasterizer), but honor the coverage produced by the original floating point vertex coordinates.</span></span>

<span data-ttu-id="f052a-133">保守式的點陣化執行不會對非退化貼齊基本專案的浮點圖元座標產生錯誤否定：如果基本專案的任何部分與圖元的任何部分重迭，則該圖元會進行點陣處理。</span><span class="sxs-lookup"><span data-stu-id="f052a-133">Conservative rasterization implementations do not produce false negatives with respect to the floating-point vertex coordinates for non-degenerate post-snap primitives: if any part of a primitive overlaps any part of a pixel, then that pixel is rasterized.</span></span>

<span data-ttu-id="f052a-134">為退化 (索引緩衝區中的重複索引或 3D) 中的內建三角形，或在固定點轉換之後變成退化 (在轉譯器) 中的外線頂點，可能或可能不會挑選;兩者都是有效的行為。</span><span class="sxs-lookup"><span data-stu-id="f052a-134">Triangles that are degenerate (duplicate indices in an index buffer or collinear in 3D), or become degenerate after fixed-point conversion (collinear vertices in the rasterizer), may or may not be culled; both are valid behaviors.</span></span> <span data-ttu-id="f052a-135">退化三角形必須被視為對等，因此，如果應用程式需要特定的行為，則可以使用反面的剔除或測試進行正面測試。</span><span class="sxs-lookup"><span data-stu-id="f052a-135">Degenerate triangles must be considered back facing, so if a specific behavior is required by an application, it can use back-face culling or test for front facing.</span></span> <span data-ttu-id="f052a-136">退化三角形會針對所有插入值使用指派給頂點0的值。</span><span class="sxs-lookup"><span data-stu-id="f052a-136">Degenerate triangles use the values assigned to Vertex 0 for all interpolated values.</span></span>

<span data-ttu-id="f052a-137">除了硬體不支援這項功能的可能性之外，還有三個層級的硬體支援。</span><span class="sxs-lookup"><span data-stu-id="f052a-137">There are three tiers of hardware support, in addition to the possibility that the hardware does not support this feature.</span></span>

-   <span data-ttu-id="f052a-138">第1層支援1/2 圖元不確定性區域，而且沒有貼齊會變質。</span><span class="sxs-lookup"><span data-stu-id="f052a-138">Tier 1 supports 1/2 pixel uncertainty regions, and no post-snap degenerates.</span></span> <span data-ttu-id="f052a-139">這適用于並排顯示、紋理塔圖、輕量圖產生和子圖元陰影對應。</span><span class="sxs-lookup"><span data-stu-id="f052a-139">This is good for tiled rendering, a texture atlas, light map generation and sub-pixel shadow maps.</span></span>
-   <span data-ttu-id="f052a-140">第2層會新增貼齊會變質和1/256 不確定性區域。</span><span class="sxs-lookup"><span data-stu-id="f052a-140">Tier 2 adds post-snap degenerates, and 1/256 uncertainty regions.</span></span> <span data-ttu-id="f052a-141">它也新增了支援以 CPU 為基礎的演算法加速 (例如體素化) 。</span><span class="sxs-lookup"><span data-stu-id="f052a-141">It also adds support for CPU-based algorithm acceleration (such as voxelization).</span></span>
-   <span data-ttu-id="f052a-142">第3層新增1/512 個不確定性區域、內部輸入涵蓋範圍，並支援遮蔽的挑選。</span><span class="sxs-lookup"><span data-stu-id="f052a-142">Tier 3 adds 1/512 uncertainty regions, inner input coverage and supports occlusion culling.</span></span> <span data-ttu-id="f052a-143">輸入涵蓋範圍會將新值新增 `SV_InnerCoverage` 至高階網底語言 (HLSL) 。</span><span class="sxs-lookup"><span data-stu-id="f052a-143">The input coverage adds the new value `SV_InnerCoverage` to High Level Shading Language (HLSL).</span></span> <span data-ttu-id="f052a-144">這是一種32位純量整數，可在圖元著色器的輸入上指定，並代表低估的保守式點陣化資訊 (也就是，是否保證) 完全涵蓋圖元。</span><span class="sxs-lookup"><span data-stu-id="f052a-144">This is a 32-bit scalar integer that can be specified on input to a pixel shader, and represents the underestimated conservative rasterization information (that is, whether a pixel is guaranteed-to-be-fully covered).</span></span>

## <a name="api-summary"></a><span data-ttu-id="f052a-145">API summary</span><span class="sxs-lookup"><span data-stu-id="f052a-145">API summary</span></span>

<span data-ttu-id="f052a-146">下列方法、結構、列舉和 helper 類別都會參考保守的點陣化：</span><span class="sxs-lookup"><span data-stu-id="f052a-146">The following methods, structures, enums, and helper classes reference conservative rasterization:</span></span>

-   <span data-ttu-id="f052a-147">[**D3D11 \_轉譯器 \_ DESC2**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_rasterizer_desc2) ：包含轉譯器描述的結構，請注意 CD3D12 轉譯 \_ \_ 器 DESC2 協助程式類別來建立轉譯器描述。</span><span class="sxs-lookup"><span data-stu-id="f052a-147">[**D3D11\_RASTERIZER\_DESC2**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_rasterizer_desc2) : structure holding the rasterizer description, noting the CD3D12\_RASTERIZER\_DESC2 helper class for creating rasterizer descriptions.</span></span>
-   <span data-ttu-id="f052a-148">[**D3D11 \_保守 \_ 點陣化 \_ 模式**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_conservative_rasterization_mode) ：模式的列舉值 (on 或 off) 。</span><span class="sxs-lookup"><span data-stu-id="f052a-148">[**D3D11\_CONSERVATIVE\_RASTERIZATION\_MODE**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_conservative_rasterization_mode) : enum values for the mode (on or off).</span></span>
-   <span data-ttu-id="f052a-149">[**D3D11 \_功能 \_ 資料 \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2) ：保存支援層的結構。</span><span class="sxs-lookup"><span data-stu-id="f052a-149">[**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2) : structure holding the tier of support.</span></span>
-   <span data-ttu-id="f052a-150">[**D3D11 \_保守的 \_ 點陣化 \_ 層**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_conservative_rasterization_tier) ：每個硬體支援層的列舉值。</span><span class="sxs-lookup"><span data-stu-id="f052a-150">[**D3D11\_CONSERVATIVE\_RASTERIZATION\_TIER**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_conservative_rasterization_tier) : enum values for each tier of support by the hardware.</span></span>
-   <span data-ttu-id="f052a-151">[**ID3D11Device：： CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) ：存取支援功能的方法。</span><span class="sxs-lookup"><span data-stu-id="f052a-151">[**ID3D11Device::CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) : method to access the supported features.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f052a-152">相關主題</span><span class="sxs-lookup"><span data-stu-id="f052a-152">Related topics</span></span>
* [<span data-ttu-id="f052a-153">Direct3D 11.3 功能</span><span class="sxs-lookup"><span data-stu-id="f052a-153">Direct3D 11.3 Features</span></span>](direct3d-11-3-features.md)