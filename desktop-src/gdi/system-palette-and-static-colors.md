---
description: 一般來說，系統保留給靜態色彩的系統調色板專案無法變更。
ms.assetid: be258151-36cc-42ba-8005-ff9d8e59b894
title: 系統調色板和靜態色彩
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 537bdc87fecdd055334b83a56b0a53f9999be94c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104973084"
---
# <a name="system-palette-and-static-colors"></a><span data-ttu-id="0911e-103">系統調色板和靜態色彩</span><span class="sxs-lookup"><span data-stu-id="0911e-103">System Palette and Static Colors</span></span>

<span data-ttu-id="0911e-104">一般來說，系統保留給靜態色彩的系統調色板專案無法變更。</span><span class="sxs-lookup"><span data-stu-id="0911e-104">Ordinarily, the system palette entries that the system reserves for static colors cannot be changed.</span></span> <span data-ttu-id="0911e-105">應用程式可以覆寫這個預設行為，方法是使用 [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) 函式減少靜態色彩專案的數目，進而增加未使用的系統調色板專案數目。</span><span class="sxs-lookup"><span data-stu-id="0911e-105">An application can override this default behavior by using the [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) function to reduce the number of static color entries and, thereby, increase the number of unused system palette entries.</span></span> <span data-ttu-id="0911e-106">不過，由於變更靜態色彩可能會對顯示的所有視窗產生立即且顯著的影響，因此應用程式不應該呼叫 **SetSystemPaletteUse**，除非它有最大化的視窗和輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="0911e-106">However, because changing the static colors can have an immediate and dramatic effect on all windows on the display, an application should not call **SetSystemPaletteUse**, unless it has a maximized window and the input focus.</span></span>

<span data-ttu-id="0911e-107">當應用程式使用 SYSPAL NOSTATIC 值來呼叫 [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) 時 \_ ，系統會釋出兩個保留專案，讓這些專案在應用程式後續發現其邏輯元件時，接收新的色彩值。</span><span class="sxs-lookup"><span data-stu-id="0911e-107">When an application calls [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) with the SYSPAL\_NOSTATIC value, the system frees all but two of the reserved entries, allowing those entries to receive new color values when the application subsequently realizes its logical palette.</span></span> <span data-ttu-id="0911e-108">其餘的兩個靜態色彩專案仍會保留下來，並設定為白色和黑色。</span><span class="sxs-lookup"><span data-stu-id="0911e-108">The remaining two static color entries remain reserved and are set to white and black.</span></span> <span data-ttu-id="0911e-109">應用程式可以藉由呼叫 **SetSystemPaletteUse** 與 SYSPAL 靜態值來還原保留的專案 \_ 。</span><span class="sxs-lookup"><span data-stu-id="0911e-109">An application can restore the reserved entries by calling **SetSystemPaletteUse** with the SYSPAL\_STATIC value.</span></span> <span data-ttu-id="0911e-110">它可以使用 [**GetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteuse) 函式來探索目前的系統元件使用方式。</span><span class="sxs-lookup"><span data-stu-id="0911e-110">It can discover the current system palette usage by using the [**GetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteuse) function.</span></span>

<span data-ttu-id="0911e-111">此外，在將系統選擇區的使用方式設定為 SYSPAL \_ NOSTATIC 之後，應用程式必須立即瞭解其邏輯調色板、呼叫 [**GetSysColor**](/windows/win32/api/winuser/nf-winuser-getsyscolor) 函式以儲存目前的系統色彩設定、呼叫 [**SetSysColors**](/windows/win32/api/winuser/nf-winuser-setsyscolors) 函式以使用黑色和白色將系統色彩設定為合理的值，最後將 [**WM \_ SYSCOLORCHANGE**](wm-syscolorchange.md) 訊息傳送至其他最上層視窗，以使用新的系統色彩進行重新繪製。</span><span class="sxs-lookup"><span data-stu-id="0911e-111">Furthermore, after setting the system palette usage to SYSPAL\_NOSTATIC, the application must immediately realize its logical palette, call the [**GetSysColor**](/windows/win32/api/winuser/nf-winuser-getsyscolor) function to save the current system color settings, call the [**SetSysColors**](/windows/win32/api/winuser/nf-winuser-setsyscolors) function to set the system colors to reasonable values using black and white, and finally send the [**WM\_SYSCOLORCHANGE**](wm-syscolorchange.md) message to other top-level windows to allow them to be redrawn with the new system colors.</span></span> <span data-ttu-id="0911e-112">使用黑色和白色設定系統色彩時，應用程式應該確保相鄰或重迭的專案（例如視窗框架和框線）分別設定為黑色和白色。</span><span class="sxs-lookup"><span data-stu-id="0911e-112">When setting system colors using black and white, the application should make sure adjacent or overlapping items, such as window frames and borders, are set to black and white, respectively.</span></span>

<span data-ttu-id="0911e-113">在應用程式失去輸入焦點之前，關閉視窗或終止，它必須立即以 SYSPAL 靜態值呼叫 [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) \_ 、瞭解其邏輯調色板、將系統色彩還原為先前的值，然後傳送 [**WM \_ SYSCOLORCHANGE**](wm-syscolorchange.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="0911e-113">Before the application loses the input focus, closes its window, or terminates, it must immediately call [**SetSystemPaletteUse**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) with the SYSPAL\_STATIC value, realize its logical palette, restore the system colors to their previous values, and send the [**WM\_SYSCOLORCHANGE**](wm-syscolorchange.md) message.</span></span> <span data-ttu-id="0911e-114">系統會將 [**WM \_ 油漆**](wm-paint.md) 訊息傳送至受系統色彩變更影響的任何視窗。</span><span class="sxs-lookup"><span data-stu-id="0911e-114">The system sends a [**WM\_PAINT**](wm-paint.md) message to any window that is affected by a system color change.</span></span> <span data-ttu-id="0911e-115">具有使用現有系統色彩之筆刷的應用程式應該刪除這些筆刷，然後使用新的系統色彩重新建立這些筆刷。</span><span class="sxs-lookup"><span data-stu-id="0911e-115">Applications that have brushes using the existing system colors should delete those brushes and re-create them using the new system colors.</span></span>

 

 
