---
description: 只有當字型是在指定的裝置上，或安裝在系統字型資料表中時，應用程式才能使用字型來繪製文字。
ms.assetid: b422b981-8760-4484-9965-f212287c421e
title: 字型安裝和刪除
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0184054973c769462ed8c1620e5534ff909576ca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991234"
---
# <a name="font-installation-and-deletion"></a><span data-ttu-id="ef334-103">字型安裝和刪除</span><span class="sxs-lookup"><span data-stu-id="ef334-103">Font Installation and Deletion</span></span>

<span data-ttu-id="ef334-104">只有當字型是在指定的裝置上，或安裝在系統字型資料表中時，應用程式才能使用字型來繪製文字。</span><span class="sxs-lookup"><span data-stu-id="ef334-104">An application can use a font to draw text only if that font is either resident on a specified device or installed in the system font table.</span></span> <span data-ttu-id="ef334-105">字型資料表是內部陣列，可識別應用程式可用的所有 nondevice 字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-105">The font table is an internal array that identifies all nondevice fonts that are available to an application.</span></span> <span data-ttu-id="ef334-106">應用程式可以藉由呼叫 [**>enumfontfamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) 或 [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) 函式，來取得目前安裝在裝置上或儲存在內部字型資料表中的字型名稱。</span><span class="sxs-lookup"><span data-stu-id="ef334-106">An application can retrieve the names of fonts currently installed on a device or stored in the internal font table by calling the [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) or [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) functions.</span></span>

<span data-ttu-id="ef334-107">若要暫時安裝字型，請呼叫 [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) 或 [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa)。</span><span class="sxs-lookup"><span data-stu-id="ef334-107">To temporarily install a font, call [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="ef334-108">這些函式會載入儲存在字型資源檔中的字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-108">These functions load a font that is stored in a font-resource file.</span></span> <span data-ttu-id="ef334-109">不過，這是暫時性的安裝，因為在重新開機後，將不會出現字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-109">However, this is a temporary installation because after a reboot the font will not be present.</span></span>

<span data-ttu-id="ef334-110">若要安裝系統重新開機後仍會保留的字型，請使用下列其中一種方法：</span><span class="sxs-lookup"><span data-stu-id="ef334-110">To install a font that will remain after the system is rebooted, use one of the following methods:</span></span>

-   <span data-ttu-id="ef334-111">移至主控台，按一下 [字型 **] 圖示，** 然後 **從 [檔案**] 功能表選取 [**安裝新** 字型]。</span><span class="sxs-lookup"><span data-stu-id="ef334-111">Go to the Control Panel, click the **Fonts** icon, and select **Install New Fonts** from the **File** menu.</span></span> <span data-ttu-id="ef334-112">即使在重新開機之前，應用程式也可以使用字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-112">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="ef334-113">不過，在終端機伺服器的情況下，字型適用于目前的會話，但在重新開機之前無法供其他會話使用。</span><span class="sxs-lookup"><span data-stu-id="ef334-113">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span>
-   <span data-ttu-id="ef334-114">將字型複製到% windir% \\ fonts 資料夾。</span><span class="sxs-lookup"><span data-stu-id="ef334-114">Copy the font into the %windir%\\fonts folder.</span></span> <span data-ttu-id="ef334-115">然後，移至主控台並按一下 **字型圖示，** 或呼叫 [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) 或 [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa)。</span><span class="sxs-lookup"><span data-stu-id="ef334-115">Then, either go to the Control Panel and click the **Fonts** icon, or call [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="ef334-116">即使在重新開機之前，應用程式也可以使用字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-116">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="ef334-117">不過，在終端機伺服器的情況下，字型適用于目前的會話，但在重新開機之前無法供其他會話使用。</span><span class="sxs-lookup"><span data-stu-id="ef334-117">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span> <span data-ttu-id="ef334-118">如果您只將字型複製到% windir% 字型 \\ 資料夾，則只有在系統重新開機之後，才可以使用字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-118">If you only copy the font into the %windir%\\fonts folder, the font will be available only after the system is rebooted.</span></span>

<span data-ttu-id="ef334-119">當應用程式使用已安裝的字型完成時，必須呼叫 [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) 函數來移除該字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-119">When an application finishes using an installed font, it must remove that font by calling the [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) function.</span></span>

<span data-ttu-id="ef334-120">在 \\ 任何使用中的會話載入（包括會話0）時，無法修改從% windir% 字型資料夾以外的位置安裝的字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-120">A font installed from a location other than the %windir%\\fonts folder cannot be modified when loaded in any active session, including session 0.</span></span> <span data-ttu-id="ef334-121">因此將會封鎖任何變更、取代或刪除的嘗試。</span><span class="sxs-lookup"><span data-stu-id="ef334-121">Any attempt to change, replace, or delete will, therefore, be blocked.</span></span> <span data-ttu-id="ef334-122">如果需要修改字型：</span><span class="sxs-lookup"><span data-stu-id="ef334-122">If modification to a font is necessary:</span></span>

-   <span data-ttu-id="ef334-123">*暫時* 字型只會在目前的會話中載入。</span><span class="sxs-lookup"><span data-stu-id="ef334-123">*Temporary fonts* get loaded only in the current session.</span></span> <span data-ttu-id="ef334-124">嘗試修改任何字型之前，請先呼叫 [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) 來強制目前的會話卸載字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-124">Before attempting any font modifications, call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span>
-   <span data-ttu-id="ef334-125">*永久* 字型會在重新開機後繼續安裝，而且會由所有建立的會話載入。</span><span class="sxs-lookup"><span data-stu-id="ef334-125">*Permanent fonts* remain installed after reboot and are loaded by all created sessions.</span></span> <span data-ttu-id="ef334-126">呼叫 [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) 來強制目前的會話卸載字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-126">Call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span> <span data-ttu-id="ef334-127">然後，在字型登錄機碼 (**HKEY \_ LOCAL \_ MACHINE \\ SOFTWARE \\ Microsoft \\ Windows NT \\ CurrentVersion \\** 字型) 尋找和移除與字型相關聯的登錄值。</span><span class="sxs-lookup"><span data-stu-id="ef334-127">Then, in the font registry key (**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts**) find and remove the registry value associated with the font.</span></span> <span data-ttu-id="ef334-128">最後，重新開機電腦，以確保不會在任何會話中載入字型。</span><span class="sxs-lookup"><span data-stu-id="ef334-128">Finally, reboot the machine to ensure the font isn't loaded in any session.</span></span> <span data-ttu-id="ef334-129">重新開機之後，請繼續進行您的字型修改/刪除。</span><span class="sxs-lookup"><span data-stu-id="ef334-129">After reboot, proceed with your font modification/deletion.</span></span>

<span data-ttu-id="ef334-130">每當應用程式呼叫新增和刪除字型資源的函式時，它也應該呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 函式，並將 [**WM \_ FONTCHANGE**](wm-fontchange.md) 訊息傳送至系統中的所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="ef334-130">Whenever an application calls the functions that add and delete font resources, it should also call the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function and send a [**WM\_FONTCHANGE**](wm-fontchange.md) message to all top-level windows in the system.</span></span> <span data-ttu-id="ef334-131">這則訊息會通知其他應用程式，其內部字型資料表已由新增或移除字型的應用程式更改。</span><span class="sxs-lookup"><span data-stu-id="ef334-131">This message notifies other applications that the internal font table has been altered by an application that added or removed a font.</span></span>

 

 
