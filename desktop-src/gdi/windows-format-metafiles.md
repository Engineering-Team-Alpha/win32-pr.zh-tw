---
description: Microsoft Windows-格式中繼檔的功能有限，而且應該很少使用。
ms.assetid: ebbf871b-cf78-4a90-8f27-e44699c17178
title: Windows-Format 中繼檔
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f5d261ed884ebc8836f9bbae43fcb29cd7965d3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104193789"
---
# <a name="windows-format-metafiles"></a>Windows-Format 中繼檔

Microsoft Windows-格式中繼檔的功能有限，而且應該很少使用。 支援 Windows 格式函式來維持與撰寫為以16位 Windows 應用程式執行之應用程式的回溯相容性。 相反地，您應該使用增強格式函數。

*Windows 格式的中繼檔* 是由16位 windows 架構應用程式所使用。 格式是由標頭和中繼檔記錄陣列所組成。

以下是此格式的限制：

-   Windows 格式中繼檔是與應用程式和裝置相依。 應用程式對應模式或裝置解析的變更，會影響以此格式建立之中繼檔的外觀。
-   Windows 格式中繼檔未包含完整的標頭，其描述原始圖片尺寸、圖片建立所在的裝置解析度、選擇性的文字描述或選擇性的調色板。
-   Windows 格式中繼檔不支援新的曲線、路徑和轉換函數。 請參閱下清單格中支援的函數清單。
-   某些 Windows 格式的中繼檔記錄無法調整。
-   無法查詢與 Windows 格式中繼檔相關聯的中繼檔裝置內容 (也就是應用程式無法抓取裝置解析資料、字型計量等) 。

以下是 Windows 格式中繼檔唯一支援的功能。



|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**AnimatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-animatepalette)[**弧形**](/windows/desktop/api/Wingdi/nf-wingdi-arc)<br/> [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt)<br/> [**和絃**](/windows/desktop/api/Wingdi/nf-wingdi-chord)<br/> [**CreateBrushIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createbrushindirect)<br/> [**CreateDIBPatternBrush**](/windows/desktop/api/Wingdi/nf-wingdi-createdibpatternbrush)<br/> [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta)<br/> [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette)<br/> [**CreatePatternBrush**](/windows/desktop/api/Wingdi/nf-wingdi-createpatternbrush)<br/> [**CreatePenIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createpenindirect)<br/> [**DeleteObject**](/windows/desktop/api/Wingdi/nf-wingdi-deleteobject)<br/> [**橢圓形**](/windows/desktop/api/Wingdi/nf-wingdi-ellipse)<br/> [**逸出**](/windows/win32/api/wingdi/nf-wingdi-escape)<br/> [**ExcludeClipRect**](/windows/desktop/api/Wingdi/nf-wingdi-excludecliprect)<br/> [**ExtFloodFill**](/windows/desktop/api/Wingdi/nf-wingdi-extfloodfill)<br/> [**ExtTextOut**](/windows/desktop/api/Wingdi/nf-wingdi-exttextouta)<br/> [**FillRgn**](/windows/desktop/api/Wingdi/nf-wingdi-fillrgn)<br/> [**FloodFill**](/windows/desktop/api/Wingdi/nf-wingdi-floodfill)<br/> [**FrameRgn**](/windows/desktop/api/Wingdi/nf-wingdi-framergn)<br/> [**IntersectClipRect**](/windows/desktop/api/Wingdi/nf-wingdi-intersectcliprect)<br/> [**InvertRgn**](/windows/desktop/api/Wingdi/nf-wingdi-invertrgn)<br/> | [**LineTo**](/windows/desktop/api/Wingdi/nf-wingdi-lineto)[**MoveToEx**](/windows/desktop/api/Wingdi/nf-wingdi-movetoex)<br/> [**OffsetClipRgn**](/windows/desktop/api/Wingdi/nf-wingdi-offsetcliprgn)<br/> [**OffsetViewportOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-offsetviewportorgex)<br/> [**OffsetWindowOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-offsetwindoworgex)<br/> [**PaintRgn**](/windows/desktop/api/Wingdi/nf-wingdi-paintrgn)<br/> [**PatBlt**](/windows/desktop/api/Wingdi/nf-wingdi-patblt)<br/> [**圓形圖**](/windows/desktop/api/Wingdi/nf-wingdi-pie)<br/> [**多邊形**](/windows/desktop/api/Wingdi/nf-wingdi-polygon)<br/> [**聚合線條**](/windows/desktop/api/Wingdi/nf-wingdi-polyline)<br/> [**PolyPolygon**](/windows/desktop/api/Wingdi/nf-wingdi-polypolygon)<br/> [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette)<br/> [**矩形**](/windows/desktop/api/Wingdi/nf-wingdi-rectangle)<br/> [**ResizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-resizepalette)<br/> [**RestoreDC**](/windows/desktop/api/Wingdi/nf-wingdi-restoredc)<br/> [**RoundRect**](/windows/desktop/api/Wingdi/nf-wingdi-roundrect)<br/> [**SaveDC**](/windows/desktop/api/Wingdi/nf-wingdi-savedc)<br/> [**ScaleViewportExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-scaleviewportextex)<br/> [**ScaleWindowExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-scalewindowextex)<br/> [**SelectClipRgn**](/windows/desktop/api/Wingdi/nf-wingdi-selectcliprgn)<br/> [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject)<br/> | [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette)[**SetBkColor**](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor)<br/> [**SetBkMode**](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode)<br/> [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice)<br/> [**SetMapMode**](/windows/desktop/api/Wingdi/nf-wingdi-setmapmode)<br/> [**SetMapperFlags**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags)<br/> [**SetPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-setpaletteentries)<br/> [**Bitmap.setpixel**](/windows/desktop/api/Wingdi/nf-wingdi-setpixel)<br/> [**SetPolyFillMode**](/windows/desktop/api/Wingdi/nf-wingdi-setpolyfillmode)<br/> [**SetROP2**](/windows/desktop/api/Wingdi/nf-wingdi-setrop2)<br/> [**SetStretchBltMode**](/windows/desktop/api/Wingdi/nf-wingdi-setstretchbltmode)<br/> [**SetTextAlign**](/windows/desktop/api/Wingdi/nf-wingdi-settextalign)<br/> [**SetTextCharacterExtra**](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra)<br/> [**SetTextColor**](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor)<br/> [**SetTextJustification**](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification)<br/> [**SetViewportOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-setviewportorgex)<br/> [**SetWindowExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-setwindowextex)<br/> [**SetWindowOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-setwindoworgex)<br/> [**StretchBlt**](/windows/desktop/api/Wingdi/nf-wingdi-stretchblt)<br/> [**StretchDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits)<br/> [**TextOut**](/windows/desktop/api/Wingdi/nf-wingdi-textouta)<br/> |



 

若要將 Windows 格式中繼檔轉換成增強格式的中繼檔，請呼叫 [**GetMetaFileBitsEx**](/windows/desktop/api/Wingdi/nf-wingdi-getmetafilebitsex) 函式，從 Windows 格式中繼檔取出資料，然後呼叫 [**SetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setwinmetafilebits) 函式，將此資料轉換成增強格式的中繼檔。 若要將增強格式記錄轉換成 Windows 格式記錄，請呼叫 [**GetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getwinmetafilebits) 函數。

 

 
