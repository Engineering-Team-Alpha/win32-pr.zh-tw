---
description: Microsoft Windows-格式中繼檔的功能有限，而且應該很少使用。
ms.assetid: ebbf871b-cf78-4a90-8f27-e44699c17178
title: Windows-Format 中繼檔
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f5d261ed884ebc8836f9bbae43fcb29cd7965d3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104193789"
---
# <a name="windows-format-metafiles"></a><span data-ttu-id="4e41c-103">Windows-Format 中繼檔</span><span class="sxs-lookup"><span data-stu-id="4e41c-103">Windows-Format Metafiles</span></span>

<span data-ttu-id="4e41c-104">Microsoft Windows-格式中繼檔的功能有限，而且應該很少使用。</span><span class="sxs-lookup"><span data-stu-id="4e41c-104">Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used.</span></span> <span data-ttu-id="4e41c-105">支援 Windows 格式函式來維持與撰寫為以16位 Windows 應用程式執行之應用程式的回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="4e41c-105">The Windows-format functions are supported to maintain backward compatibility with applications that were written to run as 16 bit Windows-based applications.</span></span> <span data-ttu-id="4e41c-106">相反地，您應該使用增強格式函數。</span><span class="sxs-lookup"><span data-stu-id="4e41c-106">Instead, you should use the enhanced-format functions.</span></span>

<span data-ttu-id="4e41c-107">*Windows 格式的中繼檔* 是由16位 windows 架構應用程式所使用。</span><span class="sxs-lookup"><span data-stu-id="4e41c-107">A *Windows-format metafile* is used by 16-bit Windows-based applications.</span></span> <span data-ttu-id="4e41c-108">格式是由標頭和中繼檔記錄陣列所組成。</span><span class="sxs-lookup"><span data-stu-id="4e41c-108">The format consists of a header and an array of metafile records.</span></span>

<span data-ttu-id="4e41c-109">以下是此格式的限制：</span><span class="sxs-lookup"><span data-stu-id="4e41c-109">The following are the limitations of this format:</span></span>

-   <span data-ttu-id="4e41c-110">Windows 格式中繼檔是與應用程式和裝置相依。</span><span class="sxs-lookup"><span data-stu-id="4e41c-110">A Windows-format metafile is application and device dependent.</span></span> <span data-ttu-id="4e41c-111">應用程式對應模式或裝置解析的變更，會影響以此格式建立之中繼檔的外觀。</span><span class="sxs-lookup"><span data-stu-id="4e41c-111">Changes in the application's mapping modes or the device resolution affect the appearance of metafiles created in this format.</span></span>
-   <span data-ttu-id="4e41c-112">Windows 格式中繼檔未包含完整的標頭，其描述原始圖片尺寸、圖片建立所在的裝置解析度、選擇性的文字描述或選擇性的調色板。</span><span class="sxs-lookup"><span data-stu-id="4e41c-112">A Windows-format metafile does not contain a comprehensive header that describes the original picture dimensions, the resolution of the device on which the picture was created, an optional text description, or an optional palette.</span></span>
-   <span data-ttu-id="4e41c-113">Windows 格式中繼檔不支援新的曲線、路徑和轉換函數。</span><span class="sxs-lookup"><span data-stu-id="4e41c-113">A Windows-format metafile does not support the new curve, path, and transformation functions.</span></span> <span data-ttu-id="4e41c-114">請參閱下清單格中支援的函數清單。</span><span class="sxs-lookup"><span data-stu-id="4e41c-114">See the list of supported functions in the table that follows.</span></span>
-   <span data-ttu-id="4e41c-115">某些 Windows 格式的中繼檔記錄無法調整。</span><span class="sxs-lookup"><span data-stu-id="4e41c-115">Some Windows-format metafile records cannot be scaled.</span></span>
-   <span data-ttu-id="4e41c-116">無法查詢與 Windows 格式中繼檔相關聯的中繼檔裝置內容 (也就是應用程式無法抓取裝置解析資料、字型計量等) 。</span><span class="sxs-lookup"><span data-stu-id="4e41c-116">The metafile device context associated with a Windows-format metafile cannot be queried (that is, an application cannot retrieve device-resolution data, font metrics, and so on).</span></span>

<span data-ttu-id="4e41c-117">以下是 Windows 格式中繼檔唯一支援的功能。</span><span class="sxs-lookup"><span data-stu-id="4e41c-117">The following are the only functions that are supported by Windows-format metafiles.</span></span>



|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4e41c-118">[**AnimatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-animatepalette)[**弧形**](/windows/desktop/api/Wingdi/nf-wingdi-arc)</span><span class="sxs-lookup"><span data-stu-id="4e41c-118">[**AnimatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-animatepalette)[**Arc**](/windows/desktop/api/Wingdi/nf-wingdi-arc)</span></span><br/> [<span data-ttu-id="4e41c-119">**BitBlt**</span><span class="sxs-lookup"><span data-stu-id="4e41c-119">**BitBlt**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-bitblt)<br/> [<span data-ttu-id="4e41c-120">**和絃**</span><span class="sxs-lookup"><span data-stu-id="4e41c-120">**Chord**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-chord)<br/> [<span data-ttu-id="4e41c-121">**CreateBrushIndirect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-121">**CreateBrushIndirect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createbrushindirect)<br/> [<span data-ttu-id="4e41c-122">**CreateDIBPatternBrush**</span><span class="sxs-lookup"><span data-stu-id="4e41c-122">**CreateDIBPatternBrush**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createdibpatternbrush)<br/> [<span data-ttu-id="4e41c-123">**CreateFontIndirect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-123">**CreateFontIndirect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta)<br/> [<span data-ttu-id="4e41c-124">**CreatePalette**</span><span class="sxs-lookup"><span data-stu-id="4e41c-124">**CreatePalette**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createpalette)<br/> [<span data-ttu-id="4e41c-125">**CreatePatternBrush**</span><span class="sxs-lookup"><span data-stu-id="4e41c-125">**CreatePatternBrush**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createpatternbrush)<br/> [<span data-ttu-id="4e41c-126">**CreatePenIndirect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-126">**CreatePenIndirect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-createpenindirect)<br/> [<span data-ttu-id="4e41c-127">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="4e41c-127">**DeleteObject**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-deleteobject)<br/> [<span data-ttu-id="4e41c-128">**橢圓形**</span><span class="sxs-lookup"><span data-stu-id="4e41c-128">**Ellipse**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-ellipse)<br/> [<span data-ttu-id="4e41c-129">**逸出**</span><span class="sxs-lookup"><span data-stu-id="4e41c-129">**Escape**</span></span>](/windows/win32/api/wingdi/nf-wingdi-escape)<br/> [<span data-ttu-id="4e41c-130">**ExcludeClipRect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-130">**ExcludeClipRect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-excludecliprect)<br/> [<span data-ttu-id="4e41c-131">**ExtFloodFill**</span><span class="sxs-lookup"><span data-stu-id="4e41c-131">**ExtFloodFill**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-extfloodfill)<br/> [<span data-ttu-id="4e41c-132">**ExtTextOut**</span><span class="sxs-lookup"><span data-stu-id="4e41c-132">**ExtTextOut**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-exttextouta)<br/> [<span data-ttu-id="4e41c-133">**FillRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-133">**FillRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-fillrgn)<br/> [<span data-ttu-id="4e41c-134">**FloodFill**</span><span class="sxs-lookup"><span data-stu-id="4e41c-134">**FloodFill**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-floodfill)<br/> [<span data-ttu-id="4e41c-135">**FrameRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-135">**FrameRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-framergn)<br/> [<span data-ttu-id="4e41c-136">**IntersectClipRect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-136">**IntersectClipRect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-intersectcliprect)<br/> [<span data-ttu-id="4e41c-137">**InvertRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-137">**InvertRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-invertrgn)<br/> | <span data-ttu-id="4e41c-138">[**LineTo**](/windows/desktop/api/Wingdi/nf-wingdi-lineto)[**MoveToEx**](/windows/desktop/api/Wingdi/nf-wingdi-movetoex)</span><span class="sxs-lookup"><span data-stu-id="4e41c-138">[**LineTo**](/windows/desktop/api/Wingdi/nf-wingdi-lineto)[**MoveToEx**](/windows/desktop/api/Wingdi/nf-wingdi-movetoex)</span></span><br/> [<span data-ttu-id="4e41c-139">**OffsetClipRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-139">**OffsetClipRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-offsetcliprgn)<br/> [<span data-ttu-id="4e41c-140">**OffsetViewportOrgEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-140">**OffsetViewportOrgEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-offsetviewportorgex)<br/> [<span data-ttu-id="4e41c-141">**OffsetWindowOrgEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-141">**OffsetWindowOrgEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-offsetwindoworgex)<br/> [<span data-ttu-id="4e41c-142">**PaintRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-142">**PaintRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-paintrgn)<br/> [<span data-ttu-id="4e41c-143">**PatBlt**</span><span class="sxs-lookup"><span data-stu-id="4e41c-143">**PatBlt**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-patblt)<br/> [<span data-ttu-id="4e41c-144">**圓形圖**</span><span class="sxs-lookup"><span data-stu-id="4e41c-144">**Pie**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-pie)<br/> [<span data-ttu-id="4e41c-145">**多邊形**</span><span class="sxs-lookup"><span data-stu-id="4e41c-145">**Polygon**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-polygon)<br/> [<span data-ttu-id="4e41c-146">**聚合線條**</span><span class="sxs-lookup"><span data-stu-id="4e41c-146">**Polyline**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-polyline)<br/> [<span data-ttu-id="4e41c-147">**PolyPolygon**</span><span class="sxs-lookup"><span data-stu-id="4e41c-147">**PolyPolygon**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-polypolygon)<br/> [<span data-ttu-id="4e41c-148">**RealizePalette**</span><span class="sxs-lookup"><span data-stu-id="4e41c-148">**RealizePalette**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette)<br/> [<span data-ttu-id="4e41c-149">**矩形**</span><span class="sxs-lookup"><span data-stu-id="4e41c-149">**Rectangle**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-rectangle)<br/> [<span data-ttu-id="4e41c-150">**ResizePalette**</span><span class="sxs-lookup"><span data-stu-id="4e41c-150">**ResizePalette**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-resizepalette)<br/> [<span data-ttu-id="4e41c-151">**RestoreDC**</span><span class="sxs-lookup"><span data-stu-id="4e41c-151">**RestoreDC**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-restoredc)<br/> [<span data-ttu-id="4e41c-152">**RoundRect**</span><span class="sxs-lookup"><span data-stu-id="4e41c-152">**RoundRect**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-roundrect)<br/> [<span data-ttu-id="4e41c-153">**SaveDC**</span><span class="sxs-lookup"><span data-stu-id="4e41c-153">**SaveDC**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-savedc)<br/> [<span data-ttu-id="4e41c-154">**ScaleViewportExtEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-154">**ScaleViewportExtEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-scaleviewportextex)<br/> [<span data-ttu-id="4e41c-155">**ScaleWindowExtEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-155">**ScaleWindowExtEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-scalewindowextex)<br/> [<span data-ttu-id="4e41c-156">**SelectClipRgn**</span><span class="sxs-lookup"><span data-stu-id="4e41c-156">**SelectClipRgn**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-selectcliprgn)<br/> [<span data-ttu-id="4e41c-157">**SelectObject**</span><span class="sxs-lookup"><span data-stu-id="4e41c-157">**SelectObject**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-selectobject)<br/> | <span data-ttu-id="4e41c-158">[**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette)[**SetBkColor**](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor)</span><span class="sxs-lookup"><span data-stu-id="4e41c-158">[**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette)[**SetBkColor**](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor)</span></span><br/> [<span data-ttu-id="4e41c-159">**SetBkMode**</span><span class="sxs-lookup"><span data-stu-id="4e41c-159">**SetBkMode**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode)<br/> [<span data-ttu-id="4e41c-160">**SetDIBitsToDevice**</span><span class="sxs-lookup"><span data-stu-id="4e41c-160">**SetDIBitsToDevice**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice)<br/> [<span data-ttu-id="4e41c-161">**SetMapMode**</span><span class="sxs-lookup"><span data-stu-id="4e41c-161">**SetMapMode**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setmapmode)<br/> [<span data-ttu-id="4e41c-162">**SetMapperFlags**</span><span class="sxs-lookup"><span data-stu-id="4e41c-162">**SetMapperFlags**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags)<br/> [<span data-ttu-id="4e41c-163">**SetPaletteEntries**</span><span class="sxs-lookup"><span data-stu-id="4e41c-163">**SetPaletteEntries**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setpaletteentries)<br/> [<span data-ttu-id="4e41c-164">**Bitmap.setpixel**</span><span class="sxs-lookup"><span data-stu-id="4e41c-164">**SetPixel**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setpixel)<br/> [<span data-ttu-id="4e41c-165">**SetPolyFillMode**</span><span class="sxs-lookup"><span data-stu-id="4e41c-165">**SetPolyFillMode**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setpolyfillmode)<br/> [<span data-ttu-id="4e41c-166">**SetROP2**</span><span class="sxs-lookup"><span data-stu-id="4e41c-166">**SetROP2**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setrop2)<br/> [<span data-ttu-id="4e41c-167">**SetStretchBltMode**</span><span class="sxs-lookup"><span data-stu-id="4e41c-167">**SetStretchBltMode**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setstretchbltmode)<br/> [<span data-ttu-id="4e41c-168">**SetTextAlign**</span><span class="sxs-lookup"><span data-stu-id="4e41c-168">**SetTextAlign**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-settextalign)<br/> [<span data-ttu-id="4e41c-169">**SetTextCharacterExtra**</span><span class="sxs-lookup"><span data-stu-id="4e41c-169">**SetTextCharacterExtra**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra)<br/> [<span data-ttu-id="4e41c-170">**SetTextColor**</span><span class="sxs-lookup"><span data-stu-id="4e41c-170">**SetTextColor**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor)<br/> [<span data-ttu-id="4e41c-171">**SetTextJustification**</span><span class="sxs-lookup"><span data-stu-id="4e41c-171">**SetTextJustification**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification)<br/> [<span data-ttu-id="4e41c-172">**SetViewportOrgEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-172">**SetViewportOrgEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setviewportorgex)<br/> [<span data-ttu-id="4e41c-173">**SetWindowExtEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-173">**SetWindowExtEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setwindowextex)<br/> [<span data-ttu-id="4e41c-174">**SetWindowOrgEx**</span><span class="sxs-lookup"><span data-stu-id="4e41c-174">**SetWindowOrgEx**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-setwindoworgex)<br/> [<span data-ttu-id="4e41c-175">**StretchBlt**</span><span class="sxs-lookup"><span data-stu-id="4e41c-175">**StretchBlt**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-stretchblt)<br/> [<span data-ttu-id="4e41c-176">**StretchDIBits**</span><span class="sxs-lookup"><span data-stu-id="4e41c-176">**StretchDIBits**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits)<br/> [<span data-ttu-id="4e41c-177">**TextOut**</span><span class="sxs-lookup"><span data-stu-id="4e41c-177">**TextOut**</span></span>](/windows/desktop/api/Wingdi/nf-wingdi-textouta)<br/> |



 

<span data-ttu-id="4e41c-178">若要將 Windows 格式中繼檔轉換成增強格式的中繼檔，請呼叫 [**GetMetaFileBitsEx**](/windows/desktop/api/Wingdi/nf-wingdi-getmetafilebitsex) 函式，從 Windows 格式中繼檔取出資料，然後呼叫 [**SetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setwinmetafilebits) 函式，將此資料轉換成增強格式的中繼檔。</span><span class="sxs-lookup"><span data-stu-id="4e41c-178">To convert a Windows-format metafile to an enhanced-format metafile, call the [**GetMetaFileBitsEx**](/windows/desktop/api/Wingdi/nf-wingdi-getmetafilebitsex) function to retrieve the data from the Windows-format metafile and then call the [**SetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setwinmetafilebits) function to convert this data into an enhanced-format metafile.</span></span> <span data-ttu-id="4e41c-179">若要將增強格式記錄轉換成 Windows 格式記錄，請呼叫 [**GetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getwinmetafilebits) 函數。</span><span class="sxs-lookup"><span data-stu-id="4e41c-179">To convert an enhanced-format record into a Windows-format record, call the [**GetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getwinmetafilebits) function.</span></span>

 

 
