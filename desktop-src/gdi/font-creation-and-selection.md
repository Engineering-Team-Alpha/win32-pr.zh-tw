---
description: '[字型通用] 對話方塊可簡化建立和選取字型的流程。'
ms.assetid: 7183be25-a8e4-47a0-a34a-63eadf6ca10d
title: 字型建立和選取
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 37b4a70a1a49fc318ca69998d97e15fca838668d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991247"
---
# <a name="font-creation-and-selection"></a><span data-ttu-id="e710c-103">字型建立和選取</span><span class="sxs-lookup"><span data-stu-id="e710c-103">Font Creation and Selection</span></span>

<span data-ttu-id="e710c-104">[ **字型** 通用] 對話方塊可簡化建立和選取字型的流程。</span><span class="sxs-lookup"><span data-stu-id="e710c-104">The **Font** common dialog box simplifies the process of creating and selecting fonts.</span></span> <span data-ttu-id="e710c-105">藉由初始化 [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) 結構並呼叫 [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) 函式，應用程式可以支援先前需要許多行自訂程式碼的相同字型選取介面。</span><span class="sxs-lookup"><span data-stu-id="e710c-105">By initializing the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure and calling the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function, an application can support the same font-selection interface that previously required many lines of custom code.</span></span> <span data-ttu-id="e710c-106"> (如需 [ **字型** 通用] 對話方塊的詳細資訊，請參閱 [通用對話方塊程式庫](../dlgbox/common-dialog-box-library.md)。 ) </span><span class="sxs-lookup"><span data-stu-id="e710c-106">(For more information about the **Font** common dialog box, see [Common Dialog Box Library](../dlgbox/common-dialog-box-library.md).)</span></span>

## <a name="selection-by-the-user"></a><span data-ttu-id="e710c-107">使用者選取</span><span class="sxs-lookup"><span data-stu-id="e710c-107">Selection by the User</span></span>

<span data-ttu-id="e710c-108">大部分的字型建立和選取作業都牽涉到使用者。</span><span class="sxs-lookup"><span data-stu-id="e710c-108">Most font creation and selection operations involve the user.</span></span> <span data-ttu-id="e710c-109">例如，文字處理應用程式可讓使用者選取標題、註腳和內文文字的唯一字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-109">For example, word processing applications let the user select unique fonts for headings, footnotes, and body text.</span></span> <span data-ttu-id="e710c-110">當使用者使用 [ **字型** ] 對話方塊選取字型，並按下 [ **確定]** 按鈕之後， [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) 函式就會使用所要求字型的屬性，初始化 [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) 結構的成員。</span><span class="sxs-lookup"><span data-stu-id="e710c-110">After the user selects a font by using the **Font** dialog box and presses the **OK** button, the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function initializes the members of a [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure with the attributes of the requested font.</span></span> <span data-ttu-id="e710c-111">若要使用此字型進行文字輸出作業，應用程式必須先建立邏輯字型，然後在其裝置內容中選取該字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-111">To use this font for text-output operations, an application must first create a logical font and then select that font into its device context.</span></span> <span data-ttu-id="e710c-112">*邏輯字型* 是應用程式提供的理想字型描述。</span><span class="sxs-lookup"><span data-stu-id="e710c-112">A *logical font* is an application-supplied description of an ideal font.</span></span> <span data-ttu-id="e710c-113">開發人員可以藉由呼叫 [**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta) 或 [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) 函數來建立邏輯字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-113">A developer can create a logical font by calling the [**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta) or the [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) functions.</span></span> <span data-ttu-id="e710c-114">在此情況下，應用程式會呼叫 [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) ，並提供 [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta)所初始化之 [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="e710c-114">In this case, the application would call [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) and supply a pointer to the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure initialized by [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta).</span></span> <span data-ttu-id="e710c-115">一般情況下，呼叫 **CreateFontIndirect** 會更有效率，因為 [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta) 需要數個參數，而 **CreateFontIndirect** 只需要一個 **LOGFONT** 指標。</span><span class="sxs-lookup"><span data-stu-id="e710c-115">In general, it is more efficient to call **CreateFontIndirect** because [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta) requires several parameters while **CreateFontIndirect** requires only one pointer to **LOGFONT**.</span></span>

<span data-ttu-id="e710c-116">在應用程式實際開始使用邏輯字型來繪製文字之前，它必須從儲存在裝置內部的字型，以及其資源已載入作業系統的字型中，找到最接近的相符項。</span><span class="sxs-lookup"><span data-stu-id="e710c-116">Before an application can actually begin drawing text with a logical font, it must find the closest match from the fonts stored internally on the device and the fonts whose resources have been loaded into the operating system.</span></span> <span data-ttu-id="e710c-117">存放在裝置或作業系統中的字型稱為「 *實體字型」*。</span><span class="sxs-lookup"><span data-stu-id="e710c-117">The fonts stored on the device or in the operating system are called *physical fonts*.</span></span> <span data-ttu-id="e710c-118">尋找最符合指定邏輯字型之實體字型的程式稱為字型對應。</span><span class="sxs-lookup"><span data-stu-id="e710c-118">The process of finding the physical font that most closely matches a specified logical font is called font mapping.</span></span> <span data-ttu-id="e710c-119">當應用程式呼叫 [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) 函式，並提供識別邏輯字型的控制碼時，就會發生此程式。</span><span class="sxs-lookup"><span data-stu-id="e710c-119">This process occurs when an application calls the [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) function and supplies a handle identifying a logical font.</span></span> <span data-ttu-id="e710c-120">字型對應的執行方式是使用內部演算法，將所要求邏輯字型的屬性與可用實體字型的屬性進行比較。</span><span class="sxs-lookup"><span data-stu-id="e710c-120">Font mapping is performed by using an internal algorithm that compares the attributes of the requested logical font against the attributes of available physical fonts.</span></span> <span data-ttu-id="e710c-121">當字型對應程式演算法完成其搜尋並判斷最接近的可能相符項時， [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject) 函式會傳回，而且應用程式可以開始使用新的字型來繪製文字。</span><span class="sxs-lookup"><span data-stu-id="e710c-121">When the font mapper algorithm completes its search and determines the closest possible match, the [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject) function returns and the application can begin drawing text with the new font.</span></span>

<span data-ttu-id="e710c-122">[**SetMapperFlags**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags)函式會指定字型對應程式演算法是否只搜尋外觀比例符合實體裝置的實體字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-122">The [**SetMapperFlags**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags) function specifies whether the font mapper algorithm searches only for physical fonts with aspect ratios that match the physical device.</span></span> <span data-ttu-id="e710c-123">裝置的外觀比例是以該裝置上的圖元寬度和高度所形成的比例。</span><span class="sxs-lookup"><span data-stu-id="e710c-123">The aspect ratio for a device is the ratio formed by the width and the height of a pixel on that device.</span></span>

<span data-ttu-id="e710c-124">系統字型 (也稱為 shell 或預設字型) 是標題列、功能表和對話方塊中文字所使用的字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-124">The system font (also known as the shell or default font) is the font used for text in the title bars, menus, and dialog boxes.</span></span>

## <a name="special-font-selection-considerations"></a><span data-ttu-id="e710c-125">特殊字型選擇考慮</span><span class="sxs-lookup"><span data-stu-id="e710c-125">Special Font Selection Considerations</span></span>

<span data-ttu-id="e710c-126">雖然大部分的字型選取作業都牽涉到使用者，但在某些情況下並不會發生此情況。</span><span class="sxs-lookup"><span data-stu-id="e710c-126">Although most font selection operations involve the user, there are some instances where this is not true.</span></span> <span data-ttu-id="e710c-127">例如，開發人員可能會想要在應用程式中使用唯一的字型，在控制項視窗中繪製文字。</span><span class="sxs-lookup"><span data-stu-id="e710c-127">For example, a developer may want to use a unique font in an application to draw text in a control window.</span></span> <span data-ttu-id="e710c-128">若要選取適當的字型，應用程式必須能夠判斷可用的字型、建立描述其中一種可用字型的邏輯字型，然後在適當的裝置內容中選取該字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-128">To select an appropriate font, the application must be able to determine what fonts are available, create a logical font that describes one of these available fonts, and then select that font into the appropriate device context.</span></span>

<span data-ttu-id="e710c-129">應用程式可以使用 [**EnumFonts**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontsa) 或 [**>enumfontfamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) 函數來列舉可用的字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-129">An application can enumerate the available fonts by using the [**EnumFonts**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontsa) or [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) functions.</span></span> <span data-ttu-id="e710c-130">建議使用 [**>enumfontfamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa) ，因為它會列舉與系列名稱相關聯的所有樣式。</span><span class="sxs-lookup"><span data-stu-id="e710c-130">[**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa) is recommended because it enumerates all the styles associated with a family name.</span></span> <span data-ttu-id="e710c-131">如果字型具有許多或不尋常的樣式，以及跨國際框線的字型，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="e710c-131">This can be useful for fonts with many or unusual styles and for fonts that cross international borders.</span></span>

<span data-ttu-id="e710c-132">一旦應用程式列舉可用的字型，並找到適當的相符項，就應該使用字型列舉函數所傳回的值，初始化 [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) 結構的成員。</span><span class="sxs-lookup"><span data-stu-id="e710c-132">Once an application has enumerated the available fonts and located an appropriate match, it should use the values returned by the font enumeration function to initialize the members of a [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure.</span></span> <span data-ttu-id="e710c-133">然後，它可以呼叫 [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) 函式，並將指標傳遞至初始化的 [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) 結構。</span><span class="sxs-lookup"><span data-stu-id="e710c-133">Then it can call the [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta) function, passing to it a pointer to the initialized [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure.</span></span> <span data-ttu-id="e710c-134">如果 [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) 函式成功，則應用程式可以藉由呼叫 [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) 函數來選取邏輯字型。</span><span class="sxs-lookup"><span data-stu-id="e710c-134">If the [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta) function is successful, the application can then select the logical font by calling the [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) function.</span></span> <span data-ttu-id="e710c-135">當初始化 **LOGFONT** 結構的成員時，請務必在 **lfCharSet** 成員中指定特定字元集。</span><span class="sxs-lookup"><span data-stu-id="e710c-135">When initializing the members of the **LOGFONT** structure, be sure to specify a specific character set in the **lfCharSet** member.</span></span> <span data-ttu-id="e710c-136">這個成員在字型對應程式中很重要，如果這個成員未正確初始化，結果會不一致。</span><span class="sxs-lookup"><span data-stu-id="e710c-136">This member is important in the font mapping process and the results will be inconsistent if this member is not initialized correctly.</span></span> <span data-ttu-id="e710c-137">如果您在 **LOGFONT** 結構的 **lfFaceName** 成員中指定了字樣名稱，請確定 **lfCharSet** 值符合 **lfFaceName** 中指定的字樣字元集。</span><span class="sxs-lookup"><span data-stu-id="e710c-137">If you specify a typeface name in the **lfFaceName** member of the **LOGFONT** structure, make sure that the **lfCharSet** value matches the character set of the typeface specified in **lfFaceName**.</span></span> <span data-ttu-id="e710c-138">例如，如果您想要選取 MS Mincho 等字型， **lfCharSet** 必須設定為預先定義的 SHIFTJIS \_ 字元集值。</span><span class="sxs-lookup"><span data-stu-id="e710c-138">For example, if you want to select a font such as MS Mincho, **lfCharSet** must be set to the predefined value SHIFTJIS\_CHARSET.</span></span>

<span data-ttu-id="e710c-139">許多東亞語言的字型都有兩個字型名稱：英文名稱和當地語系化名稱。</span><span class="sxs-lookup"><span data-stu-id="e710c-139">The fonts for many East Asian languages have two typeface names: an English name and a localized name.</span></span> <span data-ttu-id="e710c-140">[**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta)、 [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta)和 [**CreateFontIndirectEx**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirectexa) 會針對符合語言的系統地區設定採用當地語系化的字樣名稱，但會針對所有其他的系統地區設定採用英文的字樣名稱。</span><span class="sxs-lookup"><span data-stu-id="e710c-140">[**CreateFont**](/windows/desktop/api/Wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta), and [**CreateFontIndirectEx**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirectexa) take the localized typeface name for a system locale that matches the language, but they take the English typeface name for all other system locales.</span></span> <span data-ttu-id="e710c-141">最佳方法是嘗試一個名稱，並在失敗時嘗試另一個名稱。</span><span class="sxs-lookup"><span data-stu-id="e710c-141">The best method is to try one name and, on failure, try the other.</span></span> <span data-ttu-id="e710c-142">請注意，如果系統地區設定與字型的語言不符， [**EnumFonts**](/windows/win32/api/wingdi/nf-wingdi-enumfontsa)、 [**>enumfontfamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa)和 [**EnumFontFamiliesEx**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesexa) 會傳回英文字型名稱。</span><span class="sxs-lookup"><span data-stu-id="e710c-142">Note that [**EnumFonts**](/windows/win32/api/wingdi/nf-wingdi-enumfontsa), [**EnumFontFamilies**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesa), and [**EnumFontFamiliesEx**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesexa) return the English typeface name if the system locale does not match the language of the font.</span></span> <span data-ttu-id="e710c-143">從 Windows 2000 開始，這不再是問題，因為 [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta)、 [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta)和 [**CreateFontIndirectEx**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa) 的字型對應程式都會辨識字型名稱，不論地區設定為何。</span><span class="sxs-lookup"><span data-stu-id="e710c-143">Starting with Windows 2000, this is no longer a problem because the font mapper for [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta), and [**CreateFontIndirectEx**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa) recognizes either typeface name, regardless of locale.</span></span>

 

 
