---
description: 您可以使用 CreateEnhMetaFile 函式來建立增強的中繼檔，以提供適當的引數。
ms.assetid: b012e50e-a7f5-4687-9833-38dacc113d77
title: 增強的中繼檔建立
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 080c350e41e895c5d4bf834a6f407cca5907743d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103691884"
---
# <a name="enhanced-metafile-creation"></a><span data-ttu-id="f42d8-103">增強的中繼檔建立</span><span class="sxs-lookup"><span data-stu-id="f42d8-103">Enhanced Metafile Creation</span></span>

<span data-ttu-id="f42d8-104">您可以使用 [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) 函式來建立增強的中繼檔，以提供適當的引數。</span><span class="sxs-lookup"><span data-stu-id="f42d8-104">You create an enhanced metafile by using the [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) function, supplying the appropriate arguments.</span></span> <span data-ttu-id="f42d8-105">系統會使用這些引數來維護圖片尺寸、判斷中繼檔是否應該儲存在磁片或記憶體中等等。</span><span class="sxs-lookup"><span data-stu-id="f42d8-105">The system uses these arguments to maintain picture dimensions, determine whether the metafile should be stored on a disk or in memory, and so on.</span></span>

<span data-ttu-id="f42d8-106">若要跨輸出裝置維護圖片尺寸， [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) 需要解析參考裝置。</span><span class="sxs-lookup"><span data-stu-id="f42d8-106">To maintain picture dimensions across output devices, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) requires the resolution of the reference device.</span></span> <span data-ttu-id="f42d8-107">此 *參照裝置* 是圖片第一次出現的裝置，而 *參考 DC* 則是與參考裝置相關聯的 *裝置內容* 。</span><span class="sxs-lookup"><span data-stu-id="f42d8-107">This *reference device* is the device on which the picture first appeared, and the *reference DC* is the *device context* associated with the reference device.</span></span> <span data-ttu-id="f42d8-108">呼叫 **CreateEnhMetaFile** 函式時，您必須提供識別此 DC 的控制碼。</span><span class="sxs-lookup"><span data-stu-id="f42d8-108">When calling the **CreateEnhMetaFile** function, you must supply a handle that identifies this DC.</span></span> <span data-ttu-id="f42d8-109">您可以藉由呼叫 [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) 或 [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) 函數來取得此控制碼。</span><span class="sxs-lookup"><span data-stu-id="f42d8-109">You can get this handle by calling the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) or [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) function.</span></span> <span data-ttu-id="f42d8-110">您也可以指定 **Null** 做為控制碼，以使用目前的顯示裝置作為參考裝置。</span><span class="sxs-lookup"><span data-stu-id="f42d8-110">You can also specify **NULL** as the handle to use the current display device for the reference device.</span></span>

<span data-ttu-id="f42d8-111">大部分的應用程式會永久儲存圖片，因而建立儲存在磁片上的增強中繼檔;不過，在某些情況下並不需要這麼做。</span><span class="sxs-lookup"><span data-stu-id="f42d8-111">Most applications store pictures permanently and therefore create an enhanced metafile that is stored on a disk; however, there are some instances when this is not necessary.</span></span> <span data-ttu-id="f42d8-112">例如，提供圖表繪圖功能的文書處理應用程式，可以將使用者定義的圖表以增強中繼檔的形式儲存在記憶體中，然後將增強的中繼檔位從記憶體複製到使用者的檔檔案中。</span><span class="sxs-lookup"><span data-stu-id="f42d8-112">For example, a word-processing application that provides chart-drawing capabilities could store a user-defined chart in memory as an enhanced metafile and then copy the enhanced metafile bits from memory into the user's document file.</span></span> <span data-ttu-id="f42d8-113">需要在磁片上永久儲存之中繼檔的應用程式，必須在呼叫 [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea)時提供檔案名。</span><span class="sxs-lookup"><span data-stu-id="f42d8-113">An application that requires a metafile that is stored permanently on a disk must supply the file name when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span> <span data-ttu-id="f42d8-114">如果未提供檔案名，系統會自動將中繼檔視為暫存檔案，並將它儲存在記憶體中。</span><span class="sxs-lookup"><span data-stu-id="f42d8-114">If you do not supply a file name, the system automatically treats the metafile as a temporary file and stores it in memory.</span></span>

<span data-ttu-id="f42d8-115">您可以在包含圖片和作者相關資訊的中繼檔中加入選擇性的文字描述。</span><span class="sxs-lookup"><span data-stu-id="f42d8-115">You can add an optional text description to a metafile containing information about the picture and the author.</span></span> <span data-ttu-id="f42d8-116">應用程式可以在 [開啟檔案] 對話方塊中顯示這些字串，為使用者提供可協助您選取適當檔案的中繼檔內容相關資訊。</span><span class="sxs-lookup"><span data-stu-id="f42d8-116">An application can display these strings in the File Open dialog box to provide the user with information about metafile content that will help in selecting the appropriate file.</span></span> <span data-ttu-id="f42d8-117">如果應用程式包含文字描述，則在呼叫 [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea)時，必須提供指向字串的指標。</span><span class="sxs-lookup"><span data-stu-id="f42d8-117">If an application includes the text description, it must supply a pointer to the string when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span>

<span data-ttu-id="f42d8-118">當 [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) 成功時，它會傳回一個控制碼來識別特殊的中繼檔裝置內容。</span><span class="sxs-lookup"><span data-stu-id="f42d8-118">When [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) succeeds, it returns a handle that identifies a special metafile device context.</span></span> <span data-ttu-id="f42d8-119">中繼檔裝置內容是唯一的，因為它會與檔案相關聯，而不是輸出裝置。</span><span class="sxs-lookup"><span data-stu-id="f42d8-119">A metafile device context is unique in that it is associated with a file rather than with an output device.</span></span> <span data-ttu-id="f42d8-120">當系統處理接收到中繼檔裝置內容之控制碼的 GDI 函式時，它會將 GDI 函數轉換成增強的中繼檔記錄，並將記錄附加至增強型中繼檔的結尾。</span><span class="sxs-lookup"><span data-stu-id="f42d8-120">When the system processes a GDI function that received a handle to a metafile device context, it converts the GDI function into an enhanced-metafile record and appends the record to the end of the enhanced metafile.</span></span>

<span data-ttu-id="f42d8-121">在圖片完成並將最後一筆記錄附加至增強型中繼檔之後，應用程式可以藉由呼叫 [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) 函式來關閉檔案。</span><span class="sxs-lookup"><span data-stu-id="f42d8-121">After a picture is complete and the last record is appended to the enhanced metafile, the application can close the file by calling the [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) function.</span></span> <span data-ttu-id="f42d8-122">此函式會關閉並刪除特殊的中繼檔裝置內容，並傳回識別增強中繼檔的控制碼。</span><span class="sxs-lookup"><span data-stu-id="f42d8-122">This function closes and deletes the special metafile device context and returns a handle identifying the enhanced metafile.</span></span>

<span data-ttu-id="f42d8-123">若要刪除增強格式的中繼檔或增強格式的中繼檔控制碼，請呼叫 [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) 函數。</span><span class="sxs-lookup"><span data-stu-id="f42d8-123">To delete an enhanced-format metafile or an enhanced-format metafile handle, call the [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) function.</span></span>

 

 



