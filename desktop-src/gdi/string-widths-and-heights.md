---
description: 除了針對個別字元抓取字元寬度的資料之外，應用程式也需要計算整個字串的寬度和高度。
ms.assetid: 0c1d9142-258a-447f-8950-8d684645383b
title: 字串寬度和高度
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f57846d0588c518f445523361ae186e4b966bf93
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103848895"
---
# <a name="string-widths-and-heights"></a><span data-ttu-id="5f9b5-103">字串寬度和高度</span><span class="sxs-lookup"><span data-stu-id="5f9b5-103">String Widths and Heights</span></span>

<span data-ttu-id="5f9b5-104">除了針對個別字元抓取字元寬度的資料之外，應用程式也需要計算整個字串的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-104">In addition to retrieving character-width data for individual characters, applications also need to compute the width and height of entire strings.</span></span> <span data-ttu-id="5f9b5-105">兩個函式會取出字串寬度和高度測量： [**GetTextExtentPoint32**](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a)和 [**GetTabbedTextExtent**](/windows/desktop/api/Winuser/nf-winuser-gettabbedtextextenta)。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-105">Two functions retrieve string-width and height measurements: [**GetTextExtentPoint32**](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a), and [**GetTabbedTextExtent**](/windows/desktop/api/Winuser/nf-winuser-gettabbedtextextenta).</span></span> <span data-ttu-id="5f9b5-106">如果字串不包含定位字元，則應用程式可以使用 **GetTextExtentPoint32** 函式來取得指定之字串的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-106">If the string does not contain tab characters, an application can use the **GetTextExtentPoint32** function to retrieve the width and height of a specified string.</span></span> <span data-ttu-id="5f9b5-107">如果字串包含定位字元，則應用程式應該呼叫 GetTabbedTextExtent 函數。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-107">If the string contains tab characters, an application should call the GetTabbedTextExtent function.</span></span>

<span data-ttu-id="5f9b5-108">應用程式可以使用 [**GetTextExtentExPoint**](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentexpointa) 函式進行自動換行作業。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-108">Applications can use the [**GetTextExtentExPoint**](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentexpointa) function for word-wrapping operations.</span></span> <span data-ttu-id="5f9b5-109">此函式會從指定的字串中傳回符合指定空間的字元數。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-109">This function returns the number of characters from a specified string that fit within a specified space.</span></span>

## <a name="font-ascenders-and-descenders"></a><span data-ttu-id="5f9b5-110">字型 Ascenders 和下行</span><span class="sxs-lookup"><span data-stu-id="5f9b5-110">Font Ascenders and Descenders</span></span>

<span data-ttu-id="5f9b5-111">有些應用程式會使用字型的最大 ascender 和下行，來決定不同大小的文字行間距。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-111">Some applications determine the line spacing between text lines of different sizes by using a font's maximum ascender and descender.</span></span> <span data-ttu-id="5f9b5-112">應用程式可以藉由呼叫 [**GetTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-gettextmetrics)函數，然後檢查 [**TEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-textmetrica)的 **tmAscent** 和 **tmDescent** 成員，來取得這些值。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-112">An application can retrieve these values by calling the [**GetTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-gettextmetrics) function and then checking the **tmAscent** and **tmDescent** members of the [**TEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-textmetrica).</span></span>

<span data-ttu-id="5f9b5-113">最大升高和下降與印刷樣式升高和下降不同。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-113">The maximum ascent and descent are different from the typographic ascent and descent.</span></span> <span data-ttu-id="5f9b5-114">在 TrueType 和 OpenType 字型中，印刷樣式升高和下降通常是 g 字元的 f 圖像和底部的頂端。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-114">In TrueType and OpenType fonts, the typographic ascent and descent are typically the top of the f glyph and bottom of the g glyph.</span></span> <span data-ttu-id="5f9b5-115">應用程式可以透過呼叫 [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa)函式並檢查 [**OUTLINETEXTMETRIC**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica)結構的 **otmMacAscent** 和 **otmMacDescent** 成員中的值，來取得 TrueType 或 OpenType 字型的印刷樣式 ascender 和下行。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-115">An application can retrieve the typographic ascender and descender for a TrueType or OpenType font by calling the [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) function and checking the values in the **otmMacAscent** and **otmMacDescent** members of the [**OUTLINETEXTMETRIC**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) structure.</span></span>

<span data-ttu-id="5f9b5-116">下圖顯示 [**NEWTEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-newtextmetrica) 和 [**OUTLINETEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) 結構中所傳回之垂直文字度量值之間的差異。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-116">The following figure shows the difference between the vertical text metric values returned in the [**NEWTEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-newtextmetrica) and [**OUTLINETEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) structures.</span></span> <span data-ttu-id="5f9b5-117"> (開頭為 otm 的名稱是 **OUTLINETEXTMETRIC** 結構的成員。 ) </span><span class="sxs-lookup"><span data-stu-id="5f9b5-117">(The names beginning with otm are members of the **OUTLINETEXTMETRIC** structure.)</span></span>

![顯示文字度量值與外框文字度量值對比的圖例](images/csftx-03.png)

## <a name="font-dimensions"></a><span data-ttu-id="5f9b5-119">字型維度</span><span class="sxs-lookup"><span data-stu-id="5f9b5-119">Font Dimensions</span></span>

<span data-ttu-id="5f9b5-120">應用程式可以藉由呼叫 [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) 函式來取得 TrueType 或 OpenType 字型的實體維度。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-120">An application can retrieve the physical dimensions of a TrueType or OpenType font by calling the [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) function.</span></span> <span data-ttu-id="5f9b5-121">應用程式可以藉由呼叫 [**GetTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-gettextmetrics) 函式來取出任何其他字型的實體維度。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-121">An application can retrieve the physical dimensions of any other font by calling the [**GetTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-gettextmetrics) function.</span></span> <span data-ttu-id="5f9b5-122">若要判斷輸出裝置的維度，應用程式可以呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函數。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-122">To determine the dimensions of an output device, an application can call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function.</span></span> <span data-ttu-id="5f9b5-123">**GetDeviceCaps** 會傳回實體和邏輯維度。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-123">**GetDeviceCaps** returns both physical and logical dimensions.</span></span>

<span data-ttu-id="5f9b5-124">邏輯英寸是系統用來在螢幕上呈現清晰清晰字型的量值，大約30到40% 的百分比大於實體英寸。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-124">A logical inch is a measure the system uses to present legible fonts on the screen and is approximately 30 to 40 percent larger than a physical inch.</span></span> <span data-ttu-id="5f9b5-125">使用邏輯英寸可在螢幕和印表機的輸出之間排除完全相符的結果。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-125">The use of logical inches precludes an exact match between the output of the screen and printer.</span></span> <span data-ttu-id="5f9b5-126">開發人員應該要注意的是，畫面上的文字並不只是頁面上顯示的文字縮放版本，尤其是將圖形併入文字時。</span><span class="sxs-lookup"><span data-stu-id="5f9b5-126">Developers should be aware that the text on a screen is not simply a scaled version of the text that will appear on the page, particularly if graphics are incorporated into the text.</span></span>

 

 
