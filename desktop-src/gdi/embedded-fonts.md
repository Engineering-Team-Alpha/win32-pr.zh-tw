---
description: 內嵌字型是將檔和其包含的字型組合到檔案中，以傳輸到另一部電腦的技術。
ms.assetid: ded409f1-5bd9-411b-b905-fc49c484786a
title: 內嵌字型
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83fb8ab821afa5f44ded05a4a61a53439b8db9fc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114665"
---
# <a name="embedded-fonts"></a><span data-ttu-id="56423-103">內嵌字型</span><span class="sxs-lookup"><span data-stu-id="56423-103">Embedded Fonts</span></span>

<span data-ttu-id="56423-104">內嵌字型是將檔和其包含的字型組合到檔案中，以傳輸到另一部電腦的技術。</span><span class="sxs-lookup"><span data-stu-id="56423-104">Embedding a font is the technique of bundling a document and the fonts it contains into a file for transmission to another computer.</span></span> <span data-ttu-id="56423-105">內嵌字型可保證傳送檔案中指定的字型，將會出現在接收檔案的電腦上。</span><span class="sxs-lookup"><span data-stu-id="56423-105">Embedding a font guarantees that a font specified in a transmitted file will be present on the computer receiving the file.</span></span> <span data-ttu-id="56423-106">不過，並非所有字型都可以從電腦移到電腦，因為大部分的字型一次只授權給一部電腦。</span><span class="sxs-lookup"><span data-stu-id="56423-106">Not all fonts can be moved from computer to computer, however, since most fonts are licensed to only one computer at a time.</span></span> <span data-ttu-id="56423-107">只有 TrueType 和 OpenType 字型可以內嵌。</span><span class="sxs-lookup"><span data-stu-id="56423-107">Only TrueType and OpenType fonts can be embedded.</span></span>

<span data-ttu-id="56423-108">應用程式應該只在使用者要求時，才將字型嵌入檔中。</span><span class="sxs-lookup"><span data-stu-id="56423-108">Applications should embed a font in a document only when requested by a user.</span></span> <span data-ttu-id="56423-109">應用程式無法和包含內嵌字型的檔一起散發，也不能讓應用程式本身包含內嵌字型。</span><span class="sxs-lookup"><span data-stu-id="56423-109">An application cannot be distributed along with documents that contain embedded fonts, nor can an application itself contain an embedded font.</span></span> <span data-ttu-id="56423-110">只要應用程式散佈任何格式的字型，就必須確認字型擁有者的專屬許可權。</span><span class="sxs-lookup"><span data-stu-id="56423-110">Whenever an application distributes a font, in any format, the proprietary rights of the owner of the font must be acknowledged.</span></span>

<span data-ttu-id="56423-111">可能違反字型廠商的專利權利或使用者授權合約，以內嵌不允許內嵌的任何字型，或無法觀察下列內嵌字型的指導方針。</span><span class="sxs-lookup"><span data-stu-id="56423-111">It may be a violation of a font vendor's proprietary rights or user license agreement to embed any fonts where embedding is not permitted or to fail to observe the following guidelines on embedding fonts.</span></span> <span data-ttu-id="56423-112">字型的授權可能只會提供要在目的地電腦上安裝和使用之字型的讀取/寫入權限。</span><span class="sxs-lookup"><span data-stu-id="56423-112">A font's license may give only read/write permission for a font to be installed and used on the destination computer.</span></span> <span data-ttu-id="56423-113">或授權可能會授與唯讀許可權。</span><span class="sxs-lookup"><span data-stu-id="56423-113">Or the license may give read-only permission.</span></span> <span data-ttu-id="56423-114">[唯讀] 許可權可讓您將檔 (查看和列印，但不能由目的地電腦) 修改;具有唯讀內嵌字型的檔本身是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="56423-114">Read-only permission allows a document to be viewed and printed (but not modified) by the destination computer; documents with read-only embedded fonts are themselves read-only.</span></span> <span data-ttu-id="56423-115">唯讀內嵌字型可能無法從檔解除捆搭，並安裝在目的地電腦上。</span><span class="sxs-lookup"><span data-stu-id="56423-115">Read-only embedded fonts may not be unbundled from the document and installed on the destination computer.</span></span>

<span data-ttu-id="56423-116">應用程式可以藉由呼叫 [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa)函式，並檢查 [**OUTLINETEXTMETRIC**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica)結構的 **otmfsType** 成員，來判斷授權狀態。</span><span class="sxs-lookup"><span data-stu-id="56423-116">An application can determine the license status by calling the [**GetOutlineTextMetrics**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) function and examining the **otmfsType** member of the [**OUTLINETEXTMETRIC**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) structure.</span></span> <span data-ttu-id="56423-117">如果設定了 **otmfsType** 的位1，字型就不允許內嵌。</span><span class="sxs-lookup"><span data-stu-id="56423-117">If bit 1 of **otmfsType** is set, embedding is not permitted for the font.</span></span> <span data-ttu-id="56423-118">如果 bit 1 為 clear，則可以內嵌字型。</span><span class="sxs-lookup"><span data-stu-id="56423-118">If bit 1 is clear, the font can be embedded.</span></span> <span data-ttu-id="56423-119">如果設定了位2，則內嵌是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="56423-119">If bit 2 is set, the embedding is read-only.</span></span>

<span data-ttu-id="56423-120">若要內嵌 TrueType 字型，應用程式可以使用 [**GetFontData**](/windows/desktop/api/Wingdi/nf-wingdi-getfontdata) 函式來讀取字型檔案。</span><span class="sxs-lookup"><span data-stu-id="56423-120">To embed a TrueType font, an application can use the [**GetFontData**](/windows/desktop/api/Wingdi/nf-wingdi-getfontdata) function to read the font file.</span></span> <span data-ttu-id="56423-121">將 [**GetFontData**](/windows/win32/api/wingdi/nf-wingdi-getfontdata)的 *dwTable* 和 *dwOffset* 參數設定為0L，並將 *cbData* 參數設定為1L，可確保應用程式從一開始就讀取整個字型檔案。</span><span class="sxs-lookup"><span data-stu-id="56423-121">Setting the *dwTable* and *dwOffset* parameters of [**GetFontData**](/windows/win32/api/wingdi/nf-wingdi-getfontdata) to 0L and the *cbData* parameter to 1L ensures that the application reads the entire font file from the beginning.</span></span>

<span data-ttu-id="56423-122">有幾個函式可用來根據字元寬度以及字型資料所在的位置，來內嵌 OpenType 字型。</span><span class="sxs-lookup"><span data-stu-id="56423-122">Several functions are available to embed OpenType fonts depending on the character width and where the font data resides.</span></span> <span data-ttu-id="56423-123">若要內嵌位於裝置內容中的 OpenType Unicode 字型，應用程式可以使用 [**TTEmbedFont**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfont)。</span><span class="sxs-lookup"><span data-stu-id="56423-123">To embed an OpenType Unicode font that resides in a device context, an application can use [**TTEmbedFont**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfont).</span></span> <span data-ttu-id="56423-124">若要內嵌位於裝置內容中的 OpenType UCS-4 字型，應用程式可以使用 [**TTEmbedFontEx**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontex)。</span><span class="sxs-lookup"><span data-stu-id="56423-124">To embed an OpenType UCS-4 font that resides in a device context, an application can use [**TTEmbedFontEx**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontex).</span></span> <span data-ttu-id="56423-125">若要內嵌位於字型檔案中的 OpenType Unicode 字型，應用程式可以使用 [**TTEmbedFontFromFile**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontfromfilea)。</span><span class="sxs-lookup"><span data-stu-id="56423-125">To embed an OpenType Unicode font that resides in a font file, an application can use [**TTEmbedFontFromFile**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontfromfilea).</span></span> <span data-ttu-id="56423-126">如需 OpenType 字型內嵌的詳細資訊，請參閱 [字體內嵌參考](font-embedding-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="56423-126">For additional information on OpenType font embedding, see the [Font Embedding Reference](font-embedding-reference.md).</span></span>

<span data-ttu-id="56423-127">在應用程式抓取字型資料之後，可以使用任何適用的格式，將資料儲存在檔中。</span><span class="sxs-lookup"><span data-stu-id="56423-127">After an application retrieves the font data, it can store the data with the document by using any applicable format.</span></span> <span data-ttu-id="56423-128">大部分的應用程式會在檔中建立字型目錄、列出內嵌字型，以及內嵌是可讀寫或唯讀的。</span><span class="sxs-lookup"><span data-stu-id="56423-128">Most applications build a font directory in the document, listing the embedded fonts and whether the embedding is read/write or read-only.</span></span> <span data-ttu-id="56423-129">應用程式可以使用 [**OUTLINETEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica)結構的 **otmpStyleName** 和 **otmFamilyName** 成員來識別字型。</span><span class="sxs-lookup"><span data-stu-id="56423-129">An application can use the **otmpStyleName** and **otmFamilyName** members of the [**OUTLINETEXTMETRIC**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) structure to identify the font.</span></span>

<span data-ttu-id="56423-130">如果已針對內嵌字型設定唯讀位，則應用程式在將字型資料儲存在檔之前，必須先將其加密。</span><span class="sxs-lookup"><span data-stu-id="56423-130">If the read-only bit is set for the embedded font, applications must encrypt the font data before storing it with the document.</span></span> <span data-ttu-id="56423-131">加密方法不需要複雜;例如，使用 XOR 運算子將字型資料與應用程式定義的常數結合，是足夠且快速的。</span><span class="sxs-lookup"><span data-stu-id="56423-131">The encryption method need not be complicated; for example, using the XOR operator to combine the font data with an application-defined constant is adequate and fast.</span></span>

 

 
