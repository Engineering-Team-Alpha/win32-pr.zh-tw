---
description: '\_當視窗的非工作區的一部分（例如標題列、功能表列或視窗框架）必須更新時，系統就會將 WM NCPAINT 訊息傳送至視窗。'
ms.assetid: e4dc61f3-6a9f-4ed4-8685-62eb4ceb85f1
title: 非工作區
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c51da31709f5bd9326cc0d05a9e37e2df78bfbb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104191930"
---
# <a name="nonclient-area"></a><span data-ttu-id="f942d-103">非工作區</span><span class="sxs-lookup"><span data-stu-id="f942d-103">Nonclient Area</span></span>

<span data-ttu-id="f942d-104">當視窗的非工作區的一部分（例如標題列、功能表列或視窗框架）必須更新時，系統就會將 [**WM \_ NCPAINT**](wm-ncpaint.md) 訊息傳送至視窗。</span><span class="sxs-lookup"><span data-stu-id="f942d-104">The system sends a [**WM\_NCPAINT**](wm-ncpaint.md) message to the window whenever a part of the nonclient area of the window, such as the title bar, menu bar, or window frame, must be updated.</span></span> <span data-ttu-id="f942d-105">系統也可能會傳送其他訊息，以指示視窗更新部分的工作區。例如，當視窗變成作用中或非使用中時，它會傳送 [**WM \_ NCACTI加值稅E**](../winmsg/wm-ncactivate.md) 訊息來更新其標題列。</span><span class="sxs-lookup"><span data-stu-id="f942d-105">The system may also send other messages to direct a window to update a portion of its client area; for example, when a window becomes active or inactive, it sends the [**WM\_NCACTIVATE**](../winmsg/wm-ncactivate.md) message to update its title bar.</span></span> <span data-ttu-id="f942d-106">一般情況下，不建議處理標準視窗的這些訊息，因為應用程式必須能夠為視窗的非工作區繪製所有必要的部分。</span><span class="sxs-lookup"><span data-stu-id="f942d-106">In general, processing these messages for standard windows is not recommended, because the application must be able to draw all the required parts of the nonclient area for the window.</span></span> <span data-ttu-id="f942d-107">基於這個理由，大部分的應用程式都會將這些訊息傳遞給 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) ，以進行預設處理。</span><span class="sxs-lookup"><span data-stu-id="f942d-107">For this reason, most applications pass these messages to [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) for default processing.</span></span>

<span data-ttu-id="f942d-108">為其 windows 建立自訂非工作區的應用程式必須處理這些訊息。</span><span class="sxs-lookup"><span data-stu-id="f942d-108">An application that creates custom nonclient areas for its windows must process these messages.</span></span> <span data-ttu-id="f942d-109">當您這樣做時，應用程式必須使用視窗裝置內容在視窗中執行繪圖。</span><span class="sxs-lookup"><span data-stu-id="f942d-109">When doing so, the application must use a window device context to carry out drawing in the window.</span></span> <span data-ttu-id="f942d-110">*視窗裝置內容* 可讓應用程式在視窗的所有部分（包括非工作區）中繪製。</span><span class="sxs-lookup"><span data-stu-id="f942d-110">The *window device context* enables the application to draw in all portions of the window, including the nonclient area.</span></span> <span data-ttu-id="f942d-111">應用程式會使用 [**GetWindowDC**](/windows/desktop/api/Winuser/nf-winuser-getwindowdc) 或 [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) 函式來抓取視窗裝置內容，而且當繪圖完成時，必須使用 [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) 函式來釋放視窗裝置內容。</span><span class="sxs-lookup"><span data-stu-id="f942d-111">An application retrieves a window device context by using the [**GetWindowDC**](/windows/desktop/api/Winuser/nf-winuser-getwindowdc) or [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function and, when drawing is complete, must release the window device context by using the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function.</span></span>

<span data-ttu-id="f942d-112">系統會維護非工作區的更新區域。</span><span class="sxs-lookup"><span data-stu-id="f942d-112">The system maintains an update region for the nonclient area.</span></span> <span data-ttu-id="f942d-113">當應用程式收到 [**WM \_ NCPAINT**](wm-ncpaint.md) 訊息時， *wParam* 參數會包含定義更新區域維度之區域的控制碼。</span><span class="sxs-lookup"><span data-stu-id="f942d-113">When an application receives a [**WM\_NCPAINT**](wm-ncpaint.md) message, the *wParam* parameter contains a handle to a region defining the dimensions of the update region.</span></span> <span data-ttu-id="f942d-114">應用程式可以使用此控制碼，將更新區域與視窗裝置內容的裁剪區域合併。</span><span class="sxs-lookup"><span data-stu-id="f942d-114">The application can use the handle to combine the update region with the clipping region for the window device context.</span></span> <span data-ttu-id="f942d-115">除非應用程式使用 [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) 並同時指定區域控制碼和 DCX INTERSECTRGN 旗標，否則系統不會在抓取視窗裝置內容時自動合併更新區域 \_ 。</span><span class="sxs-lookup"><span data-stu-id="f942d-115">The system does not automatically combine the update region when retrieving the window device context unless the application uses [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) and specifies both the region handle and the DCX\_INTERSECTRGN flag.</span></span> <span data-ttu-id="f942d-116">如果應用程式未結合更新區域，則只會裁剪在視窗之外延伸的繪圖作業。</span><span class="sxs-lookup"><span data-stu-id="f942d-116">If the application does not combine the update region, only drawing operations that would otherwise extend outside the window are clipped.</span></span> <span data-ttu-id="f942d-117">應用程式不負責清除更新區域，不論它是否使用該區域。</span><span class="sxs-lookup"><span data-stu-id="f942d-117">The application is not responsible for clearing the update region, regardless of whether it uses the region.</span></span>

<span data-ttu-id="f942d-118">如果應用程式處理 [**WM \_ NCACTI加值稅E**](../winmsg/wm-ncactivate.md) 訊息，則在處理之後必須傳回 **TRUE** ，以指示系統完成使用中視窗的變更。</span><span class="sxs-lookup"><span data-stu-id="f942d-118">If an application processes the [**WM\_NCACTIVATE**](../winmsg/wm-ncactivate.md) message, after processing it must return **TRUE** to direct the system to complete the change of active window.</span></span> <span data-ttu-id="f942d-119">當應用程式收到 **WM \_ NCACTI加值稅E** 訊息時，如果視窗最小化，則應該將訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca)。</span><span class="sxs-lookup"><span data-stu-id="f942d-119">If the window is minimized when the application receives the **WM\_NCACTIVATE** message, it should pass the message to [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="f942d-120">在這種情況下，預設函式會重繪圖示的標籤。</span><span class="sxs-lookup"><span data-stu-id="f942d-120">In such cases, the default function redraws the label for the icon.</span></span>

 

 
