---
description: 藉由使用類別裝置內容，應用程式可以針對屬於指定類別的每個視窗使用單一顯示裝置內容。
ms.assetid: fc76abbf-68da-47f2-8145-4fad806297b4
title: 類別顯示裝置內容
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e5a4cc0268d948e1a6f95050409698217e3f13e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104972764"
---
# <a name="class-display-device-contexts"></a><span data-ttu-id="8a382-103">類別顯示裝置內容</span><span class="sxs-lookup"><span data-stu-id="8a382-103">Class Display Device Contexts</span></span>

<span data-ttu-id="8a382-104">藉由使用 *類別裝置內容*，應用程式可以針對屬於指定類別的每個視窗使用單一顯示裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-104">By using a *class device context*, an application can use a single display device context for every window belonging to a specified class.</span></span> <span data-ttu-id="8a382-105">類別裝置內容通常會搭配使用相同屬性值繪製的控制項視窗使用。</span><span class="sxs-lookup"><span data-stu-id="8a382-105">Class device contexts are often used with control windows that are drawn using the same attribute values.</span></span> <span data-ttu-id="8a382-106">如同私用裝置內容，類別裝置內容會將準備裝置內容以進行繪製所需的時間降到最低。</span><span class="sxs-lookup"><span data-stu-id="8a382-106">Like private device contexts, class device contexts minimize the time required to prepare a device context for drawing.</span></span>

<span data-ttu-id="8a382-107">如果視窗屬於具有 CS CLASSDC 樣式的視窗類別，系統就會為該視窗提供類別裝置內容 \_ 。</span><span class="sxs-lookup"><span data-stu-id="8a382-107">The system supplies a class device context for a window if it belongs to a window class having the CS\_CLASSDC style.</span></span> <span data-ttu-id="8a382-108">系統會在建立屬於類別的第一個視窗時建立裝置內容，然後針對類別中所有後續建立的視窗使用相同的裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-108">The system creates the device context when creating the first window belonging to the class and then uses the same device context for all subsequently created windows in the class.</span></span> <span data-ttu-id="8a382-109">一開始，類別裝置內容具有與一般裝置內容相同的屬性預設值，但應用程式可以隨時修改這些屬性。</span><span class="sxs-lookup"><span data-stu-id="8a382-109">Initially, the class device context has the same default values for attributes as a common device context, but the application can modify these at any time.</span></span> <span data-ttu-id="8a382-110">系統會保留所有變更（除了裁剪區域和裝置原點以外），直到類別中的最後一個視窗終結為止。</span><span class="sxs-lookup"><span data-stu-id="8a382-110">The system preserves all changes, except for the clipping region and device origin, until the last window in the class has been destroyed.</span></span> <span data-ttu-id="8a382-111">針對某個視窗所做的變更會套用至該類別中的所有視窗。</span><span class="sxs-lookup"><span data-stu-id="8a382-111">A change made for one window applies to all windows in that class.</span></span>

<span data-ttu-id="8a382-112">應用程式可以在第一個視窗建立之後，隨時使用 [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) 函式來取得類別裝置內容的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a382-112">An application can retrieve the handle to the class device context by using the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) function any time after the first window has been created.</span></span> <span data-ttu-id="8a382-113">應用程式可以保留並使用控制碼，而不需要釋放它，因為類別裝置內容不是顯示裝置內容快取的一部分。</span><span class="sxs-lookup"><span data-stu-id="8a382-113">The application can keep and use the handle without releasing it because the class device context is not part of the display device context cache.</span></span> <span data-ttu-id="8a382-114">如果應用程式在相同的視窗類別中建立另一個視窗，則應用程式必須再次取出類別裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-114">If the application creates another window in the same window class, the application must retrieve the class device context again.</span></span> <span data-ttu-id="8a382-115">抓取裝置內容會設定新視窗的正確裝置原點和裁剪區域。</span><span class="sxs-lookup"><span data-stu-id="8a382-115">Retrieving the device context sets the correct device origin and clipping region for the new window.</span></span> <span data-ttu-id="8a382-116">在應用程式抓取類別中新視窗的類別裝置內容之後，就無法再使用裝置內容在原始視窗中繪製，而不需要再次針對該視窗進行抓取。</span><span class="sxs-lookup"><span data-stu-id="8a382-116">After the application retrieves the class device context for a new window in the class, the device context can no longer be used to draw in the original window without again retrieving it for that window.</span></span> <span data-ttu-id="8a382-117">一般情況下，每次都必須在視窗中繪製時，應用程式就必須明確地取出視窗的類別裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-117">In general, each time it must draw in a window, an application must explicitly retrieve the class device context for the window.</span></span>

<span data-ttu-id="8a382-118">使用類別裝置內容的應用程式應該一律在處理 [**WM \_ 油漆**](wm-paint.md)訊息時呼叫 [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) 。</span><span class="sxs-lookup"><span data-stu-id="8a382-118">Applications that use class device contexts should always call [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) when processing a [**WM\_PAINT**](wm-paint.md) message.</span></span> <span data-ttu-id="8a382-119">此函式會設定視窗的正確裝置原點和裁剪區域，並併入更新區域。</span><span class="sxs-lookup"><span data-stu-id="8a382-119">The function sets the correct device origin and clipping region for the window, and incorporates the update region.</span></span> <span data-ttu-id="8a382-120">如果 **BeginPaint** 將它隱藏，則應用程式也應該呼叫 [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint)來還原插入號。</span><span class="sxs-lookup"><span data-stu-id="8a382-120">The application should also call [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) to restore the caret if **BeginPaint** hid it.</span></span> <span data-ttu-id="8a382-121">**EndPaint** 對類別裝置內容沒有任何其他影響。</span><span class="sxs-lookup"><span data-stu-id="8a382-121">**EndPaint** has no other effect on a class device context.</span></span>

<span data-ttu-id="8a382-122">將 [**WM \_ ERASEBKGND**](../winmsg/wm-erasebkgnd.md) 訊息傳送至應用程式時，系統會傳遞類別裝置內容，允許目前的屬性值影響應用程式或系統在處理此訊息時所執行的任何繪製。</span><span class="sxs-lookup"><span data-stu-id="8a382-122">The system passes the class device context when sending the [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) message to the application, permitting the current attribute values to affect any drawing carried out by the application or the system when processing this message.</span></span> <span data-ttu-id="8a382-123">使用具有私用裝置內容的視窗時，應用程式可以使用 [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) 來強制系統傳回具有類別裝置內容之視窗的一般裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-123">As it could with a window having a private device context, an application can use [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) to force the system to return a common device context for the window that has a class device context.</span></span>

<span data-ttu-id="8a382-124">不建議使用類別裝置內容。</span><span class="sxs-lookup"><span data-stu-id="8a382-124">Using class device contexts is not recommended.</span></span>

 

 
