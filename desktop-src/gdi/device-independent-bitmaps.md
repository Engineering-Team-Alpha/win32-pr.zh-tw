---
description: 與裝置無關的點陣圖 (DIB) 包含色彩表。
ms.assetid: 56b39a3d-48a4-4620-9652-ec41ea4d6423
title: Device-Independent 點陣圖
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1aa35201a9a27c2d16a5a18b0125d25a3938890c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114684"
---
# <a name="device-independent-bitmaps"></a><span data-ttu-id="d3e2c-103">Device-Independent 點陣圖</span><span class="sxs-lookup"><span data-stu-id="d3e2c-103">Device-Independent Bitmaps</span></span>

<span data-ttu-id="d3e2c-104">與裝置無關的點陣圖 (DIB) 包含 *色彩表*。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-104">A device-independent bitmap (DIB) contains a *color table*.</span></span> <span data-ttu-id="d3e2c-105">色彩表描述圖元值對應至 *RGB* 色彩值的方式，這些值會描述發出光線所產生的色彩。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-105">A color table describes how pixel values correspond to *RGB* color values, which describe colors that are produced by emitting light.</span></span> <span data-ttu-id="d3e2c-106">因此，DIB 可以在任何裝置上達到適當的色彩配置。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-106">Thus, a DIB can achieve the proper color scheme on any device.</span></span> <span data-ttu-id="d3e2c-107">DIB 包含下列色彩和維度資訊：</span><span class="sxs-lookup"><span data-stu-id="d3e2c-107">A DIB contains the following color and dimension information:</span></span>

-   <span data-ttu-id="d3e2c-108">建立矩形影像之裝置的色彩格式。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-108">The color format of the device on which the rectangular image was created.</span></span>
-   <span data-ttu-id="d3e2c-109">矩形映射建立所在裝置的解析度。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-109">The resolution of the device on which the rectangular image was created.</span></span>
-   <span data-ttu-id="d3e2c-110">建立映射之裝置的 [選擇區]。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-110">The palette for the device on which the image was created.</span></span>
-   <span data-ttu-id="d3e2c-111">將紅色、綠色、藍色 ( [**RGB**](/windows/desktop/api/Wingdi/nf-wingdi-rgb) ) triplet 對應至矩形影像中圖元的位陣列。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-111">An array of bits that maps red, green, blue ( [**RGB**](/windows/desktop/api/Wingdi/nf-wingdi-rgb) ) triplets to pixels in the rectangular image.</span></span>
-   <span data-ttu-id="d3e2c-112">資料壓縮識別碼，指出資料壓縮配置 (是否有任何) 用來縮減位陣列的大小。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-112">A data-compression identifier that indicates the data compression scheme (if any) used to reduce the size of the array of bits.</span></span>

<span data-ttu-id="d3e2c-113">色彩和維度資訊儲存在 [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) 結構中，其中包含 [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85)) 結構，後面接著兩個或多個 [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) 結構。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-113">The color and dimension information is stored in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure, which consists of a [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85)) structure followed by two or more [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) structures.</span></span> <span data-ttu-id="d3e2c-114">**BITMAPINFOHEADER** 結構會指定圖元矩形的維度、描述裝置的色彩技術，並識別用來縮減點陣圖大小的壓縮配置。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-114">The **BITMAPINFOHEADER** structure specifies the dimensions of the pixel rectangle, describes the device's color technology, and identifies the compression schemes used to reduce the size of the bitmap.</span></span> <span data-ttu-id="d3e2c-115">**RGBQUAD** 結構會識別出現在圖元矩形中的色彩。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-115">The **RGBQUAD** structures identify the colors that appear in the pixel rectangle.</span></span>

<span data-ttu-id="d3e2c-116">Dib 有兩種：</span><span class="sxs-lookup"><span data-stu-id="d3e2c-116">There are two varieties of DIBs:</span></span>

-   <span data-ttu-id="d3e2c-117">由上而下的 DIB，來源位於左下角。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-117">A bottom-up DIB, in which the origin lies at the lower-left corner.</span></span>
-   <span data-ttu-id="d3e2c-118">由上而下的 DIB，其原點位於左上角。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-118">A top-down DIB, in which the origin lies at the upper-left corner.</span></span>

<span data-ttu-id="d3e2c-119">如果 DIB 的高度是由點陣圖資訊標頭結構的 **高度** 成員所表示，則是由上而下的 dib;如果高度是負值，則是由上而下的 DIB。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-119">If the height of a DIB, as indicated by the **Height** member of the bitmap information header structure, is a positive value, it is a bottom-up DIB; if the height is a negative value, it is a top-down DIB.</span></span> <span data-ttu-id="d3e2c-120">無法壓縮由上而下的 Dib。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-120">Top-down DIBs cannot be compressed.</span></span>

<span data-ttu-id="d3e2c-121">色彩格式是根據色彩平面和色彩位的計數來指定。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-121">The color format is specified in terms of a count of color planes and color bits.</span></span> <span data-ttu-id="d3e2c-122">色彩平面的計數一律為 1;針對單色點陣圖，色彩位的計數是1，而針對 VGA 點陣圖則為4，而在其他色彩裝置上則為點陣圖的8、16、24或32。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-122">The count of color planes is always 1; the count of color bits is 1 for monochrome bitmaps, 4 for VGA bitmaps, and 8, 16, 24, or 32 for bitmaps on other color devices.</span></span> <span data-ttu-id="d3e2c-123">應用程式會藉由呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函式，並將 BITSPIXEL 指定為第二個引數，來抓取特定顯示器 (或印表機) 使用的色彩位數目。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-123">An application retrieves the number of color bits that a particular display (or printer) uses by calling the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying BITSPIXEL as the second argument.</span></span>

<span data-ttu-id="d3e2c-124">顯示裝置的解析度是以每個計量的圖元為單位來指定。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-124">The resolution of a display device is specified in pixels-per-meter.</span></span> <span data-ttu-id="d3e2c-125">應用程式可透過下列三個步驟的程式，取得影片顯示器或印表機的水準解析度。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-125">An application can retrieve the horizontal resolution for a video display, or printer, by following this three-step process.</span></span>

1.  <span data-ttu-id="d3e2c-126">呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函數，並將 HORZRES 指定為第二個引數。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-126">Call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying HORZRES as the second argument.</span></span>
2.  <span data-ttu-id="d3e2c-127">第二次呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) ，將 HORZSIZE 指定為第二個引數。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-127">Call [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) a second time, specifying HORZSIZE as the second argument.</span></span>
3.  <span data-ttu-id="d3e2c-128">將第一個傳回值除以第二個傳回值。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-128">Divide the first return value by the second return value.</span></span>

<span data-ttu-id="d3e2c-129">應用程式可以使用相同的三步驟程式搭配不同的參數來取得垂直解析度： VERTRES 取代 HORZRES，而 VERTSIZE 用來取代 HORZSIZE。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-129">The application can retrieve the vertical resolution by using the same three-step process with different parameters: VERTRES in place of HORZRES, and VERTSIZE in place of HORZSIZE.</span></span>

<span data-ttu-id="d3e2c-130">此調色板是以 [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) 結構的陣列來表示，以針對顯示裝置的色彩選擇區中的每個色彩指定紅色、綠色和藍色強度的元件。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-130">The palette is represented by an array of [**RGBQUAD**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) structures that specify the red, green, and blue intensity components for each color in a display device's color palette.</span></span> <span data-ttu-id="d3e2c-131">選擇區陣列中的每個色彩索引都會對應到與點陣圖相關聯之矩形區域中的特定圖元。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-131">Each color index in the palette array maps to a specific pixel in the rectangular region associated with the bitmap.</span></span> <span data-ttu-id="d3e2c-132">這個陣列的大小（以位為單位）相當於矩形的寬度（以圖元為單位），乘以矩形的高度（以圖元為單位）乘以裝置的色彩位元數目。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-132">The size of this array, in bits, is equivalent to the width of the rectangle, in pixels, multiplied by the height of the rectangle, in pixels, multiplied by the count of color bits for the device.</span></span> <span data-ttu-id="d3e2c-133">應用程式可以藉由呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函式，並將 NUMCOLORS 指定為第二個引數，來取得裝置的調色板大小。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-133">An application can retrieve the size of the device's palette by calling the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying NUMCOLORS as the second argument.</span></span>

<span data-ttu-id="d3e2c-134">Windows 支援壓縮適用于 8 bpp 和 4 bpp 底部 Dib 的調色板陣列。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-134">Windows supports the compression of the palette array for 8-bpp and 4-bpp bottom-up DIBs.</span></span> <span data-ttu-id="d3e2c-135">您可以使用執行長度編碼 (RLE) 配置來壓縮這些陣列。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-135">These arrays can be compressed by using the run-length encoding (RLE) scheme.</span></span> <span data-ttu-id="d3e2c-136">RLE 配置使用2個位元組的值，第一個位元組指定使用色彩索引的連續圖元數，以及指定索引的第二個位元組。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-136">The RLE scheme uses 2-byte values, the first byte specifying the number of consecutive pixels that use a color index and the second byte specifying the index.</span></span> <span data-ttu-id="d3e2c-137">如需點陣圖壓縮的詳細資訊，請參閱 [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85))、 [**BITMAPFILEHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapfileheader)、 [**BITMAPV4HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv4header)和 [**BITMAPV5HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv5header) 結構的描述。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-137">For more information about bitmap compression, see the description of the [**BITMAPINFOHEADER**](/previous-versions//dd183376(v=vs.85)), [**BITMAPFILEHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapfileheader), [**BITMAPV4HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv4header), and [**BITMAPV5HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv5header) structures.</span></span>

<span data-ttu-id="d3e2c-138">應用程式可以藉由初始化所需的結構和呼叫 [**GetDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-getdibits) 函式，從 DDB 建立 DIB。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-138">An application can create a DIB from a DDB by initializing the required structures and calling the [**GetDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-getdibits) function.</span></span> <span data-ttu-id="d3e2c-139">若要判斷裝置是否支援此函式，請呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函式， \_ \_ 並將 RC DI 點陣圖指定為 RASTERCAPS 旗標。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-139">To determine whether a device supports this function, call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying RC\_DI\_BITMAP as the RASTERCAPS flag.</span></span>

<span data-ttu-id="d3e2c-140">需要複製點陣圖的應用程式可以使用 [**TransparentBlt**](/windows/desktop/api/WinGdi/nf-wingdi-transparentblt) 將來源點陣圖中的所有圖元複製到目的地點陣圖，但是符合透明色彩的圖元除外。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-140">An application that needs to copy a bitmap can use [**TransparentBlt**](/windows/desktop/api/WinGdi/nf-wingdi-transparentblt) to copy all pixels in a source bitmap to a destination bitmap except those pixels that match the transparent color.</span></span>

<span data-ttu-id="d3e2c-141">應用程式可以藉由呼叫 [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) 或 [**StretchDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits) 函式，使用 DIB 來設定顯示裝置上的圖元。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-141">An application can use a DIB to set pixels on the display device by calling the [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) or the [**StretchDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits) function.</span></span> <span data-ttu-id="d3e2c-142">若要判斷裝置是否支援 **SetDIBitsToDevice** 函式，請呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) 函式， \_ 並將 RC DIBTODEV 指定為 RASTERCAPS 旗標。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-142">To determine whether a device supports the **SetDIBitsToDevice** function, call the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function, specifying RC\_DIBTODEV as the RASTERCAPS flag.</span></span> <span data-ttu-id="d3e2c-143">將 RC \_ STRETCHDIB 指定為 RASTERCAPS 旗標，以判斷裝置是否支援 **StretchDIBits**。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-143">Specify RC\_STRETCHDIB as the RASTERCAPS flag to determine if the device supports **StretchDIBits**.</span></span>

<span data-ttu-id="d3e2c-144">只需要顯示預先存在的 DIB 的應用程式可以使用 [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) 函數。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-144">An application that simply needs to display a pre-existing DIB can use the [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) function.</span></span> <span data-ttu-id="d3e2c-145">例如，試算表應用程式可以開啟現有的圖表，並使用 **SetDIBitsToDevice** 函式將它們顯示在視窗中。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-145">For example, a spreadsheet application can open existing charts and display them in a window by using the **SetDIBitsToDevice** function.</span></span> <span data-ttu-id="d3e2c-146">不過，若要在視窗中重複重繪點陣圖，應用程式應該使用 [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) 函數。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-146">To repeatedly redraw a bitmap in a window, however, the application should use the [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) function.</span></span> <span data-ttu-id="d3e2c-147">例如，結合動畫圖形與音效的多媒體應用程式，因為其執行速度比 **SetDIBitsToDevice** 更快，所以會受益于呼叫 **BitBlt** 函數。</span><span class="sxs-lookup"><span data-stu-id="d3e2c-147">For example, a multimedia application that combines animated graphics with sound would benefit from calling the **BitBlt** function because it executes faster than **SetDIBitsToDevice**.</span></span>

 

 
