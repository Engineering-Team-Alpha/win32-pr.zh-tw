---
description: 在一個以上的監視器上的視窗或功能表會導致檢視器出現視覺中斷。 為了將這個問題降至最低，系統會在一個監視器上顯示功能表和新的和最大化的視窗。 下表說明如何選擇監視器。
ms.assetid: 9316c8dd-c9b7-49e2-a987-5949a87b0cfc
title: 將物件放置在多個顯示監視器上
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 77149291737482fa0f3e7fe19ee4f350ee6521d8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104972568"
---
# <a name="positioning-objects-on-multiple-display-monitors"></a><span data-ttu-id="e5148-105">將物件放置在多個顯示監視器上</span><span class="sxs-lookup"><span data-stu-id="e5148-105">Positioning Objects on Multiple Display Monitors</span></span>

<span data-ttu-id="e5148-106">在一個以上的監視器上的視窗或功能表會導致檢視器出現視覺中斷。</span><span class="sxs-lookup"><span data-stu-id="e5148-106">A window or menu that is on more than one monitor causes visual disruption for a viewer.</span></span> <span data-ttu-id="e5148-107">為了將這個問題降至最低，系統會在一個監視器上顯示功能表和新的和最大化的視窗。</span><span class="sxs-lookup"><span data-stu-id="e5148-107">To minimize this problem, the system displays menus and new and maximized windows on one monitor.</span></span> <span data-ttu-id="e5148-108">下表說明如何選擇監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-108">The following table shows how the monitor is chosen.</span></span>



| <span data-ttu-id="e5148-109">Object</span><span class="sxs-lookup"><span data-stu-id="e5148-109">Object</span></span>         | <span data-ttu-id="e5148-110">Location</span><span class="sxs-lookup"><span data-stu-id="e5148-110">Location</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e5148-111">時間範圍</span><span class="sxs-lookup"><span data-stu-id="e5148-111">window</span></span>         | <span data-ttu-id="e5148-112">[ [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) (例如) 在監視器上顯示一個視窗，其中包含視窗的最大部分。最大化包含視窗最大部分的監視器，直到最小化為止。</span><span class="sxs-lookup"><span data-stu-id="e5148-112">[**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa)(Ex) displays a window on the monitor that contains the largest part of the window.Maximizes on the monitor that contains the largest part of the window before it was minimized.</span></span><br/> <span data-ttu-id="e5148-113">ALT 鍵的按鍵組合會在具有目前使用中視窗的監視器上顯示一個視窗。</span><span class="sxs-lookup"><span data-stu-id="e5148-113">The ALT-TAB key combination displays a window on the monitor that has the currently active window.</span></span><br/>                                                                                                                                          |
| <span data-ttu-id="e5148-114">擁有的視窗</span><span class="sxs-lookup"><span data-stu-id="e5148-114">owned window</span></span>   | <span data-ttu-id="e5148-115">在與擁有者相同的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-115">on the same monitor as its owner.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="e5148-116">子</span><span class="sxs-lookup"><span data-stu-id="e5148-116">submenu</span></span>        | <span data-ttu-id="e5148-117">出現在包含對應功能表項目最大部分的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-117">Appears on the monitor that contains the largest part of the corresponding menu item.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="e5148-118">內容功能表</span><span class="sxs-lookup"><span data-stu-id="e5148-118">context menu</span></span>   | <span data-ttu-id="e5148-119">出現在按一下滑鼠右鍵的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-119">Appears on the monitor where the right click occurred.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="e5148-120">下拉式清單</span><span class="sxs-lookup"><span data-stu-id="e5148-120">drop-down list</span></span> | <span data-ttu-id="e5148-121">出現在包含下拉式方塊矩形的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-121">Appears on the monitor that contains the rectangle of the combo box.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="e5148-122">對話方塊</span><span class="sxs-lookup"><span data-stu-id="e5148-122">dialog box</span></span>     | <span data-ttu-id="e5148-123">會顯示在擁有它之視窗的監視器上。如果定義了 DS \_ CENTERMOUSE 樣式，它就會顯示在具有滑鼠的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-123">Appears on the monitor of the window that owns it.If it is defined with DS\_CENTERMOUSE style, it appears on the monitor with the mouse.</span></span><br/> <span data-ttu-id="e5148-124">如果沒有擁有者，且使用中視窗和對話方塊都在相同的應用程式中，對話方塊會出現在目前使用中視窗的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-124">If it has no owner and the active window and the dialog box are in the same application, the dialog box appears on the monitor of the currently active window.</span></span><br/> <span data-ttu-id="e5148-125">如果對話方塊沒有擁有者，且使用中視窗與對話方塊不在相同的應用程式中，則會在主要監視器上顯示此對話方塊。</span><span class="sxs-lookup"><span data-stu-id="e5148-125">If the dialog box has no owner and the active window is not in the same application as the dialog box, the dialog box appears on the primary monitor.</span></span><br/> |
| <span data-ttu-id="e5148-126">訊息方塊</span><span class="sxs-lookup"><span data-stu-id="e5148-126">message box</span></span>    | <span data-ttu-id="e5148-127">會顯示在擁有它之視窗的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-127">Appears on the monitor of the window that owns it.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="e5148-128">如果視窗跨越兩個監視器，而其中一個監視器已重新置放，系統會將視窗放置於包含原始視窗最大部分的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-128">If a window straddles two monitors and one of the monitors is repositioned, the system positions the window on the monitor that contains the largest part of the original window.</span></span>

<span data-ttu-id="e5148-129">應用程式通常也需要放置物件。</span><span class="sxs-lookup"><span data-stu-id="e5148-129">An application will also typically need to position objects.</span></span> <span data-ttu-id="e5148-130">例如，可能需要在與另一個視窗相同的監視器上建立一個視窗。</span><span class="sxs-lookup"><span data-stu-id="e5148-130">For example, a window may need to be created on the same monitor as another window.</span></span>

<span data-ttu-id="e5148-131">**將物件放置在多個監視系統上**</span><span class="sxs-lookup"><span data-stu-id="e5148-131">**To position an object on a multiple monitor system**</span></span>

1.  <span data-ttu-id="e5148-132">判斷適當的監視。</span><span class="sxs-lookup"><span data-stu-id="e5148-132">Determine the appropriate monitor.</span></span>
2.  <span data-ttu-id="e5148-133">取得監視器的座標。</span><span class="sxs-lookup"><span data-stu-id="e5148-133">Get the coordinates to the monitor.</span></span>
3.  <span data-ttu-id="e5148-134">使用座標來放置物件。</span><span class="sxs-lookup"><span data-stu-id="e5148-134">Position the object using the coordinates.</span></span>

<span data-ttu-id="e5148-135">一般而言，您會將物件放在主要監視器上，或是在其上已有物件的監視器上。</span><span class="sxs-lookup"><span data-stu-id="e5148-135">Typically, you will position an object either on the primary monitor or on a monitor that has an object already on it.</span></span> <span data-ttu-id="e5148-136">若要識別指定點、矩形或視窗的監視器，請使用 [**MonitorFromPoint**](/windows/desktop/api/Winuser/nf-winuser-monitorfrompoint)、 [**MonitorFromRect**](/windows/desktop/api/Winuser/nf-winuser-monitorfromrect)和 [**MonitorFromWindow**](/windows/desktop/api/Winuser/nf-winuser-monitorfromwindow)。</span><span class="sxs-lookup"><span data-stu-id="e5148-136">To identify the monitor for a given point, rectangle, or window, use [**MonitorFromPoint**](/windows/desktop/api/Winuser/nf-winuser-monitorfrompoint), [**MonitorFromRect**](/windows/desktop/api/Winuser/nf-winuser-monitorfromrect), and [**MonitorFromWindow**](/windows/desktop/api/Winuser/nf-winuser-monitorfromwindow).</span></span>

<span data-ttu-id="e5148-137">若要取得監視器的座標，請使用 [**GetMonitorInfo**](/windows/desktop/api/Winuser/nf-winuser-getmonitorinfoa)，以提供工作區域和整個監視器矩形。</span><span class="sxs-lookup"><span data-stu-id="e5148-137">To get the coordinates for the monitor, use [**GetMonitorInfo**](/windows/desktop/api/Winuser/nf-winuser-getmonitorinfoa), which provides both the work area and the entire monitor rectangle.</span></span> <span data-ttu-id="e5148-138">請注意，SM \_ CXSCREEN 和 sm \_ CYSCREEN 一律會參考主要監視器，而不一定是顯示您應用程式的監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-138">Note that SM\_CXSCREEN and SM\_CYSCREEN always refer to the primary monitor, not necessarily the monitor that displays your application.</span></span> <span data-ttu-id="e5148-139">此外，請避免 \_ 使用 SM xxVIRTUALSCREEN，因為這會將您的視窗置於虛擬螢幕上，而不是監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-139">Also, avoid SM\_xxVIRTUALSCREEN because this centers your window on the virtual screen, not a monitor.</span></span>

<span data-ttu-id="e5148-140">若要在視窗的工作區中將對話方塊置中，請使用 DS \_ 中心樣式。</span><span class="sxs-lookup"><span data-stu-id="e5148-140">To center dialog boxes in a window's work area, use the DS\_CENTER style.</span></span> <span data-ttu-id="e5148-141">若要將對話方塊置中至應用程式視窗，請使用 [**GetWindowRect**](/windows/win32/api/winuser/nf-winuser-getwindowrect)。</span><span class="sxs-lookup"><span data-stu-id="e5148-141">To center the dialog box to an application window, use [**GetWindowRect**](/windows/win32/api/winuser/nf-winuser-getwindowrect).</span></span> <span data-ttu-id="e5148-142">Windows 會自動將功能表和對話方塊限制為監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-142">Windows automatically restricts menus and dialog boxes to a monitor.</span></span> <span data-ttu-id="e5148-143">不過，自訂功能表、自訂下拉式方塊、自訂工具調板和儲存的應用程式位置可能會有問題。</span><span class="sxs-lookup"><span data-stu-id="e5148-143">However, there can be a problem for custom menus, custom drop-down boxes, custom tool palettes, and the saved application position.</span></span>

<span data-ttu-id="e5148-144">如需如何正確放置物件的範例，請參閱 [在多個顯示器設定上放置物件](positioning-objects-on-a-multiple-display-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="e5148-144">For an example of how to position objects correctly, see [Positioning Objects on a Multiple Display Setup](positioning-objects-on-a-multiple-display-setup.md).</span></span>

<span data-ttu-id="e5148-145">使用 SM \_ CXSCREEN 和 sm \_ CYSCREEN 判斷應用程式桌面工具列的位置 (也稱為 *appbar*) 將 appbar 限制為主要監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-145">Using SM\_CXSCREEN and SM\_CYSCREEN to determine the location of an application desktop toolbar (also called *appbar*) restricts the appbar to the primary monitor.</span></span> <span data-ttu-id="e5148-146">若要允許 appbar 在任何監視的任何邊緣，請使用適當的系統計量來計算監視器的邊緣。</span><span class="sxs-lookup"><span data-stu-id="e5148-146">To allow an appbar to be on any edge of any monitor, use the appropriate system metrics to calculate the edges of the monitors.</span></span> <span data-ttu-id="e5148-147">此外，使用 **get \_ X \_ LPARAM** 並 **取得 \_ Y \_ LPARAM** 宏來將座標解壓縮，否則座標的正負號可能會錯誤。</span><span class="sxs-lookup"><span data-stu-id="e5148-147">Also, use the **GET\_X\_LPARAM** and **GET\_Y\_LPARAM** macros to extract the coordinates, otherwise the sign of the coordinates may be wrong.</span></span> <span data-ttu-id="e5148-148">這些宏包含在 Windowsx 中。</span><span class="sxs-lookup"><span data-stu-id="e5148-148">These macros are included in Windowsx.h.</span></span>

<span data-ttu-id="e5148-149">全螢幕視窗的大小需要在不同解析度的監視器之間移動時變更。</span><span class="sxs-lookup"><span data-stu-id="e5148-149">The size of a full-screen window needs to change as it moves among monitors with different resolutions.</span></span> <span data-ttu-id="e5148-150">若要這樣做，應用程式必須使用 [**MonitorFromWindow**](/windows/desktop/api/Winuser/nf-winuser-monitorfromwindow) 或 [**MonitorFromPoint**](/windows/desktop/api/Winuser/nf-winuser-monitorfrompoint) 檢查它所在的視窗，然後使用 [**GetMonitorInfo**](/windows/desktop/api/Winuser/nf-winuser-getmonitorinfoa) 來取得監視器的大小。</span><span class="sxs-lookup"><span data-stu-id="e5148-150">To do this, the application must check what window it is on, using [**MonitorFromWindow**](/windows/desktop/api/Winuser/nf-winuser-monitorfromwindow) or [**MonitorFromPoint**](/windows/desktop/api/Winuser/nf-winuser-monitorfrompoint) , and then use [**GetMonitorInfo**](/windows/desktop/api/Winuser/nf-winuser-getmonitorinfoa) to get the size of the monitor.</span></span> <span data-ttu-id="e5148-151">或者，您可以從 DirectX **DirectDrawEnumerateEx** 功能使用 **HMONITOR** 。</span><span class="sxs-lookup"><span data-stu-id="e5148-151">As an alternative, you could use the **HMONITOR** from the DirectX **DirectDrawEnumerateEx** function.</span></span> <span data-ttu-id="e5148-152">然後使用 [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos) 來定位並調整視窗的大小，以涵蓋監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-152">Then use [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos) to position and size the window to cover the monitor.</span></span>

<span data-ttu-id="e5148-153">最大化的視窗不會涵蓋具有 [永遠開啟] 屬性的工作列。</span><span class="sxs-lookup"><span data-stu-id="e5148-153">A maximized window does not cover a taskbar that has the "Always on top" property.</span></span> <span data-ttu-id="e5148-154">不過，全螢幕視窗涵蓋工作列，例如，在 Microsoft PowerPoint 投影片放映和遊戲中。</span><span class="sxs-lookup"><span data-stu-id="e5148-154">However, a full-screen window covers the taskbar--for example, in Microsoft PowerPoint slide shows and games.</span></span>

<span data-ttu-id="e5148-155">若要在應用程式結束時儲存（以及稍後還原）視窗的位置，請使用 [**GetWindowPlacement**](/windows/win32/api/winuser/nf-winuser-getwindowplacement) 和 [**SetWindowPlacement**](/windows/win32/api/winuser/nf-winuser-setwindowplacement) 函數。</span><span class="sxs-lookup"><span data-stu-id="e5148-155">To save, and later restore, the position of a window when an application exits, use the [**GetWindowPlacement**](/windows/win32/api/winuser/nf-winuser-getwindowplacement) and [**SetWindowPlacement**](/windows/win32/api/winuser/nf-winuser-setwindowplacement) functions.</span></span> <span data-ttu-id="e5148-156">不過，請先檢查位置是否仍然有效，再使用它，因為可能已從系統中移動或移除此監視器。</span><span class="sxs-lookup"><span data-stu-id="e5148-156">However, check that the position is still valid before using it because the monitor could have been moved or removed from the system.</span></span> <span data-ttu-id="e5148-157">如果視窗的 **HMONITOR** 無效，應用程式會在主要監視器上顯示視窗。</span><span class="sxs-lookup"><span data-stu-id="e5148-157">The application displays the window on the primary monitor if the **HMONITOR** of a window is invalid.</span></span>

<span data-ttu-id="e5148-158">系統會嘗試在包含其快捷方式的監視器上啟動應用程式。</span><span class="sxs-lookup"><span data-stu-id="e5148-158">The system tries to start an application on the monitor that contains its shortcut.</span></span> <span data-ttu-id="e5148-159">因此，將應用程式定位的其中一種方式是在所需的監視器上具有其快捷方式。</span><span class="sxs-lookup"><span data-stu-id="e5148-159">So, one way to position an application is to have its shortcut on a desired monitor.</span></span>

<span data-ttu-id="e5148-160">如果您使用 [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) 或 [**ShellExecuteEx**](/windows/win32/api/shellapi/nf-shellapi-shellexecuteexa) ，請提供 *hWnd* ，讓系統在與呼叫應用程式相同的監視器上開啟任何新視窗。</span><span class="sxs-lookup"><span data-stu-id="e5148-160">If you use [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) or [**ShellExecuteEx**](/windows/win32/api/shellapi/nf-shellapi-shellexecuteexa) , supply an *hWnd* so the system will open any new windows on the same monitor as the calling application.</span></span>

<span data-ttu-id="e5148-161">請注意，具有多個監視器的系統會稍微改變 [**MINMAXINFO**](/windows/win32/api/winuser/ns-winuser-minmaxinfo) 結構的值。</span><span class="sxs-lookup"><span data-stu-id="e5148-161">Note that the values for the [**MINMAXINFO**](/windows/win32/api/winuser/ns-winuser-minmaxinfo) structure are slightly altered for a system with multiple monitors.</span></span>

 

 
