---
description: 若要讓應用程式將輸出放在記憶體中，而不是將輸出傳送至實際裝置，請使用特殊的裝置內容進行點陣圖作業，稱為記憶體裝置內容。
ms.assetid: 0a682dc4-31a4-43c8-b0b1-ab01986b1dac
title: 記憶體裝置內容
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 095de04fdf965a87011895015ad7ea6c9782e286
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103691868"
---
# <a name="memory-device-contexts"></a><span data-ttu-id="b7d48-103">記憶體裝置內容</span><span class="sxs-lookup"><span data-stu-id="b7d48-103">Memory Device Contexts</span></span>

<span data-ttu-id="b7d48-104">若要讓應用程式將輸出放在記憶體中，而不是將輸出傳送至實際裝置，請使用特殊的裝置內容進行點陣圖作業，稱為 *記憶體裝置內容*。</span><span class="sxs-lookup"><span data-stu-id="b7d48-104">To enable applications to place output in memory rather than sending it to an actual device, use a special device context for bitmap operations called a *memory device context*.</span></span> <span data-ttu-id="b7d48-105">記憶體 DC 可讓系統將部分的記憶體視為虛擬裝置。</span><span class="sxs-lookup"><span data-stu-id="b7d48-105">A memory DC enables the system to treat a portion of memory as a virtual device.</span></span> <span data-ttu-id="b7d48-106">它是記憶體中的位陣列，應用程式可以暫時使用它來儲存在一般繪圖介面上建立之點陣圖的色彩資料。</span><span class="sxs-lookup"><span data-stu-id="b7d48-106">It is an array of bits in memory that an application can use temporarily to store the color data for bitmaps created on a normal drawing surface.</span></span> <span data-ttu-id="b7d48-107">由於點陣圖與裝置相容，因此記憶體 DC 有時也稱為 *相容的裝置內容*。</span><span class="sxs-lookup"><span data-stu-id="b7d48-107">Because the bitmap is compatible with the device, a memory DC is also sometimes referred to as a *compatible device context*.</span></span>

<span data-ttu-id="b7d48-108">記憶體 DC 會儲存特定裝置的點陣圖影像。</span><span class="sxs-lookup"><span data-stu-id="b7d48-108">The memory DC stores bitmap images for a particular device.</span></span> <span data-ttu-id="b7d48-109">應用程式可以藉由呼叫 [**CreateCompatibleDC**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatibledc) 函數來建立記憶體 DC。</span><span class="sxs-lookup"><span data-stu-id="b7d48-109">An application can create a memory DC by calling the [**CreateCompatibleDC**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatibledc) function.</span></span>

<span data-ttu-id="b7d48-110">記憶體 DC 中的原始點陣圖只是預留位置。</span><span class="sxs-lookup"><span data-stu-id="b7d48-110">The original bitmap in a memory DC is simply a placeholder.</span></span> <span data-ttu-id="b7d48-111">其維度是一個圖元到一個圖元。</span><span class="sxs-lookup"><span data-stu-id="b7d48-111">Its dimensions are one pixel by one pixel.</span></span> <span data-ttu-id="b7d48-112">在應用程式開始繪圖之前，必須藉由呼叫 [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) 函式，在 DC 中選取具有適當寬度和高度的點陣圖。</span><span class="sxs-lookup"><span data-stu-id="b7d48-112">Before an application can begin drawing, it must select a bitmap with the appropriate width and height into the DC by calling the [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject) function.</span></span> <span data-ttu-id="b7d48-113">若要建立適當維度的點陣圖，請使用 [**CreateBitmap**](/windows/desktop/api/Wingdi/nf-wingdi-createbitmap)、 [**CreateBitmapIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createbitmapindirect)或 [**CreateCompatibleBitmap**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatiblebitmap) 函數。</span><span class="sxs-lookup"><span data-stu-id="b7d48-113">To create a bitmap of the appropriate dimensions, use the [**CreateBitmap**](/windows/desktop/api/Wingdi/nf-wingdi-createbitmap), [**CreateBitmapIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createbitmapindirect), or [**CreateCompatibleBitmap**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatiblebitmap) function.</span></span> <span data-ttu-id="b7d48-114">將點陣圖選取到記憶體 DC 之後，系統會以夠大的陣列來取代單一位陣列，以儲存指定之圖元矩形的色彩資訊。</span><span class="sxs-lookup"><span data-stu-id="b7d48-114">After the bitmap is selected into the memory DC, the system replaces the single-bit array with an array large enough to store color information for the specified rectangle of pixels.</span></span>

<span data-ttu-id="b7d48-115">當應用程式將 [**CreateCompatibleDC**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatibledc) 傳回的控制碼傳遞給其中一個繪圖函式時，要求的輸出不會出現在裝置的繪圖介面上。</span><span class="sxs-lookup"><span data-stu-id="b7d48-115">When an application passes the handle returned by [**CreateCompatibleDC**](/windows/desktop/api/Wingdi/nf-wingdi-createcompatibledc) to one of the drawing functions, the requested output does not appear on a device's drawing surface.</span></span> <span data-ttu-id="b7d48-116">相反地，系統會將結果行、曲線、文字或區域的色彩資訊儲存在位的陣列中。</span><span class="sxs-lookup"><span data-stu-id="b7d48-116">Instead, the system stores the color information for the resultant line, curve, text, or region in the array of bits.</span></span> <span data-ttu-id="b7d48-117">應用程式可以藉由呼叫 [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) 函式，將記憶體 DC 識別為來源裝置內容，並將視窗或螢幕 DC 作為目標裝置內容，將儲存在記憶體中的影像複製回繪圖介面上。</span><span class="sxs-lookup"><span data-stu-id="b7d48-117">The application can copy the image stored in memory back onto a drawing surface by calling the [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) function, identifying the memory DC as the source device context and a window or screen DC as the target device context.</span></span>

<span data-ttu-id="b7d48-118">顯示從調色板裝置上的 DIB 建立的 DIB 或 DDB 時，您可以藉由排列邏輯調色板以符合系統元件的配置，來改善繪製影像的速度。</span><span class="sxs-lookup"><span data-stu-id="b7d48-118">When displaying a DIB or a DDB created from a DIB on a palette device, you can improve the speed at which the image is drawn by arranging the logical palette to match the layout of the system palette.</span></span> <span data-ttu-id="b7d48-119">若要這樣做，請使用 NUMRESERVED 值呼叫 [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) ，以取得系統中的保留色彩數目。</span><span class="sxs-lookup"><span data-stu-id="b7d48-119">To do this, call [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) with the NUMRESERVED value to get the number of reserved colors in the system.</span></span> <span data-ttu-id="b7d48-120">然後呼叫 [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) ，並在邏輯調色板的第一個和最後一個 NUMRESERVED/2 專案中填入對應的系統色彩。</span><span class="sxs-lookup"><span data-stu-id="b7d48-120">Then call [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) and fill in the first and last NUMRESERVED/2 entries of the logical palette with the corresponding system colors.</span></span> <span data-ttu-id="b7d48-121">例如，如果 NUMRESERVED 是20，您就會在邏輯調色板的第一個和最後10個專案中填入系統色彩。</span><span class="sxs-lookup"><span data-stu-id="b7d48-121">For example, if NUMRESERVED is 20, you would fill in the first and last 10 entries of the logical palette with the system colors.</span></span> <span data-ttu-id="b7d48-122">然後，在我們的範例中，填妥 (邏輯調色板的其餘 256-NUMRESERVED 色彩，其餘236色彩) 具有來自 DIB 的色彩，並設定 \_ 每個色彩的電腦 NOCOLLAPSE 旗標。</span><span class="sxs-lookup"><span data-stu-id="b7d48-122">Then fill in the remaining 256-NUMRESERVED colors of the logical palette (in our example, the remaining 236 colors) with colors from the DIB and set the PC\_NOCOLLAPSE flag on each of these colors.</span></span>

<span data-ttu-id="b7d48-123">如需色彩和調色板的詳細資訊，請參閱 [色彩](colors.md)。</span><span class="sxs-lookup"><span data-stu-id="b7d48-123">For more information about color and palettes, see [Colors](colors.md).</span></span> <span data-ttu-id="b7d48-124">如需點陣圖和點陣圖作業的詳細資訊，請參閱 [點陣圖](bitmaps.md)。</span><span class="sxs-lookup"><span data-stu-id="b7d48-124">For more information about bitmaps and bitmap operations, see [Bitmaps](bitmaps.md).</span></span>

 

 



