---
description: Windows GDI + 的 c + + 介面包含大約40個類別、50列舉和6個結構。 另外還有一些函數不是任何類別的成員。
ms.assetid: 46051bfa-b842-4e4e-bda8-e9003b5b5da4
title: 以類別為基礎的介面結構
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2627d695330c316a57c2593e75233d73b27a1524
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991094"
---
# <a name="the-structure-of-the-class-based-interface"></a><span data-ttu-id="0e7f2-104">以類別為基礎的介面結構</span><span class="sxs-lookup"><span data-stu-id="0e7f2-104">The Structure of the Class-Based Interface</span></span>

<span data-ttu-id="0e7f2-105">Windows GDI + 的 c + + 介面包含大約40個類別、50列舉和6個結構。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-105">The C++ interface to Windows GDI+ contains about 40 classes, 50 enumerations, and 6 structures.</span></span> <span data-ttu-id="0e7f2-106">另外還有一些函數不是任何類別的成員。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-106">There are also a few functions that are not members of any class.</span></span>

<span data-ttu-id="0e7f2-107">在呼叫任何 GDI + 函式之前，您必須先指出命名空間 Gdiplus.dll 正在使用中。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-107">You must indicate that the namespace Gdiplus is being used before any GDI+ functions are called.</span></span> <span data-ttu-id="0e7f2-108">下列語句表示應用程式中正在使用 Gdiplus.dll 命名空間。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-108">The following statement indicates that the Gdiplus namespace is being used in the application.</span></span>

`using namespace Gdiplus;`

<span data-ttu-id="0e7f2-109">[**Graphics**](/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics)類別是 gdi + 介面的核心;它是實際繪製線條、曲線、圖形、影像和文字的類別。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-109">The [**Graphics**](/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics) class is the core of the GDI+ interface; it is the class that actually draws lines, curves, figures, images, and text.</span></span>

<span data-ttu-id="0e7f2-110">許多類別都與 [**Graphics**](/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics) 類別一起運作。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-110">Many classes work together with the [**Graphics**](/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics) class.</span></span> <span data-ttu-id="0e7f2-111">例如， [Graphics：:D rawline](/windows/win32/api/gdiplusgraphics/nf-gdiplusgraphics-graphics-drawline(inconstpen_inint_inint_inint_inint)) 方法會接收 [**Pen**](/windows/win32/api/gdipluspen/nl-gdipluspen-pen) 物件的指標，以保存屬性 (色彩、寬度、虛線樣式，以及要繪製之線條的類似) 。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-111">For example, the [Graphics::DrawLine](/windows/win32/api/gdiplusgraphics/nf-gdiplusgraphics-graphics-drawline(inconstpen_inint_inint_inint_inint)) method receives a pointer to a [**Pen**](/windows/win32/api/gdipluspen/nl-gdipluspen-pen) object, which holds attributes (color, width, dash style, and the like) of the line to be drawn.</span></span> <span data-ttu-id="0e7f2-112">[Graphics：： graphicswindow.fillrectangle](/windows/win32/api/gdiplusgraphics/nf-gdiplusgraphics-graphics-fillrectangle(inconstbrush_inconstrectf_))方法可以接收 [**LinearGradientBrush**](/windows/win32/api/gdiplusbrush/nl-gdiplusbrush-lineargradientbrush)物件的指標，此物件可與 **圖形** 物件搭配使用，以逐漸變更的色彩填滿矩形。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-112">The [Graphics::FillRectangle](/windows/win32/api/gdiplusgraphics/nf-gdiplusgraphics-graphics-fillrectangle(inconstbrush_inconstrectf_)) method can receive a pointer to a [**LinearGradientBrush**](/windows/win32/api/gdiplusbrush/nl-gdiplusbrush-lineargradientbrush) object, which works with the **Graphics** object to fill a rectangle with a gradually changing color.</span></span> <span data-ttu-id="0e7f2-113">[**字型**](/windows/win32/api/gdiplusheaders/nl-gdiplusheaders-font) 和 [**StringFormat**](/windows/win32/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件會影響 **圖形** 物件繪製文字的方式。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-113">[**Font**](/windows/win32/api/gdiplusheaders/nl-gdiplusheaders-font) and [**StringFormat**](/windows/win32/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) objects influence the way a **Graphics** object draws text.</span></span> <span data-ttu-id="0e7f2-114">[**矩陣**](/windows/win32/api/gdiplusmatrix/nl-gdiplusmatrix-matrix)物件會儲存並操作 **圖形** 物件的全球轉換，以用來旋轉、縮放和翻轉影像。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-114">A [**Matrix**](/windows/win32/api/gdiplusmatrix/nl-gdiplusmatrix-matrix) object stores and manipulates the world transformation of a **Graphics** object, which is used to rotate, scale, and flip images.</span></span>

<span data-ttu-id="0e7f2-115">某些類別主要是做為結構化資料類型。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-115">Certain classes serve primarily as structured data types.</span></span> <span data-ttu-id="0e7f2-116">其中有些類別 (例如， [**矩形**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-rect)、 [**點**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-point)和 [**大小**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-size)) 適用于一般用途。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-116">Some of those classes (for example, [**Rect**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-rect), [**Point**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-point), and [**Size**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-size)) are for general purposes.</span></span> <span data-ttu-id="0e7f2-117">其他則適用于專用用途，並被視為 helper 類別。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-117">Others are for specialized purposes and are considered helper classes.</span></span> <span data-ttu-id="0e7f2-118">例如， [**BitmapData**](/windows/win32/api/gdiplusimaging/nl-gdiplusimaging-bitmapdata) 類別是 [**Bitmap**](/windows/win32/api/gdiplusheaders/nl-gdiplusheaders-bitmap) 類別的協助程式，而 [**PathData**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-pathdata) 類別是 [**GraphicsPath**](/windows/win32/api/gdipluspath/nl-gdipluspath-graphicspath) 類別的 helper。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-118">For example, the [**BitmapData**](/windows/win32/api/gdiplusimaging/nl-gdiplusimaging-bitmapdata) class is a helper for the [**Bitmap**](/windows/win32/api/gdiplusheaders/nl-gdiplusheaders-bitmap) class, and the [**PathData**](/windows/win32/api/gdiplustypes/nl-gdiplustypes-pathdata) class is a helper for the [**GraphicsPath**](/windows/win32/api/gdipluspath/nl-gdipluspath-graphicspath) class.</span></span> <span data-ttu-id="0e7f2-119">GDI + 也會定義一些用於組織資料的結構。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-119">GDI+ also defines a few structures that are used for organizing data.</span></span> <span data-ttu-id="0e7f2-120">例如， [**ColorMap**](/windows/win32/api/Gdipluscolormatrix/ns-gdipluscolormatrix-colormap) 結構會保存一組在色彩轉換表中形成一個專案的 [**色彩**](/windows/win32/api/gdipluscolor/nl-gdipluscolor-color) 物件。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-120">For example, the [**ColorMap**](/windows/win32/api/Gdipluscolormatrix/ns-gdipluscolormatrix-colormap) structure holds a pair of [**Color**](/windows/win32/api/gdipluscolor/nl-gdipluscolor-color) objects that form one entry in a color conversion table.</span></span>

<span data-ttu-id="0e7f2-121">GDI + 定義數個列舉，也就是相關常數的集合。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-121">GDI+ defines several enumerations, which are collections of related constants.</span></span> <span data-ttu-id="0e7f2-122">例如， [**LineJoin**](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin) 列舉包含元素 [\* \* \* \* LineJoinBevel \* \*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin)\* *、* \* \* \* [LineJoinMiter \* \*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin)\* \* 和 \* \* \* \* [LineJoinRound \*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin)\* \* \*，這會指定可用來聯結兩行的樣式。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-122">For example, the [**LineJoin**](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin) enumeration contains the elements [\*\*\*\*LineJoinBevel\*\*\*\*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin), [\*\*\*\*LineJoinMiter\*\*\*\*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin), and [\*\*\*\*LineJoinRound\*\*\*\*](/windows/win32/api/Gdiplusenums/ne-gdiplusenums-linejoin), which specify styles that can be used to join two lines.</span></span>

<span data-ttu-id="0e7f2-123">GDI + 提供幾個不屬於任何類別的函式。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-123">GDI+ provides a few functions that are not part of any class.</span></span> <span data-ttu-id="0e7f2-124">其中兩個函數是 [**GdiplusStartup**](/windows/win32/api/Gdiplusinit/nf-gdiplusinit-gdiplusstartup) 和 [**GdiplusShutdown**](/windows/win32/api/Gdiplusinit/nf-gdiplusinit-gdiplusshutdown)。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-124">Two of those functions are [**GdiplusStartup**](/windows/win32/api/Gdiplusinit/nf-gdiplusinit-gdiplusstartup) and [**GdiplusShutdown**](/windows/win32/api/Gdiplusinit/nf-gdiplusinit-gdiplusshutdown).</span></span> <span data-ttu-id="0e7f2-125">您必須在進行任何其他 GDI + 呼叫之前呼叫 **GdiplusStartup** ，而且當您使用 gdi + 完成時，必須呼叫 **GdiplusShutdown** 。</span><span class="sxs-lookup"><span data-stu-id="0e7f2-125">You must call **GdiplusStartup** before you make any other GDI+ calls, and you must call **GdiplusShutdown** when you have finished using GDI+.</span></span>

 

 
