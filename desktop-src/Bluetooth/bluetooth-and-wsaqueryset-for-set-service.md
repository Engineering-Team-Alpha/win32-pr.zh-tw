---
title: 適用于設定服務的藍牙和 WSAQUERYSET
description: 使用 WSAQUERYSET 結構搭配 WSASetService 函式來註冊或移除藍牙命名空間中的服務實例 (NS \_ BTH) 。
ms.assetid: e582156d-a298-4d9b-8ed1-4c558fa4f203
keywords:
- 適用于設定服務藍牙的藍牙和 WSAQUERYSET
- WSAQUERYSET 藍牙，適用于設定服務
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 64a632cad2c813856367d4565bc69e0d4baf2eba
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103933323"
---
# <a name="bluetooth-and-wsaqueryset-for-set-service"></a>適用于設定服務的藍牙和 WSAQUERYSET

藍牙使用 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) 結構來協助探索藍牙命名空間 NS BTH 中的裝置和服務 \_ 。

[**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea)函式會使用 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構來註冊或移除 Bluetooth 命名空間中的服務實例。 下表列出 **WSAQUERYSET** 結構中的成員值。

| 成員                      | 必要值 (輸入)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 輸出                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **dwSize**                  | 必須設定為 **sizeof** ([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) 。 當做版本控制機制使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwOutputFlags**           | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszServiceInstanceName** | 此為選用步驟，但建議執行。 用來建立藍牙 ServiceName 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpServiceClassId**        | 必要。 對應至服務類別的 GUID。 此值應該對應至已知設定檔的藍牙指派數位檔中的 GUID，或針對不是以設定檔為基礎的應用程式，對應到應用程式產生的唯一 UUID。 用來建立 ServiceClassIdList 屬性序列，其為其唯一的成員。                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpVersion**               | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszComment**             | 選擇性。 用來建立藍牙 ServiceDescription 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNameSpace**             | 要在其中限制服務的命名空間。 必須是 NS \_ BTH。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpNSProviderId**          | 不需要。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszCoNtext**             | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNumberOfProtocols**     | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpafpProtocols**          | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszQueryString**         | 未使用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNumberOfCsAddrs**       | 要註冊的位址數目。 必須是 1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpcsaBuffer**             | 如果 **lpBlob** 尚未填入原始的 SDP 資料流程，則為必要。 [**CSADDR \_ 資訊**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info)結構的指標，其 **LocalAddr. lpSockaddr** 成員指向伺服器正在接聽連接的 [**SOCKADDR \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth) 。 [**Getsockname**](/windows/desktop/api/winsock/nf-winsock-getsockname)函數可以用來傳回系結通訊端的 **SOCKADDR \_ BTH** 結構。 系統會使用 **lpcsaBuffer** 成員中的資訊來建立藍牙 ProtocolDescriptorList SDP 屬性。 **LpcsaBuffer** 中提供的通訊協定和埠必須是唯一的 (先前未) 註冊，而且會用來為後續呼叫刪除的記錄編制索引。 用來建立 SDP 記錄的藍牙 ProtocolDescriptorList 屬性。 | 無。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpBlob**                  | 選擇性。 指向 [**BTH \_ 集 \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service)結構之 [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob)結構的指標，可讓用戶端提供包含應用程式所建立之二進位 SDP 記錄的藍牙特定結構。 如果將 **lpBlob** 提供給 [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea) 函式，則會忽略 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) 結構的所有其他成員（ **dwSize** 和 **dwNameSpace** 除外）。 如需詳細資訊，請參閱 [藍牙和 BLOB](bluetooth-and-blob.md) 。 在許多情況下都需要提交二進位的 SDP 記錄，因為可以從 **WSAQUERYSET** 結構轉換有限數量的 sdp 屬性，並將字串轉換為預設的語言 utf-8 編碼。           | 如果在輸入上提供了選擇性的 [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) 和 [**BTH \_ SET \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service) 結構，以及 ULONG 版本並處理 **BTH \_ SET \_ SERVICE** 必須指向的值，則版本會更新為包含 \_ \_ 藍牙 Windows 通訊端提供者的 BTH SDP 版本值，而且會提供控制碼，之後才能刪除記錄。 |



 

> [!Note]  
> 若要移除服務， [**BTH \_ SET \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service) 結構中唯一需要的成員是 **pSdpVersion** 和 **pRecordHandle** 成員。

 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[適用于裝置查詢的藍牙和 WSAQUERYSET](bluetooth-and-wsaqueryset-for-device-inquiry.md)
</dt> <dt>

[用於服務查詢的藍牙和 WSAQUERYSET](bluetooth-and-wsaqueryset-for-service-inquiry.md)
</dt> <dt>

[藍牙和 BLOB](bluetooth-and-blob.md)
</dt> <dt>

[藍牙和 WSASetService](bluetooth-and-wsasetservice.md)
</dt> <dt>

[**Blob**](/windows/desktop/api/nspapi/ns-nspapi-blob)
</dt> <dt>

[**BTH \_ 設定 \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service)
</dt> <dt>

[**CSADDR \_ 資訊**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info)
</dt> <dt>

[**getsockname**](/windows/desktop/api/winsock/nf-winsock-getsockname)
</dt> <dt>

[**SOCKADDR \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)
</dt> <dt>

[**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[Windows Sockets](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> </dl>

 

 