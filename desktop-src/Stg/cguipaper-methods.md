---
title: CGuiPaper 方法
description: CGuiPaper 的方法摘要如下所示。 這些方法全都在 GUIPAPER 中執行。Cpp。
ms.assetid: 965a60d4-2737-4a2d-8790-bee70bceaeeb
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1303ca38ffe02da0dc747e1a8834d36419452209
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103671671"
---
# <a name="cguipaper-methods"></a><span data-ttu-id="a5062-104">CGuiPaper 方法</span><span class="sxs-lookup"><span data-stu-id="a5062-104">CGuiPaper Methods</span></span>

<span data-ttu-id="a5062-105">CGuiPaper 的方法摘要如下所示。</span><span class="sxs-lookup"><span data-stu-id="a5062-105">CGuiPaper's methods are summarized as follows.</span></span> <span data-ttu-id="a5062-106">這些方法全都在 GUIPAPER 中執行。Cpp。</span><span class="sxs-lookup"><span data-stu-id="a5062-106">These methods are all implemented in GUIPAPER.CPP.</span></span>



| <span data-ttu-id="a5062-107">方法</span><span class="sxs-lookup"><span data-stu-id="a5062-107">Method</span></span>                                                         | <span data-ttu-id="a5062-108">描述</span><span class="sxs-lookup"><span data-stu-id="a5062-108">Description</span></span>                                                                                                           |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a5062-109">BOOL Init (HINSTANCE hInst、HWND hWnd、TCHAR \* pszCmdLineFile) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-109">BOOL Init(HINSTANCE hInst, HWND hWnd, TCHAR\* pszCmdLineFile);</span></span> | <span data-ttu-id="a5062-110">初始化 GuiPaper。</span><span class="sxs-lookup"><span data-stu-id="a5062-110">Initializes the GuiPaper.</span></span> <span data-ttu-id="a5062-111">要求伺服器建立 COPaper 物件。</span><span class="sxs-lookup"><span data-stu-id="a5062-111">Asks server to create a COPaper object.</span></span>                                                     |
| <span data-ttu-id="a5062-112">HRESULT DrawOn (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-112">HRESULT DrawOn(void);</span></span>                                          | <span data-ttu-id="a5062-113">鎖定此用戶端專用繪圖的紙張。</span><span class="sxs-lookup"><span data-stu-id="a5062-113">Locks paper for drawing exclusively by this client.</span></span>                                                                   |
| <span data-ttu-id="a5062-114">HRESULT DrawOff (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-114">HRESULT DrawOff(void);</span></span>                                         | <span data-ttu-id="a5062-115">解除鎖定紙張以允許其他用戶端繪製。</span><span class="sxs-lookup"><span data-stu-id="a5062-115">Unlocks paper to allow other clients to draw.</span></span>                                                                         |
| <span data-ttu-id="a5062-116">HRESULT ClearWin (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-116">HRESULT ClearWin(void);</span></span>                                        | <span data-ttu-id="a5062-117">清除顯示視窗，但保留筆墨資料。</span><span class="sxs-lookup"><span data-stu-id="a5062-117">Clears display window but retains ink data.</span></span>                                                                           |
| <span data-ttu-id="a5062-118">HRESULT PaintWin (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-118">HRESULT PaintWin(void);</span></span>                                        | <span data-ttu-id="a5062-119">清除視窗，並使用目前的筆墨資料重新繪製。</span><span class="sxs-lookup"><span data-stu-id="a5062-119">Clears window and repaints with current ink data.</span></span>                                                                     |
| <span data-ttu-id="a5062-120">HRESULT 清除 (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-120">HRESULT Erase(void);</span></span>                                           | <span data-ttu-id="a5062-121">清除目前的繪圖內容，並清除顯示視窗。</span><span class="sxs-lookup"><span data-stu-id="a5062-121">Erases current drawing content and clears display window.</span></span>                                                             |
| <span data-ttu-id="a5062-122">HRESULT 調整大小 (WORD wWidth、WORD wHeight) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-122">HRESULT Resize(WORD wWidth, WORD wHeight);</span></span>                     | <span data-ttu-id="a5062-123">調整顯示視窗的大小。</span><span class="sxs-lookup"><span data-stu-id="a5062-123">Resizes the display window.</span></span>                                                                                           |
| <span data-ttu-id="a5062-124">HRESULT InkWidth (SHORT nInkWidth) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-124">HRESULT InkWidth(SHORT nInkWidth);</span></span>                             | <span data-ttu-id="a5062-125">設定繪圖的目前筆墨寬度。</span><span class="sxs-lookup"><span data-stu-id="a5062-125">Sets current ink width for drawing.</span></span>                                                                                   |
| <span data-ttu-id="a5062-126">HRESULT InkColor (COLORREF crInkColor) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-126">HRESULT InkColor(COLORREF crInkColor);</span></span>                         | <span data-ttu-id="a5062-127">設定繪圖的目前筆墨色彩。</span><span class="sxs-lookup"><span data-stu-id="a5062-127">Sets current ink color for drawing.</span></span>                                                                                   |
| <span data-ttu-id="a5062-128">HRESULT InkSaving (BOOL bInkSaving) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-128">HRESULT InkSaving(BOOL bInkSaving);</span></span>                            | <span data-ttu-id="a5062-129">開啟和關閉 COPaper 中的筆跡資料儲存。</span><span class="sxs-lookup"><span data-stu-id="a5062-129">Turns ink data saving in COPaper on and off.</span></span>                                                                          |
| <span data-ttu-id="a5062-130">HRESULT InkStart (SHORT nX、SHORT nY) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-130">HRESULT InkStart(SHORT nX, SHORT nY);</span></span>                          | <span data-ttu-id="a5062-131">啟動筆墨繪圖順序。</span><span class="sxs-lookup"><span data-stu-id="a5062-131">Starts ink drawing sequence.</span></span>                                                                                          |
| <span data-ttu-id="a5062-132">HRESULT InkDraw (SHORT nX、SHORT nY) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-132">HRESULT InkDraw(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="a5062-133">繪製筆墨順序資料。</span><span class="sxs-lookup"><span data-stu-id="a5062-133">Draws ink sequence data.</span></span>                                                                                              |
| <span data-ttu-id="a5062-134">HRESULT InkStop (SHORT nX、SHORT nY) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-134">HRESULT InkStop(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="a5062-135">停止筆墨繪圖順序。</span><span class="sxs-lookup"><span data-stu-id="a5062-135">Stops ink drawing sequence.</span></span>                                                                                           |
| <span data-ttu-id="a5062-136">HRESULT ConnectPaperSink (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-136">HRESULT ConnectPaperSink(void);</span></span>                                | <span data-ttu-id="a5062-137">將用戶端 PaperSink 物件連接至伺服器 COPaper 來源。</span><span class="sxs-lookup"><span data-stu-id="a5062-137">Connects the client PaperSink object to the server COPaper source.</span></span>                                                    |
| <span data-ttu-id="a5062-138">HRESULT DisconnectPaperSink (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-138">HRESULT DisconnectPaperSink(void);</span></span>                             | <span data-ttu-id="a5062-139">中斷用戶端 PaperSink 物件與伺服器 COPaper 來源的連接。</span><span class="sxs-lookup"><span data-stu-id="a5062-139">Disconnect the client PaperSink object from the server COPaper source.</span></span>                                                |
| <span data-ttu-id="a5062-140">HRESULT Load (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-140">HRESULT Load(void);</span></span>                                            | <span data-ttu-id="a5062-141">從目前的複合檔案載入筆墨資料。</span><span class="sxs-lookup"><span data-stu-id="a5062-141">Loads ink data from current compound file.</span></span>                                                                            |
| <span data-ttu-id="a5062-142">HRESULT 儲存 (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-142">HRESULT Save(void);</span></span>                                            | <span data-ttu-id="a5062-143">將現有的筆跡資料儲存至目前的複合檔案。</span><span class="sxs-lookup"><span data-stu-id="a5062-143">Saves existing ink data to current compound file.</span></span>                                                                     |
| <span data-ttu-id="a5062-144">HRESULT AskSave (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-144">HRESULT AskSave(void);</span></span>                                         | <span data-ttu-id="a5062-145">檢查繪圖是否已變更。</span><span class="sxs-lookup"><span data-stu-id="a5062-145">Checks if drawing changed.</span></span> <span data-ttu-id="a5062-146">如果是，則會顯示對話方塊，詢問使用者是否要儲存變更並適當地回應。</span><span class="sxs-lookup"><span data-stu-id="a5062-146">If so, displays dialog box asking user whether to save changes and responds appropriately.</span></span> |
| <span data-ttu-id="a5062-147">HRESULT 開啟 (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-147">HRESULT Open(void);</span></span>                                            | <span data-ttu-id="a5062-148">顯示 Win32 通用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="a5062-148">Shows Win32 common dialog box.</span></span> <span data-ttu-id="a5062-149">開啟現有的紙張資料複合檔案。</span><span class="sxs-lookup"><span data-stu-id="a5062-149">Opens existing paper data compound file.</span></span>                                               |
| <span data-ttu-id="a5062-150">HRESULT (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-150">HRESULT SaveAs(void);</span></span>                                          | <span data-ttu-id="a5062-151">顯示 Win32 通用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="a5062-151">Shows Win32 common dialog box.</span></span> <span data-ttu-id="a5062-152">將目前的檔資料儲存在重新命名的檔案中。</span><span class="sxs-lookup"><span data-stu-id="a5062-152">Saves current paper data in renamed file.</span></span>                                              |
| <span data-ttu-id="a5062-153">COLORREF PickColor (void) ;</span><span class="sxs-lookup"><span data-stu-id="a5062-153">COLORREF PickColor(void);</span></span>                                      | <span data-ttu-id="a5062-154">顯示 Win32 通用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="a5062-154">Shows Win32 ommon dialog box.</span></span> <span data-ttu-id="a5062-155">要求使用者選擇 [新的畫筆色彩]。</span><span class="sxs-lookup"><span data-stu-id="a5062-155">Asks user to choose new pen color.</span></span>                                                      |



 

<span data-ttu-id="a5062-156">**Init** 方法會建立以伺服器為基礎的 COPaper 物件，並指派 CGuiPaper 的 m \_ pIPaper 成員。</span><span class="sxs-lookup"><span data-stu-id="a5062-156">The **Init** method creates the server-based COPaper object and assigns CGuiPaper's m\_pIPaper member.</span></span>

<span data-ttu-id="a5062-157">**AskSave**、 **Open**、 **SaveAs** 和 **PickColor** 方法提供使用 Win32 通用對話方塊的熟悉 GUI 行為。</span><span class="sxs-lookup"><span data-stu-id="a5062-157">The **AskSave**, **Open**, **SaveAs**, and **PickColor** methods provide familiar GUI behavior using Win32 common dialogs.</span></span> <span data-ttu-id="a5062-158">例如， **Open** 方法會使用 [Win32 Open file name] 對話方塊來要求使用者指定要開啟的檔案名。</span><span class="sxs-lookup"><span data-stu-id="a5062-158">For example, the **Open** method uses the Win32 Open File Name dialog box to ask the user to specify a file name for opening.</span></span>

<span data-ttu-id="a5062-159">本教學課程稍後將詳細說明「 **載入** 」和「 **儲存** 」方法。</span><span class="sxs-lookup"><span data-stu-id="a5062-159">The **Load** and **Save** methods will be covered in detail later in this tour.</span></span>

<span data-ttu-id="a5062-160">**InkSaving**、 **InkStart**、 **InkDraw** 和 **InkStop** 是 **StoClien** 應用程式繪圖功能的集中方法。</span><span class="sxs-lookup"><span data-stu-id="a5062-160">**InkSaving**, **InkStart**, **InkDraw**, and **InkStop** are the central methods for the drawing functionality of the **StoClien** application.</span></span> <span data-ttu-id="a5062-161">**StoClien** 會使用這些 CGuiPaper 方法來捕捉、顯示和儲存互動式繪圖資料（在使用者控制項下出現）。</span><span class="sxs-lookup"><span data-stu-id="a5062-161">**StoClien** uses these CGuiPaper methods to capture, display, and store the interactive drawing data as it occurs under user control.</span></span> <span data-ttu-id="a5062-162">它們會執行將繪製影像繪製至用戶端視窗，以及將繪圖資料傳遞到伺服器中 COPaper 的雙重角色。</span><span class="sxs-lookup"><span data-stu-id="a5062-162">They perform a dual role of painting the drawn image to the client window as well as passing the drawing data to COPaper in the server.</span></span> <span data-ttu-id="a5062-163">COPaper 會將繪圖資料轉譯為筆跡資料封包以進行儲存。</span><span class="sxs-lookup"><span data-stu-id="a5062-163">COPaper translates the drawing data into ink data packets for storage.</span></span>

 

 




