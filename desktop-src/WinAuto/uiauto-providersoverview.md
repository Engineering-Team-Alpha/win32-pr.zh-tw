---
title: UI 自動化提供者概觀
description: 本主題概要說明控制項開發人員如何執行消費者介面自動化提供者。
ms.assetid: 8928c889-0e0a-439f-87e8-a9d121fcf73f
keywords:
- 消費者介面自動化，提供者總覽
- 消費者介面自動化，提供者類型
- 消費者介面自動化，提供者概念
- 提供者，關於
- 提供者，類型
- 提供者，概念
- 提供者、元素
- 提供者，導覽
- 提供者、視圖
- 提供者、架構
- 提供者、片段
- 提供者、主機
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 21f70a806fe33b16eed2555c123cc50f1f2b28da
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103932097"
---
# <a name="ui-automation-providers-overview"></a>UI 自動化提供者概觀

Microsoft 消費者介面自動化提供者是一個軟體物件，它會公開應用程式 UI 的元素，讓協助工具用戶端應用程式可以取得專案的相關資訊，並叫用其功能。 一般而言，UI 中的每個控制項或其他相異元素都有提供者。

Microsoft 針對 Microsoft Win32、Windows Forms 和 Windows Presentation Foundation (WPF) 所提供的每個標準控制項，各包含一個提供者。 這表示標準控制項會自動公開給消費者介面自動化用戶端;您不需要為標準控制項執行任何協助工具介面。

如果您的應用程式包含任何自訂控制項，您必須為這些控制項執行消費者介面自動化提供者，使其可供協助工具用戶端應用程式存取。 您也需要為不包含提供者的任何協力廠商控制項，執行提供者。 您可以藉由執行消費者介面自動化提供者介面和控制項模式介面來執行提供者。

本主題概要說明控制項開發人員如何執行消費者介面自動化提供者。 其中包含下列各節。

-   [提供者類型](#types-of-providers)
-   [使用者介面自動化提供者概念](#ui-automation-provider-concepts)
    -   [元素](#elements)
    -   [架構](#frameworks)
    -   [片段](#fragments)
    -   [主控件](#hosts)
-   [相關主題](#related-topics)

## <a name="types-of-providers"></a>提供者類型

消費者介面自動化提供者分為兩類：伺服器端提供者，以及用戶端 (或 *proxy*) 提供者。

伺服器端提供者是一個物件（例如自訂控制項），其中包含自己的相關消費者介面自動化提供者介面的原生執行。 伺服器端提供者會將它的提供者介面實作為消費者介面自動化核心（可服務來自用戶端的要求），藉此與用戶端應用程式跨進程界限進行通訊。 如需伺服器端提供者的詳細資訊，請參閱 [Server-Side 消費者介面自動化提供者執行](uiauto-serversideprovider.md)。

用戶端提供者（或 proxy）是代表控制項實消費者介面自動化提供者介面的物件，並不包含其本身的完整提供者執行。 如果沒有 proxy，則這類控制項在消費者介面自動化中大多是不透明的，它只能提供視窗控制碼 (**HWND**) 所提供的基本資訊，例如控制項位置。 一般而言，proxy 提供者會藉由傳送和接收 Windows 訊息，在整個進程界限上與應用程式進行通訊。 如需詳細資訊，請參閱 [消費者介面自動化提供者執行 Client-Side (Proxy) ](uiauto-clientsideprovider.md)。

## <a name="ui-automation-provider-concepts"></a>使用者介面自動化提供者概念

本節提供某些主要概念的簡短說明，讓您了解以便實作使用者介面自動化提供者。

### <a name="elements"></a>元素

消費者介面自動化專案是消費者介面自動化用戶端可以看見的 UI 的部分（通常是 windows 或控制項）。 範例包含應用程式視窗、窗格、按鈕、工具提示、清單方塊和清單項目。

消費者介面自動化元素會以樹狀結構的形式公開給用戶端。 消費者介面自動化藉由在某個專案之間導覽來建立樹狀結構。 每個元素的提供者都會啟用導覽。 每個元素都可以指向其本身的父項目、其同級元素，以及其第一個和最後一個子專案。

用戶端可以在三個主要視圖中看到消費者介面自動化樹狀結構，如下表所述：



| 檢視         | 描述                                                    |
|--------------|----------------------------------------------------------------|
| 未經處理的檢視     | 包含所有元素。                                         |
| 控制項檢視 | 包含控制項的元素。                           |
| 內容檢視 | 包含可將資訊傳達給使用者的控制項元素。 |



 

提供者實作負責將項目定義為內容項目或控制項項目。 控制項不一定是內容項目，但所有的內容項目都會是控制項項目。

如需樹狀結構用戶端視圖的詳細資訊，請參閱 [消費者介面自動化樹狀結構總覽](uiauto-treeoverview.md)。

### <a name="frameworks"></a>架構

架構是一個元件，管理該畫面區域的子控制項、點擊測試和呈現。 例如，Win32 視窗（通常稱為 **HWND**）可以做為包含多個消費者介面自動化元素（例如功能表列、狀態列和按鈕）的架構。

Win32 容器控制項（例如清單方塊和樹狀檢視控制項）被視為是架構，因為它們包含自己的程式碼來轉譯子專案，並對其執行點擊測試。 相較之下，WPF 清單方塊並不是架構，因為呈現和點擊測試都是由包含視窗處理。

應用程式中的 UI 可由不同的架構所組成。 例如，應用程式中的 **HWND** 可能包含動態 HTML (DHTML) 它可以在 **HWND** 中包含下拉式列示方塊，例如下拉式方塊。

### <a name="fragments"></a>片段

來自特定架構之元素的完整子樹稱為片段。 子樹狀結構之根目錄節點的項目稱為片段根目錄。 片段根目錄沒有父代，但裝載于其他架構中，通常是 Win32 視窗 (**HWND**) 。

### <a name="hosts"></a>主機

每個片段的根節點都必須裝載于元素中，通常是 Win32 視窗 (**HWND**) 。 例外狀況是桌面，桌面並沒有裝載於任何其他項目中。 自訂控制項的主機是控制項本身的 **HWND** ，而不是應用程式視窗或可能包含最上層控制項群組的任何其他視窗。

片段的主機在提供消費者介面自動化服務方面扮演著重要的角色。 可在片段根目錄中進行巡覽並提供某些預設屬性，讓自訂提供者不需要進行實作。

## <a name="related-topics"></a>相關主題

<dl> <dt>

**概念**
</dt> <dt>

[執行 Client-Side 消費者介面自動化提供者](uiauto-clientsideprovider.md)
</dt> <dt>

[執行 Server-Side 消費者介面自動化提供者](uiauto-serversideprovider.md)
</dt> <dt>

[UI 自動化樹狀目錄概觀](uiauto-treeoverview.md)
</dt> </dl>

 

 




