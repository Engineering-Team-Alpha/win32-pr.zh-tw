---
description: 這組主題會討論如何執行延伸模組處理常式，讓您修改各種 Shell 動作。
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: 使用 Shell 擴充功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973697"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="c72a4-103">使用 Shell 擴充功能</span><span class="sxs-lookup"><span data-stu-id="c72a4-103">Working with Shell Extensions</span></span>

<span data-ttu-id="c72a4-104">您可以使用登錄專案和 .ini 檔案來擴充 Shell 的功能。</span><span class="sxs-lookup"><span data-stu-id="c72a4-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="c72a4-105">雖然這種擴充 Shell 的方法很簡單，且適用于許多用途，但有限。</span><span class="sxs-lookup"><span data-stu-id="c72a4-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="c72a4-106">例如，如果您使用登錄來指定檔案類型的自訂圖示，就會針對該類型的每個檔案顯示相同的圖示。</span><span class="sxs-lookup"><span data-stu-id="c72a4-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="c72a4-107">使用登錄延伸 Shell 不允許您變更檔案類型之不同成員的圖示。</span><span class="sxs-lookup"><span data-stu-id="c72a4-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="c72a4-108">Shell 的其他層面（例如，在檔案以滑鼠右鍵按一下時可顯示的 [ **屬性** ] 屬性工作表），無法透過登錄來修改。</span><span class="sxs-lookup"><span data-stu-id="c72a4-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="c72a4-109">擴充 Shell 的一個更強大且靈活的方法，就是執行 *shell 擴充處理常式*。</span><span class="sxs-lookup"><span data-stu-id="c72a4-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="c72a4-110">您可以針對 Shell 可採用的各種動作，執行這些處理常式。</span><span class="sxs-lookup"><span data-stu-id="c72a4-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="c72a4-111">在採取動作之前，Shell 會查詢延伸模組處理常式，讓它有機會修改動作。</span><span class="sxs-lookup"><span data-stu-id="c72a4-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="c72a4-112">常見的範例是快捷方式功能表延伸模組處理常式。</span><span class="sxs-lookup"><span data-stu-id="c72a4-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="c72a4-113">如果是針對檔案類型所執行，則會在每次以滑鼠右鍵按一下其中一個檔案時進行查詢。</span><span class="sxs-lookup"><span data-stu-id="c72a4-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="c72a4-114">然後，處理常式可以依檔案逐一指定其他功能表項目，而不是針對該檔案類型的所有檔案設定相同的集合。</span><span class="sxs-lookup"><span data-stu-id="c72a4-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="c72a4-115">這組主題會討論如何執行延伸模組處理常式，讓您修改各種 Shell 動作。</span><span class="sxs-lookup"><span data-stu-id="c72a4-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="c72a4-116">下列處理常式會與特定檔案類型相關聯，並可讓您以檔案為基礎來指定。</span><span class="sxs-lookup"><span data-stu-id="c72a4-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="c72a4-117">處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-117">Handler</span></span>                                               | <span data-ttu-id="c72a4-118">描述</span><span class="sxs-lookup"><span data-stu-id="c72a4-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c72a4-119">快速鍵功能表處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="c72a4-120">在顯示檔案的快捷方式功能表之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="c72a4-121">它可讓您依檔案逐一將專案新增至快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="c72a4-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="c72a4-122">資料處理程式</span><span class="sxs-lookup"><span data-stu-id="c72a4-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="c72a4-123">在 Shell 物件上執行拖放作業時呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="c72a4-124">它可讓您提供其他剪貼簿格式給放置目標。</span><span class="sxs-lookup"><span data-stu-id="c72a4-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="c72a4-125">捨棄處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="c72a4-126">當資料物件在檔案上拖放或卸載時呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="c72a4-127">它可讓您將檔案放入放置目標。</span><span class="sxs-lookup"><span data-stu-id="c72a4-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="c72a4-128">圖示處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="c72a4-129">在顯示檔案的圖示之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="c72a4-130">它可讓您以檔案為基礎，以自訂圖示取代檔案的預設圖示。</span><span class="sxs-lookup"><span data-stu-id="c72a4-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="c72a4-131">屬性工作表處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="c72a4-132">在顯示物件的 [ **屬性** ] 屬性工作表之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="c72a4-133">它可讓您新增或取代頁面。</span><span class="sxs-lookup"><span data-stu-id="c72a4-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="c72a4-134">**縮圖影像處理常式**</span><span class="sxs-lookup"><span data-stu-id="c72a4-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="c72a4-135">提供表示專案的影像。</span><span class="sxs-lookup"><span data-stu-id="c72a4-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="c72a4-136">**資訊提示處理常式**</span><span class="sxs-lookup"><span data-stu-id="c72a4-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="c72a4-137">當使用者將滑鼠指標移至物件上方時，提供快顯視窗。</span><span class="sxs-lookup"><span data-stu-id="c72a4-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="c72a4-138">**元資料處理程式**</span><span class="sxs-lookup"><span data-stu-id="c72a4-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="c72a4-139">提供中繼資料的讀取和寫入存取 (屬性) 儲存在檔案中。</span><span class="sxs-lookup"><span data-stu-id="c72a4-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="c72a4-140">這可以用來擴充詳細資料檢視、提示、屬性頁和群組功能。</span><span class="sxs-lookup"><span data-stu-id="c72a4-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="c72a4-141">有些則不會與特定檔案類型相關聯，而是在某些 Shell 作業之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="c72a4-142">處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-142">Handler</span></span>                                                            | <span data-ttu-id="c72a4-143">描述</span><span class="sxs-lookup"><span data-stu-id="c72a4-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c72a4-144">資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="c72a4-145">由 Windows 檔案總管呼叫，然後才會顯示資料夾的詳細資料檢視。</span><span class="sxs-lookup"><span data-stu-id="c72a4-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="c72a4-146">它可讓您將自訂資料行新增至詳細資料檢視。</span><span class="sxs-lookup"><span data-stu-id="c72a4-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="c72a4-147">複製勾點處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="c72a4-148">當資料夾或印表機物件即將移動、複製、刪除或重新命名時呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="c72a4-149">它可讓您核准或拒絕此作業。</span><span class="sxs-lookup"><span data-stu-id="c72a4-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="c72a4-150">拖放功能處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="c72a4-151">在使用滑鼠右鍵拖曳檔案時呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="c72a4-152">它可讓您修改所顯示的快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="c72a4-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="c72a4-153">圖示重迭處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="c72a4-154">在顯示檔案的圖示之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="c72a4-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="c72a4-155">它可讓您指定檔案圖示的覆迭。</span><span class="sxs-lookup"><span data-stu-id="c72a4-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="c72a4-156">搜尋處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="c72a4-157">呼叫以啟動搜尋引擎。</span><span class="sxs-lookup"><span data-stu-id="c72a4-157">Called to launch a search engine.</span></span> <span data-ttu-id="c72a4-158">它可讓您執行可從 [ **開始** ] 功能表或 Windows 檔案總管存取的自訂搜尋引擎。</span><span class="sxs-lookup"><span data-stu-id="c72a4-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="c72a4-159">上述各節將說明如何執行特定延伸模組處理常式的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="c72a4-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="c72a4-160">如需所有 Shell 延伸模組處理常式通用之執行問題的討論，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="c72a4-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="c72a4-161">初始化 Shell 擴充處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="c72a4-162">註冊 Shell 延伸模組處理常式</span><span class="sxs-lookup"><span data-stu-id="c72a4-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
