---
description: 討論新的工作列功能，包括合併啟動與切換、工作列按鈕的增強功能，例如單鍵存取檔和應用程式特定的工作、傳輸控制項和狀態通知、縮圖標記法，以及根據索引標籤式應用程式中的個別索引標籤來重新排列工作列按鈕的功能。
ms.assetid: cbf2b07d-d67c-4755-888c-d40692d13cae
title: 工作列擴充功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4df308d8045301b98937eb03af595d2e800921b0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103851627"
---
# <a name="taskbar-extensions"></a><span data-ttu-id="45249-103">工作列擴充功能</span><span class="sxs-lookup"><span data-stu-id="45249-103">Taskbar Extensions</span></span>

<span data-ttu-id="45249-104">從 Windows 7 開始，在讓使用者以快速且有效率的方式進行的指導準則下，已大幅擴充工作列。</span><span class="sxs-lookup"><span data-stu-id="45249-104">As of Windows 7, the taskbar has been extended significantly under the guiding principle of getting users where they're going as quickly and efficiently as possible.</span></span> <span data-ttu-id="45249-105">為了達到這個目的，使用者需要完成的應用程式視窗、檔案和命令現在會集中到單一工作列按鈕，以合併先前散佈的資訊來源和控制項。</span><span class="sxs-lookup"><span data-stu-id="45249-105">To that end, the application windows, files, and commands that the user needs to accomplish that are now centralized into a single taskbar button that consolidates previously scattered information sources and controls.</span></span> <span data-ttu-id="45249-106">使用者現在可以在單一位置尋找個別檔或索引標籤的一般工作、最近和頻繁的檔案、警示、進度通知和縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-106">A user can now find common tasks, recent and frequent files, alerts, progress notifications, and thumbnails for individual documents or tabs all in one place.</span></span>

-   [<span data-ttu-id="45249-107">整合啟動和切換</span><span class="sxs-lookup"><span data-stu-id="45249-107">Unified Launching and Switching</span></span>](#unified-launching-and-switching)
-   [<span data-ttu-id="45249-108">跳躍清單</span><span class="sxs-lookup"><span data-stu-id="45249-108">Jump Lists</span></span>](#jump-lists)
-   [<span data-ttu-id="45249-109">目的地</span><span class="sxs-lookup"><span data-stu-id="45249-109">Destinations</span></span>](#destinations)
-   [<span data-ttu-id="45249-110">工作</span><span class="sxs-lookup"><span data-stu-id="45249-110">Tasks</span></span>](#tasks)
-   [<span data-ttu-id="45249-111">自訂跳躍清單</span><span class="sxs-lookup"><span data-stu-id="45249-111">Customizing Jump Lists</span></span>](#customizing-jump-lists)
-   [<span data-ttu-id="45249-112">縮圖工具列</span><span class="sxs-lookup"><span data-stu-id="45249-112">Thumbnail Toolbars</span></span>](#thumbnail-toolbars)
-   [<span data-ttu-id="45249-113">圖示重迭</span><span class="sxs-lookup"><span data-stu-id="45249-113">Icon Overlays</span></span>](#icon-overlays)
-   [<span data-ttu-id="45249-114">進度列</span><span class="sxs-lookup"><span data-stu-id="45249-114">Progress Bars</span></span>](#progress-bars)
-   [<span data-ttu-id="45249-115">Deskbands</span><span class="sxs-lookup"><span data-stu-id="45249-115">Deskbands</span></span>](#deskbands)
-   [<span data-ttu-id="45249-116">通知區域</span><span class="sxs-lookup"><span data-stu-id="45249-116">Notification Area</span></span>](#notification-area)
-   [<span data-ttu-id="45249-117">縮圖</span><span class="sxs-lookup"><span data-stu-id="45249-117">Thumbnails</span></span>](#thumbnails)
-   [<span data-ttu-id="45249-118">相關主題</span><span class="sxs-lookup"><span data-stu-id="45249-118">Related topics</span></span>](#related-topics)

## <a name="unified-launching-and-switching"></a><span data-ttu-id="45249-119">整合啟動和切換</span><span class="sxs-lookup"><span data-stu-id="45249-119">Unified Launching and Switching</span></span>

<span data-ttu-id="45249-120">從 Windows 7 工作列，快速啟動不再是個別的工具列。</span><span class="sxs-lookup"><span data-stu-id="45249-120">As of the Windows 7 taskbar, Quick Launch is no longer a separate toolbar.</span></span> <span data-ttu-id="45249-121">通常包含快速啟動的啟動器快速鍵現在已釘選到工作列本身，並以目前正在執行之應用程式的按鈕混合。</span><span class="sxs-lookup"><span data-stu-id="45249-121">The launcher shortcuts that Quick Launch typically contained are now pinned to the taskbar itself, mingled with buttons for currently running applications.</span></span> <span data-ttu-id="45249-122">當使用者從已釘選的啟動器快速鍵啟動應用程式時，只要應用程式正在執行，圖示就會轉換成應用程式的工作列按鈕。</span><span class="sxs-lookup"><span data-stu-id="45249-122">When a user starts an application from a pinned launcher shortcut, the icon transforms into the application's taskbar button for as long as the application is running.</span></span> <span data-ttu-id="45249-123">當使用者關閉應用程式時，按鈕會還原為圖示。</span><span class="sxs-lookup"><span data-stu-id="45249-123">When the user closes the application, the button reverts to the icon.</span></span> <span data-ttu-id="45249-124">但是，執行中應用程式的啟動程式快捷方式和按鈕只是 Windows 7 工作列按鈕的不同形式。</span><span class="sxs-lookup"><span data-stu-id="45249-124">However, both the launcher shortcut and the button for the running application are just different forms of the Windows 7 taskbar button.</span></span>

![windows 7 工作列](images/taskbar/taskbar.png)

<span data-ttu-id="45249-126">預設會針對新的安裝釘選一組小型應用程式。</span><span class="sxs-lookup"><span data-stu-id="45249-126">A small set of applications are pinned by default for new installations.</span></span> <span data-ttu-id="45249-127">除了上述以外，只有使用者可以釘選更多應用程式;不允許應用程式以程式設計方式釘選。</span><span class="sxs-lookup"><span data-stu-id="45249-127">Other than these, only the user can pin further applications; programmatic pinning by an application is not permitted.</span></span>

<span data-ttu-id="45249-128">快速啟動的顯示桌面功能現在位於工作列最右邊。</span><span class="sxs-lookup"><span data-stu-id="45249-128">The Show Desktop feature from Quick Launch is now located at the taskbar's far right.</span></span> <span data-ttu-id="45249-129">將滑鼠停留在此區域，會使所有作用中視窗變成透明，顯示桌面。</span><span class="sxs-lookup"><span data-stu-id="45249-129">Hovering over this area causes all active windows to become transparent, showing the desktop.</span></span> <span data-ttu-id="45249-130">按一下該區域會執行將所有視窗最小化並切換至桌面的熟悉動作。</span><span class="sxs-lookup"><span data-stu-id="45249-130">Clicking the area executes the familiar action of minimizing all windows and switching to the desktop.</span></span>

<span data-ttu-id="45249-131">當應用程式正在執行時，其工作列按鈕會變成可存取下列所有功能的單一位置，以下將詳細討論。</span><span class="sxs-lookup"><span data-stu-id="45249-131">While the application is running, its taskbar button becomes the single place to access all of the following features, each discussed in detail below.</span></span>

-   <span data-ttu-id="45249-132">工作[：即使](#tasks)應用程式不在執行中，也會出現一般的應用程式命令。</span><span class="sxs-lookup"><span data-stu-id="45249-132">[Tasks](#tasks): common application commands, present even when the application is not running.</span></span>
-   <span data-ttu-id="45249-133">[目的地](#destinations)：最近和經常存取的應用程式特定檔案。</span><span class="sxs-lookup"><span data-stu-id="45249-133">[Destinations](#destinations): recently and frequently accessed files specific to the application.</span></span>
-   <span data-ttu-id="45249-134">[縮圖](#thumbnails)：視窗切換，包括個別索引標籤和檔的切換目標。</span><span class="sxs-lookup"><span data-stu-id="45249-134">[Thumbnails](#thumbnails): window switching, including switch targets for individual tabs and documents.</span></span>
-   <span data-ttu-id="45249-135">[縮圖工具列](#thumbnail-toolbars)：來自縮圖本身的基本應用程式控制。</span><span class="sxs-lookup"><span data-stu-id="45249-135">[Thumbnail Toolbars](#thumbnail-toolbars): basic application control from the thumbnail itself.</span></span>
-   <span data-ttu-id="45249-136">[進度](#progress-bars) 列和 [圖示](#icon-overlays)重迭：狀態通知。</span><span class="sxs-lookup"><span data-stu-id="45249-136">[Progress Bars](#progress-bars) and [Icon Overlays](#icon-overlays): status notifications.</span></span>

<span data-ttu-id="45249-137">工作列按鈕可以代表啟動器、單一應用程式視窗或群組。</span><span class="sxs-lookup"><span data-stu-id="45249-137">The taskbar button can represent a launcher, a single application window, or a group.</span></span> <span data-ttu-id="45249-138">稱為「應用程式使用者模型識別碼」的識別碼 (AppUserModelID) 會指派給每個群組。</span><span class="sxs-lookup"><span data-stu-id="45249-138">An identifier known as an Application User Model ID (AppUserModelID) is assigned to each group.</span></span> <span data-ttu-id="45249-139">您可以指定 AppUserModelID 來覆寫標準工作列群組，讓 windows 成為相同群組的成員，但在其他情況下可能不會看到。</span><span class="sxs-lookup"><span data-stu-id="45249-139">An AppUserModelID can be specified to override standard taskbar grouping, which allows windows to become members of the same group when they might not otherwise be seen as such.</span></span> <span data-ttu-id="45249-140">群組的每個成員都會在縮圖飛出視窗中提供個別的預覽，當滑鼠停留在群組的工作列按鈕上時，就會顯示此圖表。</span><span class="sxs-lookup"><span data-stu-id="45249-140">Each member of a group is given a separate preview in the thumbnail flyout that is shown when the mouse hovers over the group's taskbar button.</span></span> <span data-ttu-id="45249-141">請注意，群組本身仍是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="45249-141">Note that grouping itself remains optional.</span></span>

<span data-ttu-id="45249-142">從 Windows 7 開始，使用者現在可以透過拖放作業來重新排列工作列按鈕。</span><span class="sxs-lookup"><span data-stu-id="45249-142">As of Windows 7, taskbar buttons can now be rearranged by the user through drag-and-drop operations.</span></span>

> [!Note]  
> <span data-ttu-id="45249-143">快速啟動資料夾 ([\* \* \* \* FOLDERID \_ 快速啟動 \*](knownfolderid.md) \* \*) 仍可提供回溯相容性，但不再有快速啟動的 UI。</span><span class="sxs-lookup"><span data-stu-id="45249-143">The Quick Launch folder ([\*\*\*\*FOLDERID\_QuickLaunch\*\*\*\*](knownfolderid.md)) is still available for backward compatibility although there is no longer a Quick Launch UI.</span></span> <span data-ttu-id="45249-144">不過，新的應用程式應該不會要求在安裝期間將圖示新增至快速啟動。</span><span class="sxs-lookup"><span data-stu-id="45249-144">However, new applications should not ask to add an icon to Quick Launch during installation.</span></span>

 

<span data-ttu-id="45249-145">如需詳細資訊，請參閱 [應用程式使用者模型識別碼 (AppUserModelIDs) ](appids.md)。</span><span class="sxs-lookup"><span data-stu-id="45249-145">For more information, see [Application User Model IDs (AppUserModelIDs)](appids.md).</span></span>

## <a name="jump-lists"></a><span data-ttu-id="45249-146">跳躍清單</span><span class="sxs-lookup"><span data-stu-id="45249-146">Jump Lists</span></span>

<span data-ttu-id="45249-147">使用者通常會以存取檔或在程式中執行工作的意圖來啟動程式。</span><span class="sxs-lookup"><span data-stu-id="45249-147">A user typically launches a program with the intention of accessing a document or performing tasks within the program.</span></span> <span data-ttu-id="45249-148">遊戲程式的使用者可能想要取得已儲存的遊戲或啟動為特定字元，而不是從頭重新開機遊戲。</span><span class="sxs-lookup"><span data-stu-id="45249-148">The user of a game program might want to get to a saved game or launch as a specific character rather than restart a game from the beginning.</span></span> <span data-ttu-id="45249-149">為了讓使用者更有效率地達成最終目標，會 [將與應用程式相關聯](#tasks)的 [目的地](#destinations)清單和一般工作附加至該應用程式的工作列按鈕 (以及對等的 [**開始**] 功能表項目) 。</span><span class="sxs-lookup"><span data-stu-id="45249-149">To get users more efficiently to their final goal, a list of [destinations](#destinations) and common [tasks](#tasks) associated with an application is attached to that application's taskbar button (as well as to the equivalent **Start** menu entry).</span></span> <span data-ttu-id="45249-150">這是應用程式的捷徑清單。</span><span class="sxs-lookup"><span data-stu-id="45249-150">This is the application's Jump List.</span></span> <span data-ttu-id="45249-151">您可以使用捷徑清單 (應用程式未執行) 或是否代表一或多個視窗時，工作列按鈕是否處於啟動器狀態。</span><span class="sxs-lookup"><span data-stu-id="45249-151">The Jump List is available whether the taskbar button is in a launcher state (the application isn't running) or whether it represents one or more windows.</span></span> <span data-ttu-id="45249-152">以滑鼠右鍵按一下工作列按鈕，就會顯示應用程式的捷徑清單，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="45249-152">Right-clicking the taskbar button shows the application's Jump List, as shown in the following illustration.</span></span>

![具有釘選、經常性和工作類別的跳躍清單](images/taskbar/jumplist.png)

<span data-ttu-id="45249-154">根據預設，標準捷徑清單包含兩個類別：最近的專案和釘選的專案，但因為只有具有內容的類別會顯示在 UI 中，所以不會在第一次啟動時顯示這些類別。</span><span class="sxs-lookup"><span data-stu-id="45249-154">By default, a standard Jump List contains two categories: recent items and pinned items, although because only categories with content are shown in the UI, neither of these categories are shown on first launch.</span></span> <span data-ttu-id="45249-155">永遠存在的應用程式啟動圖示 (啟動應用程式的更多實例) 、從工作列釘選或取消釘選應用程式的選項，以及任何開啟視窗的 **關閉** 命令。</span><span class="sxs-lookup"><span data-stu-id="45249-155">Always present are an application launch icon (to launch more instances of the application), an option to pin or unpin the application from the taskbar, and a **Close** command for any open windows.</span></span>

## <a name="destinations"></a><span data-ttu-id="45249-156">目的地</span><span class="sxs-lookup"><span data-stu-id="45249-156">Destinations</span></span>

<span data-ttu-id="45249-157">**最近** 和 **頻繁** 的類別會被視為包含目的地。</span><span class="sxs-lookup"><span data-stu-id="45249-157">The **Recent** and **Frequent** categories are considered to contain destinations.</span></span> <span data-ttu-id="45249-158">目的地（通常是檔案、檔或 URL）可以編輯、流覽、查看等等。</span><span class="sxs-lookup"><span data-stu-id="45249-158">A destination, usually a file, document, or URL, is something that can be edited, browsed, viewed, and so on.</span></span> <span data-ttu-id="45249-159">請將目的地視為某件事，而不是動作。</span><span class="sxs-lookup"><span data-stu-id="45249-159">Think of a destination as a thing rather than an action.</span></span> <span data-ttu-id="45249-160">通常，目的地是 Shell 命名空間中的專案，以 [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) 或 [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka)表示。</span><span class="sxs-lookup"><span data-stu-id="45249-160">Typically, a destination is an item in the Shell namespace, represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) or [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka).</span></span> <span data-ttu-id="45249-161">目的地清單的這些部分類似于 [ **開始** ] 功能表的 [最近使用的檔] 清單 (預設不會再顯示) 和常用的應用程式清單，但它們是應用程式特有的，因此更準確且更適合使用者使用。</span><span class="sxs-lookup"><span data-stu-id="45249-161">These portions of the destination list are analogous to the **Start** menu's recently used documents list (no longer shown by default) and frequently used application list, but they are specific to an application and therefore more accurate and useful to the user.</span></span> <span data-ttu-id="45249-162">目的地清單中使用的結果是透過呼叫 [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)來計算。</span><span class="sxs-lookup"><span data-stu-id="45249-162">The results used in the destination list are calculated through calls to [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="45249-163">請注意，當使用者從 Windows 檔案總管開啟檔案，或使用 [一般檔案] 對話方塊來開啟、儲存或建立檔案時，系統會自動為您呼叫 **SHAddToRecentDocs** ，這會導致許多應用程式取得目的地清單中顯示的最新專案，而不會有任何動作。</span><span class="sxs-lookup"><span data-stu-id="45249-163">Note that when the user opens a file from Windows Explorer or uses the common file dialog to open, save, or create a file, **SHAddToRecentDocs** is called for you automatically, which results in many applications getting their recent items shown in the destination list without any action on their part.</span></span>

<span data-ttu-id="45249-164">啟動目的地就像使用 [ **開啟方式** ] 命令來啟動專案一樣。</span><span class="sxs-lookup"><span data-stu-id="45249-164">Launching a destination is much like launching an item using the **Open With** command.</span></span> <span data-ttu-id="45249-165">應用程式隨即啟動，且該目的地已載入並準備就緒可供使用。</span><span class="sxs-lookup"><span data-stu-id="45249-165">The application launches with that destination loaded and ready to use.</span></span> <span data-ttu-id="45249-166">目的地清單中的專案也可以從清單拖曳至放置目的地，例如電子郵件訊息。</span><span class="sxs-lookup"><span data-stu-id="45249-166">Items in the destination list can also be dragged from the list to a drop destination such as an email message.</span></span> <span data-ttu-id="45249-167">藉由將這些專案集中在目的地清單中，就能讓使用者以較快的速度執行，也就是目標。</span><span class="sxs-lookup"><span data-stu-id="45249-167">By having these items centralized in a destination list, it gets users where they want to go that much faster, which is the goal.</span></span>

<span data-ttu-id="45249-168">當專案出現在 [最近] 清單中的 [ **最近** ] 類別 (或 [ **常用** ] 分類或 [自訂類別](#customizing-jump-lists) 時，) 稍後章節中所討論的專案，使用者可能會想要確保專案一律在清單中，以供快速存取。</span><span class="sxs-lookup"><span data-stu-id="45249-168">As items appear in a destination list's **Recent** category (or the **Frequent** category or a [custom category](#customizing-jump-lists) as discussed in a later section), a user might want to ensure that the item is always in the list for quick access.</span></span> <span data-ttu-id="45249-169">若要完成這項工作，可以將該專案釘選到清單，將專案加入至已 **釘** 選的類別。</span><span class="sxs-lookup"><span data-stu-id="45249-169">To accomplish this, he or she can pin that item to the list, which adds the item to the **Pinned** category.</span></span> <span data-ttu-id="45249-170">當使用者主動使用目的地時，他或她希望能夠輕鬆地將它釘選到應用程式的目的地清單。</span><span class="sxs-lookup"><span data-stu-id="45249-170">When a user is actively working with a destination, he or she wants it easily at hand and so would pin it to the application's destination list.</span></span> <span data-ttu-id="45249-171">在使用者完成工作之後，他或她只是取消固定專案。</span><span class="sxs-lookup"><span data-stu-id="45249-171">After the user's work there is done, he or she simply unpins the item.</span></span> <span data-ttu-id="45249-172">此使用者控制項可讓清單保持整齊且相關。</span><span class="sxs-lookup"><span data-stu-id="45249-172">This user control keeps the list uncluttered and relevant.</span></span>

<span data-ttu-id="45249-173">目的地清單可視為應用程式特定版本的 [ **開始** ] 功能表。</span><span class="sxs-lookup"><span data-stu-id="45249-173">A destination list can be regarded as an application-specific version of the **Start** menu.</span></span> <span data-ttu-id="45249-174">目的地清單不是快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="45249-174">A destination list is not a shortcut menu.</span></span> <span data-ttu-id="45249-175">目的地清單中的每個專案都可以用滑鼠右鍵按一下它自己的快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="45249-175">Each item in a destination list can be right-clicked for its own shortcut menu.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-176">API</span><span class="sxs-lookup"><span data-stu-id="45249-176">APIs</span></span>

-   [<span data-ttu-id="45249-177">**IApplicationDestinations::RemoveDestination**</span><span class="sxs-lookup"><span data-stu-id="45249-177">**IApplicationDestinations::RemoveDestination**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iapplicationdestinations-removedestination)
-   [<span data-ttu-id="45249-178">**IApplicationDestinations::RemoveAllDestinations**</span><span class="sxs-lookup"><span data-stu-id="45249-178">**IApplicationDestinations::RemoveAllDestinations**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iapplicationdestinations-removealldestinations)
-   [<span data-ttu-id="45249-179">**IApplicationDocumentLists::GetList**</span><span class="sxs-lookup"><span data-stu-id="45249-179">**IApplicationDocumentLists::GetList**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iapplicationdocumentlists-getlist)
-   [<span data-ttu-id="45249-180">**SHAddToRecentDocs**</span><span class="sxs-lookup"><span data-stu-id="45249-180">**SHAddToRecentDocs**</span></span>](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)

## <a name="tasks"></a><span data-ttu-id="45249-181">工作</span><span class="sxs-lookup"><span data-stu-id="45249-181">Tasks</span></span>

<span data-ttu-id="45249-182">捷徑清單的另一個內建部分 **是 [工作** ] 類別。</span><span class="sxs-lookup"><span data-stu-id="45249-182">Another built-in portion of a Jump List is the **Tasks** category.</span></span> <span data-ttu-id="45249-183">雖然目的地是一件事，但是工作是一項動作，而在此情況下，它是應用程式特定的動作。</span><span class="sxs-lookup"><span data-stu-id="45249-183">While a destination is a thing, a task is an action, and in this case it is an application-specific action.</span></span> <span data-ttu-id="45249-184">以另一種方式，目的地是名詞，而工作則是動詞。</span><span class="sxs-lookup"><span data-stu-id="45249-184">Put another way, a destination is a noun and a task is a verb.</span></span> <span data-ttu-id="45249-185">一般情況下，工作是具有命令列引數的 [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) 專案，表示應用程式可以觸發的特定功能。</span><span class="sxs-lookup"><span data-stu-id="45249-185">Typically, tasks are [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) items with command-line arguments that indicate particular functionality that can be triggered by an application.</span></span> <span data-ttu-id="45249-186">同樣地，概念是盡可能將與應用程式相關的資訊集中在一起。</span><span class="sxs-lookup"><span data-stu-id="45249-186">Again, the idea is to centralize as much information related to an application as is practical.</span></span>

<span data-ttu-id="45249-187">應用程式會根據程式的功能以及使用者預期使用的重要事項來定義工作。</span><span class="sxs-lookup"><span data-stu-id="45249-187">Applications define tasks based on both the program's features and the key things a user is expected to do with them.</span></span> <span data-ttu-id="45249-188">工作應該是無內容的，因為應用程式不需要執行，就能運作。</span><span class="sxs-lookup"><span data-stu-id="45249-188">Tasks should be context-free, in that the application does not need to be running for them to work.</span></span> <span data-ttu-id="45249-189">它們也應該是一般使用者在應用程式中執行的統計最常見動作，例如撰寫電子郵件訊息或在郵件程式中開啟行事曆、在文字處理器中建立新檔、在特定模式中啟動應用程式，或啟動其中一個子命令。</span><span class="sxs-lookup"><span data-stu-id="45249-189">They should also be the statistically most common actions that a normal user would perform in an application, such as compose an email message or open the calendar in a mail program, create a new document in a word processor, launch an application in a certain mode, or launch one of its subcommands.</span></span> <span data-ttu-id="45249-190">應用程式應該不會讓功能表與標準使用者不需要或單次動作（例如註冊）的先進功能產生混亂。</span><span class="sxs-lookup"><span data-stu-id="45249-190">An application should not clutter the menu with advanced features that standard users won't need or one-time actions such as registration.</span></span> <span data-ttu-id="45249-191">請勿將工作用於促銷專案，例如升級或特殊優惠。</span><span class="sxs-lookup"><span data-stu-id="45249-191">Do not use tasks for promotional items such as upgrades or special offers.</span></span>

<span data-ttu-id="45249-192">強烈建議工作清單是靜態的。</span><span class="sxs-lookup"><span data-stu-id="45249-192">It is strongly recommended that the task list be static.</span></span> <span data-ttu-id="45249-193">無論應用程式的狀態或狀態為何，都應該維持不變。</span><span class="sxs-lookup"><span data-stu-id="45249-193">It should remain the same regardless of the state or status of the application.</span></span> <span data-ttu-id="45249-194">雖然您可以動態地變更清單，但您應該考慮這樣做可能會讓不希望目的清單的部分變更的使用者混淆。</span><span class="sxs-lookup"><span data-stu-id="45249-194">While it is possible to vary the list dynamically, you should consider that this could confuse the user who does not expect that portion of the destination list to change.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-195">API</span><span class="sxs-lookup"><span data-stu-id="45249-195">APIs</span></span>

-   [<span data-ttu-id="45249-196">**ICustomDestinationList::AddUserTasks**</span><span class="sxs-lookup"><span data-stu-id="45249-196">**ICustomDestinationList::AddUserTasks**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icustomdestinationlist-addusertasks)

## <a name="customizing-jump-lists"></a><span data-ttu-id="45249-197">自訂跳躍清單</span><span class="sxs-lookup"><span data-stu-id="45249-197">Customizing Jump Lists</span></span>

<span data-ttu-id="45249-198">應用程式可以定義自己的類別，並在捷徑清單中新增或取代標準 **最新** 且 **經常** 分類的類別。</span><span class="sxs-lookup"><span data-stu-id="45249-198">An application can define its own categories and add them in addition to or in place of the standard **Recent** and **Frequent** categories in a Jump List.</span></span> <span data-ttu-id="45249-199">應用程式可以根據應用程式的架構和預定用途，在這些自訂類別中控制自己的目的地。</span><span class="sxs-lookup"><span data-stu-id="45249-199">The application can control its own destinations in those custom categories based on the application's architecture and intended use.</span></span> <span data-ttu-id="45249-200">下列螢幕擷取畫面顯示具有歷程記錄類別的自訂捷徑清單。</span><span class="sxs-lookup"><span data-stu-id="45249-200">The following screen shot shows a Custom Jump List with a History category.</span></span>

![自訂跳躍清單](images/taskbar/customjumplist.png)

<span data-ttu-id="45249-202">如果應用程式決定提供自訂類別，則該應用程式會負責填入它。</span><span class="sxs-lookup"><span data-stu-id="45249-202">If an application decides to provide a custom category, that application assumes responsibility for populating it.</span></span> <span data-ttu-id="45249-203">類別目錄內容仍然應該是使用者特定的，而且會根據使用者的歷程記錄、動作或兩者，但透過自訂類別，應用程式可以決定要追蹤的內容，以及它想要忽略的內容（也許是根據應用程式選項）。</span><span class="sxs-lookup"><span data-stu-id="45249-203">The category contents should still be user-specific and based on user history, actions, or both, but through a custom category an application can determine what it wants to track and what it wants to ignore, perhaps based on an application option.</span></span> <span data-ttu-id="45249-204">例如，音訊程式可能會選擇只包含最近播放的專輯，並忽略最近播放的個別曲目。</span><span class="sxs-lookup"><span data-stu-id="45249-204">For example, an audio program might elect to include only recently played albums and ignore recently played individual tracks.</span></span>

<span data-ttu-id="45249-205">如果使用者已從清單中移除專案，這一律是使用者選項，則應用程式必須接受該專案。</span><span class="sxs-lookup"><span data-stu-id="45249-205">If a user has removed an item from the list, which is always a user option, the application must honor that.</span></span> <span data-ttu-id="45249-206">應用程式也必須確保清單中的專案有效，或如果已刪除，則會正常地失敗。</span><span class="sxs-lookup"><span data-stu-id="45249-206">The application must also ensure that items in the list are valid or that they fail gracefully if they have been deleted.</span></span> <span data-ttu-id="45249-207">您可以透過程式設計方式移除個別專案或清單的整個內容。</span><span class="sxs-lookup"><span data-stu-id="45249-207">Individual items or the entire contents of the list can be programmatically removed.</span></span>

<span data-ttu-id="45249-208">目的地清單中的專案數目上限是由系統根據各種因素（例如顯示解析度和字型大小）來決定。</span><span class="sxs-lookup"><span data-stu-id="45249-208">The maximum number of items in a destination list is determined by the system based on various factors such as display resolution and font size.</span></span> <span data-ttu-id="45249-209">如果沒有足夠的空間可容納所有類別目錄中的所有專案，則會從底部截斷。</span><span class="sxs-lookup"><span data-stu-id="45249-209">If there isn't space enough for all items in all categories, they are truncated from the bottom up.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-210">API</span><span class="sxs-lookup"><span data-stu-id="45249-210">APIs</span></span>

-   [<span data-ttu-id="45249-211">**ICustomDestinationList**</span><span class="sxs-lookup"><span data-stu-id="45249-211">**ICustomDestinationList**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist)
-   [<span data-ttu-id="45249-212">**IApplicationDestinations**</span><span class="sxs-lookup"><span data-stu-id="45249-212">**IApplicationDestinations**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdestinations)
-   [<span data-ttu-id="45249-213">**IApplicationDocumentLists**</span><span class="sxs-lookup"><span data-stu-id="45249-213">**IApplicationDocumentLists**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdocumentlists)

## <a name="thumbnail-toolbars"></a><span data-ttu-id="45249-214">縮圖工具列</span><span class="sxs-lookup"><span data-stu-id="45249-214">Thumbnail Toolbars</span></span>

<span data-ttu-id="45249-215">若要在不讓使用者還原或啟動應用程式視窗的情況下，提供特定視窗主要命令的存取權，您可以將現用的工具列控制項內嵌在該視窗的縮圖預覽中。</span><span class="sxs-lookup"><span data-stu-id="45249-215">To provide access to a particular window's key commands without making the user restore or activate the application's window, an active toolbar control can be embedded in that window's thumbnail preview.</span></span> <span data-ttu-id="45249-216">例如，Windows Media Player 可能會提供標準媒體傳輸控制項，例如播放、暫停、靜音及停止。</span><span class="sxs-lookup"><span data-stu-id="45249-216">For example, Windows Media Player might offer standard media transport controls such as play, pause, mute, and stop.</span></span> <span data-ttu-id="45249-217">UI 會在縮圖正下方顯示此工具列，如下圖所示，它並不涵蓋任何部分。</span><span class="sxs-lookup"><span data-stu-id="45249-217">The UI displays this toolbar directly below the thumbnail as shown in the following illustration—it does not cover any part of it.</span></span>

![windows media player 的縮圖工作列，具有三個按鈕： [上一頁]、[播放] 和 [轉寄]](images/taskbar/thumbbar.png)

<span data-ttu-id="45249-219">這個工具列只是熟悉的標準工具列通用控制項。</span><span class="sxs-lookup"><span data-stu-id="45249-219">This toolbar is simply the familiar standard toolbar common control.</span></span> <span data-ttu-id="45249-220">最多有七個按鈕。</span><span class="sxs-lookup"><span data-stu-id="45249-220">It has a maximum of seven buttons.</span></span> <span data-ttu-id="45249-221">每個按鈕的識別碼、影像、工具提示和狀態都是在結構中定義，然後再傳遞至工作列。</span><span class="sxs-lookup"><span data-stu-id="45249-221">Each button's ID, image, tooltip, and state are defined in a structure, which is then passed to the taskbar.</span></span> <span data-ttu-id="45249-222">應用程式可以顯示、啟用、停用或隱藏縮圖工具列上的按鈕，如其目前的狀態所要求。</span><span class="sxs-lookup"><span data-stu-id="45249-222">The application can show, enable, disable, or hide buttons from the thumbnail toolbar as required by its current state.</span></span>

<span data-ttu-id="45249-223">因為顯示縮圖的空間有限，以及要顯示的可變動縮圖數目，所以不保證應用程式具有指定的工具列大小。</span><span class="sxs-lookup"><span data-stu-id="45249-223">Because there is limited room to display thumbnails and a variable number of thumbnails to display, applications are not guaranteed a given toolbar size.</span></span> <span data-ttu-id="45249-224">如果空間有限，工具列中的按鈕會由右至左截斷。</span><span class="sxs-lookup"><span data-stu-id="45249-224">If space is restricted, buttons in the toolbar are truncated from right to left.</span></span> <span data-ttu-id="45249-225">因此，當您設計工具列時，您應該設定與按鈕相關聯之命令的優先順序，並確保最重要的是最重要的，而且最不可能因為空間問題而卸載。</span><span class="sxs-lookup"><span data-stu-id="45249-225">Therefore, when you design your toolbar, you should prioritize the commands associated with your buttons and ensure that the most important come first and are least likely to be dropped because of space issues.</span></span>

> [!Note]  
> <span data-ttu-id="45249-226">當應用程式顯示視窗時，系統會建立其工作列按鈕。</span><span class="sxs-lookup"><span data-stu-id="45249-226">When an application displays a window, its taskbar button is created by the system.</span></span> <span data-ttu-id="45249-227">當按鈕已就緒時，工作列會將 **TaskbarButtonCreated** 訊息傳送至視窗。</span><span class="sxs-lookup"><span data-stu-id="45249-227">When the button is in place, the taskbar sends a **TaskbarButtonCreated** message to the window.</span></span> <span data-ttu-id="45249-228">其值是藉由呼叫 [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) (L ( "TaskbarButtonCreated" ) ) 來計算。</span><span class="sxs-lookup"><span data-stu-id="45249-228">Its value is computed by calling [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea)(L("TaskbarButtonCreated")).</span></span> <span data-ttu-id="45249-229">在呼叫任何 [**ITaskbarList3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist3) 方法之前，您的應用程式必須先接收該訊息。</span><span class="sxs-lookup"><span data-stu-id="45249-229">That message must be received by your application before it calls any [**ITaskbarList3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist3) method.</span></span>

 

### <a name="api"></a><span data-ttu-id="45249-230">API</span><span class="sxs-lookup"><span data-stu-id="45249-230">API</span></span>

-   [<span data-ttu-id="45249-231">**ITaskbarList3::ThumbBarAddButtons**</span><span class="sxs-lookup"><span data-stu-id="45249-231">**ITaskbarList3::ThumbBarAddButtons**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-thumbbaraddbuttons)
-   [<span data-ttu-id="45249-232">**ITaskbarList3::ThumbBarSetImageList**</span><span class="sxs-lookup"><span data-stu-id="45249-232">**ITaskbarList3::ThumbBarSetImageList**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-thumbbarsetimagelist)
-   [<span data-ttu-id="45249-233">**ITaskbarList3::ThumbBarUpdateButtons**</span><span class="sxs-lookup"><span data-stu-id="45249-233">**ITaskbarList3::ThumbBarUpdateButtons**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-thumbbarupdatebuttons)
-   [<span data-ttu-id="45249-234">**THUMBBUTTON**</span><span class="sxs-lookup"><span data-stu-id="45249-234">**THUMBBUTTON**</span></span>](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-thumbbutton)

## <a name="icon-overlays"></a><span data-ttu-id="45249-235">圖示重迭</span><span class="sxs-lookup"><span data-stu-id="45249-235">Icon Overlays</span></span>

<span data-ttu-id="45249-236">應用程式可以透過其工作列按鈕，在按鈕上顯示小重迭，以將特定通知和狀態傳達給使用者。</span><span class="sxs-lookup"><span data-stu-id="45249-236">An application can communicate certain notifications and status to the user through its taskbar button by the display of small overlays on the button.</span></span> <span data-ttu-id="45249-237">這些重迭類似于快速鍵或安全性通知所使用的現有覆迭類型，會顯示在按鈕的右下角。</span><span class="sxs-lookup"><span data-stu-id="45249-237">These overlays are similar to the type of existing overlay used for shortcuts or security notifications, displayed at the lower-right corner of the button.</span></span> <span data-ttu-id="45249-238">若要顯示重迭圖示，工作列必須是預設的大型圖示模式，如下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="45249-238">To display an overlay icon, the taskbar must be in the default large icon mode, as shown in the following screen shot.</span></span>

![具有重迭的 windows messenger 工作列按鈕，表示可用的狀態](images/taskbar/taskbaroverlay.png)

<span data-ttu-id="45249-240">圖示重迭可作為狀態的內容通知，其目的是要讓個別通知區域狀態圖示的需求不會與使用者傳達該資訊。</span><span class="sxs-lookup"><span data-stu-id="45249-240">Icon overlays serve as a contextual notification of status, and are intended to negate the need for a separate notification area status icon to communicate that information to the user.</span></span> <span data-ttu-id="45249-241">例如，目前顯示在通知區域中的 Microsoft Outlook 新郵件狀態，現在可透過工作列按鈕上的重迭來指出。</span><span class="sxs-lookup"><span data-stu-id="45249-241">For instance, the new mail status in Microsoft Outlook, currently shown in the notification area, can now be indicated through an overlay on the taskbar button.</span></span> <span data-ttu-id="45249-242">同樣地，您必須在開發週期中決定哪一個方法最適合您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="45249-242">Again, you must decide during your development cycle which method is best for your application.</span></span> <span data-ttu-id="45249-243">重迭圖示的目的是要提供重要、長期的狀態或通知，例如網路狀態、messenger 狀態或新郵件。</span><span class="sxs-lookup"><span data-stu-id="45249-243">Overlay icons are intended to supply important, long-standing status or notifications such as network status, messenger status, or new mail.</span></span> <span data-ttu-id="45249-244">使用者不應該看到不斷變化的重迭或動畫。</span><span class="sxs-lookup"><span data-stu-id="45249-244">The user should not be presented with constantly changing overlays or animations.</span></span>

<span data-ttu-id="45249-245">由於單一重迭會在工作列按鈕上重迭，而不是在個別視窗縮圖上，因此這是每個群組的功能，而不是每個視窗。</span><span class="sxs-lookup"><span data-stu-id="45249-245">Because a single overlay is overlaid on the taskbar button and not on the individual window thumbnails, this is a per-group feature rather than per-window.</span></span> <span data-ttu-id="45249-246">您可以從工作列群組中的個別視窗接收覆迭圖示的要求，但不會將它們排入佇列。</span><span class="sxs-lookup"><span data-stu-id="45249-246">Requests for overlay icons can be received from individual windows in a taskbar group, but they do not queue.</span></span> <span data-ttu-id="45249-247">最後收到的重迭是所顯示的重迭。</span><span class="sxs-lookup"><span data-stu-id="45249-247">The last overlay received is the overlay shown.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-248">API</span><span class="sxs-lookup"><span data-stu-id="45249-248">APIs</span></span>

-   [<span data-ttu-id="45249-249">**ITaskbarList3::SetOverlayIcon**</span><span class="sxs-lookup"><span data-stu-id="45249-249">**ITaskbarList3::SetOverlayIcon**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-setoverlayicon)

## <a name="progress-bars"></a><span data-ttu-id="45249-250">進度列</span><span class="sxs-lookup"><span data-stu-id="45249-250">Progress Bars</span></span>

<span data-ttu-id="45249-251">工作列按鈕可以用來顯示進度列。</span><span class="sxs-lookup"><span data-stu-id="45249-251">A taskbar button can be used to display a progress bar.</span></span> <span data-ttu-id="45249-252">這可讓視窗提供進度資訊給使用者，使用者不需要切換至視窗本身。</span><span class="sxs-lookup"><span data-stu-id="45249-252">This enables a window to provide progress information to the user without that user having to switch to the window itself.</span></span> <span data-ttu-id="45249-253">使用者可以在另一個應用程式中保持生產力，同時查看在其他視窗中發生的一或多個作業進度。</span><span class="sxs-lookup"><span data-stu-id="45249-253">The user can stay productive in another application while seeing at a glance the progress of one or more operations occurring in other windows.</span></span> <span data-ttu-id="45249-254">它的目的是工作列按鈕的進度列會在視窗本身反映更詳細的進度指標。</span><span class="sxs-lookup"><span data-stu-id="45249-254">It is intended that a progress bar in a taskbar button reflects a more detailed progress indicator in the window itself.</span></span> <span data-ttu-id="45249-255">這項功能可用來追蹤檔案複製、下載、安裝、媒體燒錄或任何即將花費一段時間的作業。</span><span class="sxs-lookup"><span data-stu-id="45249-255">This feature can be used to track file copies, downloads, installations, media burning, or any operation that's going to take a period of time.</span></span> <span data-ttu-id="45249-256">這項功能不適用於一般的周邊動作，例如載入網頁或列印檔案。</span><span class="sxs-lookup"><span data-stu-id="45249-256">This feature is not intended for use with normally peripheral actions such as the loading of a webpage or the printing of a document.</span></span> <span data-ttu-id="45249-257">該進度類型應該會繼續顯示在視窗的狀態列中。</span><span class="sxs-lookup"><span data-stu-id="45249-257">That type of progress should continue to be shown in a window's status bar.</span></span>

<span data-ttu-id="45249-258">工作列按鈕的進度列與熟悉的進度列控制項的體驗類似。</span><span class="sxs-lookup"><span data-stu-id="45249-258">The taskbar button progress bar is a similar experience to the familiar Progress Bar control.</span></span> <span data-ttu-id="45249-259">它可以根據作業的完成百分比顯示確定進度，或使用不定的天棚樣式進度來表示作業正在進行中，而不會有剩餘時間的預測。</span><span class="sxs-lookup"><span data-stu-id="45249-259">It can display either determinate progress based on a completed percentage of the operation or an indeterminate marquee-style progress to indicate that the operation is in progress without any prediction of time remaining.</span></span> <span data-ttu-id="45249-260">它也會顯示作業已暫停或發生錯誤，且需要使用者介入。</span><span class="sxs-lookup"><span data-stu-id="45249-260">It can also show that the operation is paused or has encountered an error and requires user intervention.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-261">API</span><span class="sxs-lookup"><span data-stu-id="45249-261">APIs</span></span>

-   [<span data-ttu-id="45249-262">**ITaskbarList3::SetProgressState**</span><span class="sxs-lookup"><span data-stu-id="45249-262">**ITaskbarList3::SetProgressState**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-setprogressstate)
-   [<span data-ttu-id="45249-263">**ITaskbarList3::SetProgressValue**</span><span class="sxs-lookup"><span data-stu-id="45249-263">**ITaskbarList3::SetProgressValue**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-setprogressvalue)

## <a name="deskbands"></a><span data-ttu-id="45249-264">Deskbands</span><span class="sxs-lookup"><span data-stu-id="45249-264">Deskbands</span></span>

<span data-ttu-id="45249-265">在 Windows 7 之前的 Windows 版本中，與縮圖工具列功能類似的內容，可以透過 deskband （在工作列中裝載的工具列）來達成。</span><span class="sxs-lookup"><span data-stu-id="45249-265">In versions of Windows prior to Windows 7, something similar to thumbnail toolbar functionality could be achieved through a deskband—a toolbar hosted in the taskbar.</span></span> <span data-ttu-id="45249-266">比方說，Windows Media Player 可以將工作列最小化為一組傳輸控制項，而不是標準按鈕。</span><span class="sxs-lookup"><span data-stu-id="45249-266">For instance, Windows Media Player could minimize to the taskbar as a set of transport controls rather than a standard button.</span></span> <span data-ttu-id="45249-267">在 Windows 7 中，仍然可以執行 deskbands，而且縮圖工具列並非全部取代。</span><span class="sxs-lookup"><span data-stu-id="45249-267">In Windows 7, deskbands can still be implemented and thumbnail toolbars are not intended to replace them all.</span></span> <span data-ttu-id="45249-268">並非所有的應用程式都能成為縮圖工具列，而另一個解決方案（例如 deskband 或目的地清單中的工作）可能是您的應用程式的正確答案;您必須決定哪一個解決方案最適合您的應用程式，做為開發週期的一部分。</span><span class="sxs-lookup"><span data-stu-id="45249-268">Not all applications will lend themselves to a thumbnail toolbar, and another solution such as a deskband or a task in a destination list might be the right answer for your application; you must decide which solution works best for your application as part of your development cycle.</span></span> <span data-ttu-id="45249-269">不過，請注意，deskbands 必須支援具有半透明度 ( 「玻璃」 ) 啟用的 Windows Aero 和 [**IDeskBand2**](/windows/desktop/api/Shobjidl/nn-shobjidl-ideskband2) 介面。</span><span class="sxs-lookup"><span data-stu-id="45249-269">However, be aware that deskbands must support Windows Aero with translucency ("glass") enabled and the [**IDeskBand2**](/windows/desktop/api/Shobjidl/nn-shobjidl-ideskband2) interface.</span></span>

### <a name="apis"></a><span data-ttu-id="45249-270">API</span><span class="sxs-lookup"><span data-stu-id="45249-270">APIs</span></span>

-   [<span data-ttu-id="45249-271">**IDeskBand2**</span><span class="sxs-lookup"><span data-stu-id="45249-271">**IDeskBand2**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ideskband2)

## <a name="notification-area"></a><span data-ttu-id="45249-272">通知區域</span><span class="sxs-lookup"><span data-stu-id="45249-272">Notification Area</span></span>

<span data-ttu-id="45249-273">通知區域已有變更，可讓使用者更充分掌控工作列上所顯示的圖示。</span><span class="sxs-lookup"><span data-stu-id="45249-273">There have been changes to the notification area that give the user much more control over what icons appear on the taskbar.</span></span> <span data-ttu-id="45249-274">所有通知圖示現在都會預設為隱藏，而且無法以程式設計方式控制其可見度。</span><span class="sxs-lookup"><span data-stu-id="45249-274">All notification icons are now hidden by default and that visibility cannot be programmatically controlled.</span></span> <span data-ttu-id="45249-275">只有使用者可以選擇要出現在工作列上的通知圖示。</span><span class="sxs-lookup"><span data-stu-id="45249-275">Only the user is allowed to choose which notification icons appear on the taskbar.</span></span> <span data-ttu-id="45249-276">顯示通知氣球時，圖示會暫時顯示出來，但使用者也可以選擇將其解除回應。</span><span class="sxs-lookup"><span data-stu-id="45249-276">When a notification balloon is displayed, the icon becomes temporarily visible, but even then a user can choose to silence them.</span></span> <span data-ttu-id="45249-277">因此，當您想要讓應用程式將該資訊傳達給您的使用者時，工作列按鈕上的圖示重迭會成為很好的選擇。</span><span class="sxs-lookup"><span data-stu-id="45249-277">An icon overlay on a taskbar button therefore becomes an attractive choice when you want your application to communicate that information to your users.</span></span>

## <a name="thumbnails"></a><span data-ttu-id="45249-278">縮圖</span><span class="sxs-lookup"><span data-stu-id="45249-278">Thumbnails</span></span>

<span data-ttu-id="45249-279">在 Windows Vista 中，將滑鼠停留在應用程式的工作列按鈕上，會顯示表示執行中視窗的縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-279">In Windows Vista, hovering over an application's taskbar button displays a thumbnail that represents the running window.</span></span> <span data-ttu-id="45249-280">如果工作列已折迭應用程式的視窗，縮圖會顯示為堆疊來呈現，但縮圖本身只會顯示使用中視窗。</span><span class="sxs-lookup"><span data-stu-id="45249-280">If the taskbar has collapsed the application's windows, the thumbnail represents this by appearing as a stack, but only the active window is shown in the thumbnail itself.</span></span>

<span data-ttu-id="45249-281">在 Windows 7 中，群組的每個成員都會顯示為個別的縮圖，而且現在也是切換目標。</span><span class="sxs-lookup"><span data-stu-id="45249-281">In Windows 7, each member of a group is shown as a separate thumbnail and is now also a switch target.</span></span> <span data-ttu-id="45249-282">應用程式可以定義其子系 (例如真正的子視窗、個別檔或索引標籤) 並且針對每個視窗提供相對應的縮圖，即使它們通常不會出現在工作列中。</span><span class="sxs-lookup"><span data-stu-id="45249-282">An application can define its children (such as true child windows, individual documents, or tabs) and provide corresponding thumbnails for each of those windows even when they would not normally appear in the taskbar.</span></span> <span data-ttu-id="45249-283">這可讓使用者直接切換到他們想要的應用程式，而不是切換至應用程式，然後切換到其目的地。</span><span class="sxs-lookup"><span data-stu-id="45249-283">This enables users to switch directly into the view of the application that they want rather than switching into the application and then switching to their destination.</span></span> <span data-ttu-id="45249-284">例如，多重文件介面 (MDI) /tabbed-document 介面 (TDI) 應用程式可讓每個檔或索引標籤顯示為個別的縮圖，並在滑鼠停留在群組的工作列按鈕時切換目標。</span><span class="sxs-lookup"><span data-stu-id="45249-284">For example, multiple-document interface (MDI)/tabbed-document interface (TDI)applications can have each document or tab displayed as a separate thumbnail and switch target when the mouse hovers over a group's taskbar button.</span></span>

![代表 windows internet explorer 中個別索引標籤的三個工作列縮圖](images/taskbar/taskbarthumbnails.png)

> [!Note]  
> <span data-ttu-id="45249-286">在 Windows Vista 中，Aero 必須為作用中，才能查看縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-286">As in Windows Vista, Aero must be active to view thumbnails.</span></span>

 

### <a name="api"></a><span data-ttu-id="45249-287">API</span><span class="sxs-lookup"><span data-stu-id="45249-287">API</span></span>

-   [<span data-ttu-id="45249-288">**ITaskbarList3::RegisterTab**</span><span class="sxs-lookup"><span data-stu-id="45249-288">**ITaskbarList3::RegisterTab**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-registertab)
-   [<span data-ttu-id="45249-289">**ITaskbarList3::SetTabActive**</span><span class="sxs-lookup"><span data-stu-id="45249-289">**ITaskbarList3::SetTabActive**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-settabactive)
-   [<span data-ttu-id="45249-290">**ITaskbarList3::SetTabOrder**</span><span class="sxs-lookup"><span data-stu-id="45249-290">**ITaskbarList3::SetTabOrder**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-settaborder)
-   [<span data-ttu-id="45249-291">**ITaskbarList3::UnregisterTab**</span><span class="sxs-lookup"><span data-stu-id="45249-291">**ITaskbarList3::UnregisterTab**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-unregistertab)
-   [<span data-ttu-id="45249-292">**ITaskbarList4::SetTabProperties**</span><span class="sxs-lookup"><span data-stu-id="45249-292">**ITaskbarList4::SetTabProperties**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist4-settabproperties)

<span data-ttu-id="45249-293">Windows 的縮圖表示通常是自動的，但在結果不是最佳的情況下，可以明確指定縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-293">Thumbnail representations for windows are normally automatic, but in cases where the result isn't optimal, the thumbnail can be explicitly specified.</span></span> <span data-ttu-id="45249-294">依預設，只有最上層視窗會自動產生縮圖，而子視窗的縮圖會顯示為一般標記法。</span><span class="sxs-lookup"><span data-stu-id="45249-294">By default, only top-level windows have a thumbnail automatically generated for them, and the thumbnails for child windows appear as a generic representation.</span></span> <span data-ttu-id="45249-295">這可能會導致不理想的 (，甚至讓終端使用者的) 體驗感到混淆。</span><span class="sxs-lookup"><span data-stu-id="45249-295">This can result in a less than ideal (and even confusing) experience for the end user.</span></span> <span data-ttu-id="45249-296">例如，每一個子視窗的特定切換目標縮圖，可提供更好的使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="45249-296">A specific switch target thumbnail for each child window, for instance, provides a much better user experience.</span></span>

### <a name="api"></a><span data-ttu-id="45249-297">API</span><span class="sxs-lookup"><span data-stu-id="45249-297">API</span></span>

-   [<span data-ttu-id="45249-298">**DwmSetWindowAttribute**</span><span class="sxs-lookup"><span data-stu-id="45249-298">**DwmSetWindowAttribute**</span></span>](/windows/win32/api/dwmapi/nf-dwmapi-dwmsetwindowattribute)
-   [<span data-ttu-id="45249-299">**DwmSetIconicThumbnail**</span><span class="sxs-lookup"><span data-stu-id="45249-299">**DwmSetIconicThumbnail**</span></span>](/windows/win32/api/dwmapi/nf-dwmapi-dwmseticonicthumbnail)
-   [<span data-ttu-id="45249-300">**DwmSetIconicLivePreviewBitmap**</span><span class="sxs-lookup"><span data-stu-id="45249-300">**DwmSetIconicLivePreviewBitmap**</span></span>](/windows/win32/api/dwmapi/nf-dwmapi-dwmseticoniclivepreviewbitmap)
-   [<span data-ttu-id="45249-301">**DwmInvalidateIconicBitmaps**</span><span class="sxs-lookup"><span data-stu-id="45249-301">**DwmInvalidateIconicBitmaps**</span></span>](/windows/win32/api/dwmapi/nf-dwmapi-dwminvalidateiconicbitmaps)
-   [<span data-ttu-id="45249-302">**WM \_ DWMSENDICONICTHUMBNAIL**</span><span class="sxs-lookup"><span data-stu-id="45249-302">**WM\_DWMSENDICONICTHUMBNAIL**</span></span>](../dwm/wm-dwmsendiconicthumbnail.md)
-   [<span data-ttu-id="45249-303">**WM \_ DWMSENDICONICLIVEPREVIEWBITMAP**</span><span class="sxs-lookup"><span data-stu-id="45249-303">**WM\_DWMSENDICONICLIVEPREVIEWBITMAP**</span></span>](../dwm/wm-dwmsendiconiclivepreviewbitmap.md)

<span data-ttu-id="45249-304">您可以選取視窗的特定區域以做為縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-304">You can select a particular area of the window to use as the thumbnail.</span></span> <span data-ttu-id="45249-305">當應用程式知道其檔或索引標籤在縮圖大小觀看時看起來很類似時，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="45249-305">This can be useful when an application knows that its documents or tabs will appear similar when viewed at thumbnail size.</span></span> <span data-ttu-id="45249-306">然後，應用程式可以選擇只顯示其工作區的一部分，讓使用者可以用來區分縮圖。</span><span class="sxs-lookup"><span data-stu-id="45249-306">The application can then choose to show just the part of its client area that the user can use to distinguish between thumbnails.</span></span> <span data-ttu-id="45249-307">不過，將滑鼠游標停留在任何縮圖上，會顯示其背後的完整視窗，讓使用者也可以快速流覽它們。</span><span class="sxs-lookup"><span data-stu-id="45249-307">However, hovering over any thumbnail brings up a view of the full window behind it so the user can quickly glance through them as well.</span></span>

<span data-ttu-id="45249-308">如果縮圖超過可顯示的數目，則預覽會還原為舊版的縮圖或標準圖示。</span><span class="sxs-lookup"><span data-stu-id="45249-308">If there are more thumbnails than can be displayed, the preview reverts to the legacy thumbnail or a standard icon.</span></span>

### <a name="api"></a><span data-ttu-id="45249-309">API</span><span class="sxs-lookup"><span data-stu-id="45249-309">API</span></span>

-   [<span data-ttu-id="45249-310">**ITaskbarList3::SetThumbnailClip**</span><span class="sxs-lookup"><span data-stu-id="45249-310">**ITaskbarList3::SetThumbnailClip**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist3-setthumbnailclip)

<span data-ttu-id="45249-311">若要將 [ **釘選到工作列** ] 新增至專案的快捷方式功能表（通常只需要包含 [IsShortCut](./links.md) 專案的檔案類型），請註冊適當的內容功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="45249-311">To add **Pin to Taskbar** to an item's shortcut menu, which is normally required only for file types that include the [IsShortCut](./links.md) entry, is done by registering the appropriate context menu handler.</span></span> <span data-ttu-id="45249-312">這也適用于 [ **釘選到開始] 功能表**。</span><span class="sxs-lookup"><span data-stu-id="45249-312">This also applies to **Pin to Start Menu**.</span></span> <span data-ttu-id="45249-313">如需詳細資訊，請參閱 [註冊 Shell 延伸模組處理常式](reg-shell-exts.md) 。</span><span class="sxs-lookup"><span data-stu-id="45249-313">See [Registering Shell Extension Handlers](reg-shell-exts.md) for more information.</span></span>

## <a name="related-topics"></a><span data-ttu-id="45249-314">相關主題</span><span class="sxs-lookup"><span data-stu-id="45249-314">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45249-315">工作列</span><span class="sxs-lookup"><span data-stu-id="45249-315">The Taskbar</span></span>](taskbar.md)
</dt> <dt>

[<span data-ttu-id="45249-316">應用程式使用者模型識別碼 (AppUserModelIDs) </span><span class="sxs-lookup"><span data-stu-id="45249-316">Application User Model IDs (AppUserModelIDs)</span></span>](appids.md)
</dt> <dt>

[<span data-ttu-id="45249-317">通知和通知區域</span><span class="sxs-lookup"><span data-stu-id="45249-317">Notifications and the Notification Area</span></span>](notification-area.md)
</dt> </dl>

 

 
