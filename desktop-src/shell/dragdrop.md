---
description: 許多應用程式可讓使用者透過滑鼠拖放資料，或使用剪貼簿來將資料傳送至另一個應用程式。
title: 使用拖放和剪貼簿傳送 Shell 物件
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104973245"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="db940-103">使用拖放和剪貼簿傳送 Shell 物件</span><span class="sxs-lookup"><span data-stu-id="db940-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="db940-104">許多應用程式可讓使用者透過滑鼠拖放資料，或使用剪貼簿來將資料傳送至另一個應用程式。</span><span class="sxs-lookup"><span data-stu-id="db940-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="db940-105">可以傳送的許多資料類型都是 Shell 物件（例如檔案或資料夾）。</span><span class="sxs-lookup"><span data-stu-id="db940-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="db940-106">Shell 資料傳輸可以在兩個應用程式之間進行，但是使用者也可以在桌面或 Windows 檔案總管之間傳送 Shell 資料。</span><span class="sxs-lookup"><span data-stu-id="db940-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="db940-107">雖然檔案是最常傳送的 Shell 物件，但 Shell 資料傳輸可能牽涉到在 [Shell 命名空間](namespace-intro.md)中找到的各種物件。</span><span class="sxs-lookup"><span data-stu-id="db940-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="db940-108">比方說，您的應用程式可能需要將檔案傳送到虛擬資料夾，例如資源回收筒，或接受來自非 Microsoft 命名空間延伸模組的物件。</span><span class="sxs-lookup"><span data-stu-id="db940-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="db940-109">如果您正在執行命名空間延伸，它必須能夠正確地做為卸載來源和目標。</span><span class="sxs-lookup"><span data-stu-id="db940-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="db940-110">本檔討論應用程式如何使用 Shell 物件來執行拖放和剪貼簿的資料傳輸。</span><span class="sxs-lookup"><span data-stu-id="db940-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="db940-111">Shell 資料物件</span><span class="sxs-lookup"><span data-stu-id="db940-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="db940-112">Shell 剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="db940-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="db940-113">處理命令介面資料傳輸案例</span><span class="sxs-lookup"><span data-stu-id="db940-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="db940-114">拖放如何搭配 Shell 物件運作</span><span class="sxs-lookup"><span data-stu-id="db940-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="db940-115">應用程式通常需要為使用者提供傳輸 Shell 資料的方式。</span><span class="sxs-lookup"><span data-stu-id="db940-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="db940-116">部分範例如下：</span><span class="sxs-lookup"><span data-stu-id="db940-116">Some examples are:</span></span>

-   <span data-ttu-id="db940-117">從 Windows 檔案總管或桌面拖曳檔案，然後將它放在應用程式上。</span><span class="sxs-lookup"><span data-stu-id="db940-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="db940-118">將檔案複製到 Windows 檔案總管中的剪貼簿，然後貼入應用程式。</span><span class="sxs-lookup"><span data-stu-id="db940-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="db940-119">將檔從應用程式拖曳至資源回收筒。</span><span class="sxs-lookup"><span data-stu-id="db940-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="db940-120">如需如何處理這些和其他案例的詳細討論，請參閱 [處理 Shell 資料傳輸案例](datascenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="db940-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="db940-121">本檔著重于 Shell 資料傳輸背後的一般原則。</span><span class="sxs-lookup"><span data-stu-id="db940-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="db940-122">Windows 提供兩種可讓應用程式傳輸 Shell 資料的標準方式：</span><span class="sxs-lookup"><span data-stu-id="db940-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="db940-123">使用者將 Shell 資料（例如一或多個檔案）剪下或複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="db940-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="db940-124">另一個應用程式會從剪貼簿抓取資料。</span><span class="sxs-lookup"><span data-stu-id="db940-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="db940-125">使用者將代表來源應用程式之資料的圖示拖曳至目標，並將該圖示放置在目標所擁有的視窗。</span><span class="sxs-lookup"><span data-stu-id="db940-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="db940-126">在這兩種情況下，傳送的資料都會包含在 *資料物件* 中。</span><span class="sxs-lookup"><span data-stu-id="db940-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="db940-127">資料物件是元件物件模型 (COM) 物件，這些物件會公開 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面。</span><span class="sxs-lookup"><span data-stu-id="db940-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="db940-128">架構上，所有 Shell 資料傳輸必須遵循三個基本步驟：</span><span class="sxs-lookup"><span data-stu-id="db940-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="db940-129">來源會建立資料物件，代表要傳送的資料。</span><span class="sxs-lookup"><span data-stu-id="db940-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="db940-130">目標會接收資料物件之 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="db940-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="db940-131">目標會呼叫 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面來將資料解壓縮。</span><span class="sxs-lookup"><span data-stu-id="db940-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="db940-132">剪貼簿與拖放資料傳輸之間的差異，主要在於將 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 指標從來源傳送到目標的方式。</span><span class="sxs-lookup"><span data-stu-id="db940-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="db940-133">剪貼簿資料傳輸</span><span class="sxs-lookup"><span data-stu-id="db940-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="db940-134">剪貼簿是傳輸 Shell 資料最簡單的方法。</span><span class="sxs-lookup"><span data-stu-id="db940-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="db940-135">基本程式類似于標準剪貼簿資料傳輸。</span><span class="sxs-lookup"><span data-stu-id="db940-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="db940-136">不過，因為您要傳送資料物件的指標，而不是資料本身，所以您必須使用 OLE 剪貼簿 API，而不是標準剪貼簿 API。</span><span class="sxs-lookup"><span data-stu-id="db940-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="db940-137">下列程式概述如何使用 OLE 剪貼簿 API 來傳送 Shell 資料與剪貼簿：</span><span class="sxs-lookup"><span data-stu-id="db940-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="db940-138">資料來源會建立包含資料的資料物件。</span><span class="sxs-lookup"><span data-stu-id="db940-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="db940-139">資料來源會呼叫 [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard)，將資料物件的 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面指標放置在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="db940-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="db940-140">目標會呼叫 [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) ，以抓取資料物件的 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="db940-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="db940-141">目標會藉由呼叫 [**IDataObject：：：：（**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) ）方法來將資料解壓縮。</span><span class="sxs-lookup"><span data-stu-id="db940-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="db940-142">使用某些 Shell 資料傳輸時，目標可能也需要呼叫資料物件的 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) 方法，以提供資料傳輸結果的意見反應給資料物件。</span><span class="sxs-lookup"><span data-stu-id="db940-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="db940-143">如需這類作業的範例，請參閱 [處理優化的移動作業](datascenarios.md) 。</span><span class="sxs-lookup"><span data-stu-id="db940-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="db940-144">拖放資料傳輸</span><span class="sxs-lookup"><span data-stu-id="db940-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="db940-145">更複雜的做法是，拖放資料傳輸在剪貼簿中有一些重要的優點：</span><span class="sxs-lookup"><span data-stu-id="db940-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="db940-146">拖放傳輸可以透過簡單的滑鼠移動來完成，讓作業更具彈性且直覺地使用於剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="db940-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="db940-147">拖放可為使用者提供操作的視覺標記法。</span><span class="sxs-lookup"><span data-stu-id="db940-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="db940-148">使用者可以在從來源移至目標時追蹤圖示。</span><span class="sxs-lookup"><span data-stu-id="db940-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="db940-149">當資料可供使用時，拖放會通知目標。</span><span class="sxs-lookup"><span data-stu-id="db940-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="db940-150">拖放作業也會使用資料物件來傳送資料。</span><span class="sxs-lookup"><span data-stu-id="db940-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="db940-151">不過，卸載來源必須提供剪貼簿傳送所需的功能：</span><span class="sxs-lookup"><span data-stu-id="db940-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="db940-152">Drop source 也必須建立公開 [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) 介面的物件。</span><span class="sxs-lookup"><span data-stu-id="db940-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="db940-153">當作業正在進行時，系統會使用 **IDropSource** 與來源進行通訊。</span><span class="sxs-lookup"><span data-stu-id="db940-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="db940-154">拖放資料物件負責追蹤資料指標移動，並顯示代表資料物件的圖示。</span><span class="sxs-lookup"><span data-stu-id="db940-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="db940-155">卸載目標也必須提供比處理剪貼簿傳輸所需的更多功能：</span><span class="sxs-lookup"><span data-stu-id="db940-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="db940-156">放置目標必須公開 [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 介面。</span><span class="sxs-lookup"><span data-stu-id="db940-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="db940-157">當游標在目標視窗上時，系統會使用 **IDropTarget** 來提供目標資訊（例如游標位置），並在卸載資料時通知它。</span><span class="sxs-lookup"><span data-stu-id="db940-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="db940-158">放置目標必須藉由呼叫 [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop)，向系統註冊其本身。</span><span class="sxs-lookup"><span data-stu-id="db940-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="db940-159">這個函式會為系統提供目標視窗的控制碼，以及目標應用程式之 [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="db940-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="db940-160">針對拖放作業，您的應用程式必須使用 [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize)（而非 [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize)）來初始化 COM。</span><span class="sxs-lookup"><span data-stu-id="db940-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="db940-161">下列程式概述通常用來傳送 Shell 資料與拖放的基本步驟：</span><span class="sxs-lookup"><span data-stu-id="db940-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="db940-162">目標會呼叫 [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) ，為系統提供其 [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 介面的指標，並將視窗註冊為放置目標。</span><span class="sxs-lookup"><span data-stu-id="db940-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="db940-163">當使用者啟動拖放作業時，來源會建立資料物件，並藉由呼叫 [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop)來起始 *拖曳迴圈*。</span><span class="sxs-lookup"><span data-stu-id="db940-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="db940-164">當游標在目標視窗上時，系統會呼叫其中一個目標的 [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 方法，以通知目標。</span><span class="sxs-lookup"><span data-stu-id="db940-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="db940-165">當游標進入目標視窗時，系統會呼叫 [**IDropTarget：:D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) ，而當資料指標在目標視窗上傳遞時，則會呼叫 [**IDropTarget：:D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) 。</span><span class="sxs-lookup"><span data-stu-id="db940-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="db940-166">這兩種方法都會以目前的游標位置和鍵盤輔助按鍵的狀態（例如 CTRL 或 ALT）提供放置目標。</span><span class="sxs-lookup"><span data-stu-id="db940-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="db940-167">當資料指標離開目標視窗時，系統會呼叫 [**IDropTarget：:D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave)來通知目標。</span><span class="sxs-lookup"><span data-stu-id="db940-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="db940-168">當這些方法傳回時，系統會呼叫 [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) 介面，將傳回值傳遞給來源。</span><span class="sxs-lookup"><span data-stu-id="db940-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="db940-169">當使用者放開滑鼠按鍵來捨棄資料時，系統會呼叫目標的 [**IDropTarget：:D rop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) 方法。</span><span class="sxs-lookup"><span data-stu-id="db940-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="db940-170">在方法的參數中，是資料物件之 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="db940-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="db940-171">目標會呼叫資料物件的 [**IDataObject：：：：：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) 的方法來將資料解壓縮。</span><span class="sxs-lookup"><span data-stu-id="db940-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="db940-172">使用某些 Shell 資料傳輸時，目標可能也需要呼叫資料物件的 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) 方法，以提供對資料傳輸結果來源的意見反應。</span><span class="sxs-lookup"><span data-stu-id="db940-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="db940-173">當目標完成資料物件時，它會從 [**IDropTarget：:D rop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop)傳回。</span><span class="sxs-lookup"><span data-stu-id="db940-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="db940-174">系統會傳回來源的 [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) 呼叫，以通知來來源資料傳輸已完成。</span><span class="sxs-lookup"><span data-stu-id="db940-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="db940-175">根據特定的 [資料傳輸案例](datascenarios.md)，來源可能需要根據 [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) 所傳回的值，以及目標傳遞給資料物件的值，採取額外的動作。</span><span class="sxs-lookup"><span data-stu-id="db940-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="db940-176">比方說，當移動檔案時，來源必須檢查這些值，以判斷它是否必須刪除原始檔案。</span><span class="sxs-lookup"><span data-stu-id="db940-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="db940-177">來源會釋放資料物件。</span><span class="sxs-lookup"><span data-stu-id="db940-177">The source releases the data object.</span></span>

<span data-ttu-id="db940-178">雖然上述程式為 Shell 資料傳輸提供良好的一般模型，但 Shell 資料物件中可包含許多不同類型的資料。</span><span class="sxs-lookup"><span data-stu-id="db940-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="db940-179">此外，您的應用程式可能需要處理一些不同的資料傳輸案例。</span><span class="sxs-lookup"><span data-stu-id="db940-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="db940-180">每種資料類型和案例都需要在程式中有稍微不同的方法來處理三個主要步驟：</span><span class="sxs-lookup"><span data-stu-id="db940-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="db940-181">來源如何建立資料物件以包含 Shell 資料。</span><span class="sxs-lookup"><span data-stu-id="db940-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="db940-182">目標如何從資料物件中解壓縮 Shell 資料。</span><span class="sxs-lookup"><span data-stu-id="db940-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="db940-183">來源如何完成資料傳輸作業。</span><span class="sxs-lookup"><span data-stu-id="db940-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="db940-184">[Shell 資料物件](dataobject.md)提供來源如何建立 Shell 資料物件的一般討論，以及該資料物件可由目標處理的方式。</span><span class="sxs-lookup"><span data-stu-id="db940-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="db940-185">[處理 Shell 資料傳輸案例](datascenarios.md) 會詳細討論如何處理一些常見的 Shell 資料傳輸案例。</span><span class="sxs-lookup"><span data-stu-id="db940-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
