---
description: Windows 檔案總管提供 Shell 命名空間的圖形標記法，並結合了可讓使用者與 Shell 物件互動的工具。
ms.assetid: cc387338-15fa-4350-b039-61a0f1c5030a
title: 瞭解 Shell 命名空間延伸模組
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0150092a25708c1f079160a9d106a7b8205e231
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973360"
---
# <a name="understanding-shell-namespace-extensions"></a><span data-ttu-id="6c285-103">瞭解 Shell 命名空間延伸模組</span><span class="sxs-lookup"><span data-stu-id="6c285-103">Understanding Shell Namespace Extensions</span></span>

<span data-ttu-id="6c285-104">Windows 檔案總管提供 Shell 命名空間的圖形標記法，並結合了可讓使用者與 Shell 物件互動的工具。</span><span class="sxs-lookup"><span data-stu-id="6c285-104">Windows Explorer provides a graphical representation of the Shell namespace combined with tools that allow users to interact with Shell objects.</span></span> <span data-ttu-id="6c285-105">使用命名空間延伸模組時，您可以採用任何資料主體，並讓 Windows 檔案總管將其以虛擬資料夾的形式呈現給使用者。</span><span class="sxs-lookup"><span data-stu-id="6c285-105">With a namespace extension, you can take any body of data and have Windows Explorer present it to the user as a virtual folder.</span></span> <span data-ttu-id="6c285-106">當使用者流覽到這個資料夾時，您的資料會顯示為資料夾和檔案的樹狀結構化階層，與 Shell 命名空間的其餘部分很類似。</span><span class="sxs-lookup"><span data-stu-id="6c285-106">When a user browses into this folder, your data is presented as a tree-structured hierarchy of folders and files, much like the rest of the Shell namespace.</span></span> <span data-ttu-id="6c285-107">使用者和應用程式能夠與此虛擬資料夾的內容互動，與任何其他命名空間物件的方式大致相同。</span><span class="sxs-lookup"><span data-stu-id="6c285-107">Users and applications are able to interact with the contents of this virtual folder in much the same way as with any other namespace object.</span></span> <span data-ttu-id="6c285-108">本檔討論如何建立命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="6c285-108">This document discusses how to create a namespace extension.</span></span>

-   [<span data-ttu-id="6c285-109">命名空間延伸模組的運作方式</span><span class="sxs-lookup"><span data-stu-id="6c285-109">How a Namespace Extension Works</span></span>](#how-a-namespace-extension-works)
-   [<span data-ttu-id="6c285-110">預設的系統資料夾 View 物件 (DefView) </span><span class="sxs-lookup"><span data-stu-id="6c285-110">The Default System Folder View Object (DefView)</span></span>](#the-default-system-folder-view-object-defview)
-   [<span data-ttu-id="6c285-111">Windows 檔案總管如何與命名空間延伸模組互動</span><span class="sxs-lookup"><span data-stu-id="6c285-111">How Windows Explorer Interacts with a Namespace Extension</span></span>](#how-windows-explorer-interacts-with-a-namespace-extension)
    -   [<span data-ttu-id="6c285-112">樹狀檢視</span><span class="sxs-lookup"><span data-stu-id="6c285-112">Tree View</span></span>](#tree-view)
    -   [<span data-ttu-id="6c285-113">資料夾檢視</span><span class="sxs-lookup"><span data-stu-id="6c285-113">Folder View</span></span>](#folder-view)
    -   [<span data-ttu-id="6c285-114">功能表列和工具列</span><span class="sxs-lookup"><span data-stu-id="6c285-114">Menu Bar and Toolbars</span></span>](#menu-bar-and-toolbars)
    -   [<span data-ttu-id="6c285-115">狀態列</span><span class="sxs-lookup"><span data-stu-id="6c285-115">Status Bar</span></span>](#status-bar)

## <a name="how-a-namespace-extension-works"></a><span data-ttu-id="6c285-116">命名空間延伸模組的運作方式</span><span class="sxs-lookup"><span data-stu-id="6c285-116">How a Namespace Extension Works</span></span>

<span data-ttu-id="6c285-117">在幕後，Windows 檔案總管顯示的每個資料夾都會以元件物件模型表示， (COM) 物件，稱為 *資料夾物件*。</span><span class="sxs-lookup"><span data-stu-id="6c285-117">Behind the scenes, every folder that Windows Explorer displays is represented by a Component Object Model (COM) object called a *folder object*.</span></span> <span data-ttu-id="6c285-118">每次使用者與資料夾或其內容互動時，命令介面都會透過許多標準介面的其中一個來與相關聯的資料夾物件進行通訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-118">Each time the user interacts with a folder or its contents, the Shell communicates with the associated folder object through one of a number of standard interfaces.</span></span> <span data-ttu-id="6c285-119">資料夾物件接著會執行任何必要的動作來回應使用者的動作，而 Shell 會更新 Windows 檔案總管顯示。</span><span class="sxs-lookup"><span data-stu-id="6c285-119">The folder object then does whatever is necessary to respond to the user's action, and the Shell updates the Windows Explorer display.</span></span>

<span data-ttu-id="6c285-120">使用者與其互動的大部分檔案和資料夾都是檔案系統或系統虛擬資料夾（例如資源回收筒）的一部分。</span><span class="sxs-lookup"><span data-stu-id="6c285-120">The majority of the files and folders that users interact with are part of the file system or a system virtual folder such as the Recycle Bin.</span></span> <span data-ttu-id="6c285-121">其他檔已討論過如何自訂這些標準資料夾的行為，藉由修改登錄或藉由執行 [Shell 擴充處理常式](handlers.md)，來滿足應用程式的需求。</span><span class="sxs-lookup"><span data-stu-id="6c285-121">Other documentation has discussed how you can customize the behavior of these standard folders to meet the requirements of your application by modifying the registry or by implementing [Shell extension handlers](handlers.md).</span></span> <span data-ttu-id="6c285-122">不過，當您的資訊可立即以一般檔案系統檔案或資料夾的形式封裝時，以這些方式擴充 Shell 最有用。</span><span class="sxs-lookup"><span data-stu-id="6c285-122">However, extending the Shell in these ways is most useful when your information can be readily packaged in the form of normal file system files or folders.</span></span>

<span data-ttu-id="6c285-123">有幾種情況下，將資料儲存為檔系統資料夾和檔案的集合，可能不需要或甚至根本不可能。</span><span class="sxs-lookup"><span data-stu-id="6c285-123">There are a number of situations where storing data as a collection of file-system folders and files might be undesirable or even impossible.</span></span> <span data-ttu-id="6c285-124">這類資料的一些範例包括：</span><span class="sxs-lookup"><span data-stu-id="6c285-124">Some examples of this type of data include:</span></span>

-   <span data-ttu-id="6c285-125">最有效率地封裝在單一檔案（例如資料庫）中的專案集合。</span><span class="sxs-lookup"><span data-stu-id="6c285-125">A collection of items that is most effectively packaged in a single file, such as a database.</span></span>
-   <span data-ttu-id="6c285-126">儲存在沒有標準 Windows 檔案系統之遠端電腦上的專案集合。</span><span class="sxs-lookup"><span data-stu-id="6c285-126">A collection of items stored on a remote computer that does not have a standard Windows file system.</span></span> <span data-ttu-id="6c285-127">這類資料的範例是儲存在個人數位助理 (PDA) 或數位相機的資訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-127">An example of such data is the information stored on a personal digital assistant (PDA) or digital camera.</span></span>
-   <span data-ttu-id="6c285-128">不代表儲存資料的專案集合。</span><span class="sxs-lookup"><span data-stu-id="6c285-128">A collection of items that does not represent stored data.</span></span> <span data-ttu-id="6c285-129">這類資料的範例是標準印表機資料夾所包含的印表機連結。</span><span class="sxs-lookup"><span data-stu-id="6c285-129">An example of such data is the printer links contained by the standard Printers folder.</span></span>

<span data-ttu-id="6c285-130">將這類資料呈現給使用者的其中一種方式是撰寫應用程式，讓使用者能夠查看各種專案並與其互動。</span><span class="sxs-lookup"><span data-stu-id="6c285-130">One way to present this kind of data to a user is to write an application to allow users to view and interact with the various items.</span></span> <span data-ttu-id="6c285-131">但是，如果您的資料可以呈現為資料夾/檔案階層，您需要執行的大部分功能都可能是 Windows 檔案總管已提供的使用者介面服務。</span><span class="sxs-lookup"><span data-stu-id="6c285-131">However, if your data can be presented as a folder/file hierarchy, much of the functionality you will need to implement might be user interface services that are already provided by Windows Explorer.</span></span> <span data-ttu-id="6c285-132">更有效率的方法是撰寫命名空間延伸，讓 Windows 檔案總管成為 GUI。</span><span class="sxs-lookup"><span data-stu-id="6c285-132">A much more efficient approach could be to write a namespace extension and let Windows Explorer become your GUI.</span></span>

<span data-ttu-id="6c285-133">若要執行命名空間延伸，您的資訊必須組織成樹狀結構的命名空間。</span><span class="sxs-lookup"><span data-stu-id="6c285-133">To implement a namespace extension, your information must be organized as a tree-structured namespace.</span></span> <span data-ttu-id="6c285-134">您的 *命名空間根目錄* 會顯示為 Shell 命名空間中的虛擬資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-134">Your *namespace root* is presented as a virtual folder in the Shell namespace.</span></span> <span data-ttu-id="6c285-135">根資料夾及其所有子資料夾和資料項目都會變成 Shell 命名空間的一部分，Windows 檔案總管則會變成您的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="6c285-135">The root folder, and all its subfolders and data items, becomes part of the Shell namespace, and Windows Explorer becomes your user interface.</span></span> <span data-ttu-id="6c285-136">因此，您可以使用比自訂應用程式所需更少的 UI 程式設計，以熟悉且立即存取的方式向使用者呈現您的資訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-136">You can thus present your information to the user in a familiar and readily accessible way with much less UI programming than would be required for a custom application.</span></span>

<span data-ttu-id="6c285-137">命名空間延伸包含兩個基本元件：</span><span class="sxs-lookup"><span data-stu-id="6c285-137">A namespace extension consists of two basic components:</span></span>

-   <span data-ttu-id="6c285-138">資料管理員</span><span class="sxs-lookup"><span data-stu-id="6c285-138">A data manager</span></span>
-   <span data-ttu-id="6c285-139">資料管理員與 Windows 檔案總管之間的介面</span><span class="sxs-lookup"><span data-stu-id="6c285-139">An interface between the data manager and Windows Explorer</span></span>

<span data-ttu-id="6c285-140">清單中的第一個元件完全由您負責。</span><span class="sxs-lookup"><span data-stu-id="6c285-140">The first component on the list is entirely up to you.</span></span> <span data-ttu-id="6c285-141">您可以用任何最有效的方式來儲存及管理資料。</span><span class="sxs-lookup"><span data-stu-id="6c285-141">You can store and manage your data in whatever way is most effective.</span></span> <span data-ttu-id="6c285-142">第二個元件是將您的資料封裝為資料夾物件所需的程式碼，並處理與 Windows 檔案總管的互動。</span><span class="sxs-lookup"><span data-stu-id="6c285-142">The second component is the code needed to package your data as folder objects and handle the interaction with Windows Explorer.</span></span> <span data-ttu-id="6c285-143">Windows 檔案總管接著可以呼叫這些物件，讓使用者可以像是資料夾和檔案的集合一樣，查看資料並與其互動。</span><span class="sxs-lookup"><span data-stu-id="6c285-143">Windows Explorer can then call these objects to allow users to view and interact with your data as if it were a collection of folders and files.</span></span> <span data-ttu-id="6c285-144">您的命名空間延伸的資料夾物件必須與 Windows 檔案總管互動，就像是一般資料夾一樣。</span><span class="sxs-lookup"><span data-stu-id="6c285-144">Your namespace extension's folder objects must interact with Windows Explorer as if they were normal folders.</span></span> <span data-ttu-id="6c285-145">在嘗試執行命名空間延伸之前，您必須先瞭解 Windows 檔案總管如何處理資料夾物件。</span><span class="sxs-lookup"><span data-stu-id="6c285-145">Before attempting to implement a namespace extension, you must first understand how Windows Explorer handles a folder object.</span></span>

## <a name="the-default-system-folder-view-object-defview"></a><span data-ttu-id="6c285-146">預設的系統資料夾 View 物件 (DefView) </span><span class="sxs-lookup"><span data-stu-id="6c285-146">The Default System Folder View Object (DefView)</span></span>

<span data-ttu-id="6c285-147">Shell 會提供資料夾檢視的預設執行，堆疊稱為 DefView，如此您就可以避免執行自己的命名空間延伸模組的大部分工作。</span><span class="sxs-lookup"><span data-stu-id="6c285-147">The Shell provides a default implementation of the folder view, colloquially known as DefView, so that you can avoid much of the work of implementing your own namespace extension.</span></span> <span data-ttu-id="6c285-148">由於某些視圖功能無法透過自訂視圖來達成，因此通常建議使用預設的系統資料夾 view 物件來取代自訂視圖。</span><span class="sxs-lookup"><span data-stu-id="6c285-148">Because some view features cannot be achieved through custom views, it is often recommended that the default system folder view object is used in place of a custom view.</span></span> <span data-ttu-id="6c285-149">如需詳細資訊，請參閱 [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview)。</span><span class="sxs-lookup"><span data-stu-id="6c285-149">For more information, see [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span>

## <a name="how-windows-explorer-interacts-with-a-namespace-extension"></a><span data-ttu-id="6c285-150">Windows 檔案總管如何與命名空間延伸模組互動</span><span class="sxs-lookup"><span data-stu-id="6c285-150">How Windows Explorer Interacts with a Namespace Extension</span></span>

<span data-ttu-id="6c285-151">Windows 檔案總管為使用者提供的 GUI 可讓他們執行各種不同的工作，包括：</span><span class="sxs-lookup"><span data-stu-id="6c285-151">Windows Explorer provides users with a GUI that allows them to do a variety of tasks, including:</span></span>

-   <span data-ttu-id="6c285-152">[流覽](navigate.md) 命名空間階層，並查看資料夾的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-152">[Navigating](navigate.md) the namespace hierarchy and viewing the contents of folders.</span></span>
-   <span data-ttu-id="6c285-153">藉由移動、刪除和複製物件來[管理](manage.md)命名空間的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-153">[Managing](manage.md) the contents of the namespace by moving, deleting, and copying objects.</span></span>
-   <span data-ttu-id="6c285-154">[正在](folder-info.md) 抓取物件的各種相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-154">[Retrieving](folder-info.md) a variety of information about objects.</span></span>
-   <span data-ttu-id="6c285-155">[啟動](launch.md) 應用程式。</span><span class="sxs-lookup"><span data-stu-id="6c285-155">[Launching](launch.md) applications.</span></span>

<span data-ttu-id="6c285-156">Windows 檔案總管 GUI 有五個基本元件。</span><span class="sxs-lookup"><span data-stu-id="6c285-156">The Windows Explorer GUI has five basic components.</span></span> <span data-ttu-id="6c285-157">下圖會命名元件，並顯示它們通常顯示在 Windows 檔案總管中的位置。</span><span class="sxs-lookup"><span data-stu-id="6c285-157">The following illustration names the components and shows where they are typically displayed within Windows Explorer.</span></span>

![<span data-ttu-id="6c285-158">顯示 windows explorer 使用者介面元件的圖例</span><span class="sxs-lookup"><span data-stu-id="6c285-158">illustration showing components of the windows explorer user interface</span></span> ](images/nse1.png)

<span data-ttu-id="6c285-159">當使用者在 Windows 檔案總管中顯示屬於命名空間延伸的資料夾時，資料夾物件對這五個區域的內容至少有部分的控制權。</span><span class="sxs-lookup"><span data-stu-id="6c285-159">When a user displays a folder that belongs to a namespace extension in Windows Explorer, the folder object has at least partial control over the contents of all five areas.</span></span>

### <a name="tree-view"></a><span data-ttu-id="6c285-160">樹狀目錄檢視</span><span class="sxs-lookup"><span data-stu-id="6c285-160">Tree View</span></span>

<span data-ttu-id="6c285-161">樹狀檢視會提供命名空間的高階觀點。</span><span class="sxs-lookup"><span data-stu-id="6c285-161">The tree view provides a high-level view of the namespace.</span></span> <span data-ttu-id="6c285-162">此區域會裝載 [樹狀檢視控制項](../controls/tree-view-controls.md) ，以顯示每個命名空間資料夾和資料夾在命名空間階層中的位置。</span><span class="sxs-lookup"><span data-stu-id="6c285-162">This area hosts a [tree view control](../controls/tree-view-controls.md) that can display every namespace folder and the folder's position in the namespace hierarchy.</span></span> <span data-ttu-id="6c285-163">使用者可以使用樹狀檢視區域執行數項作業，包括：</span><span class="sxs-lookup"><span data-stu-id="6c285-163">A user can perform several operations with the tree view area, including:</span></span>

-   <span data-ttu-id="6c285-164">顯示或隱藏命名空間中的下一個層級。</span><span class="sxs-lookup"><span data-stu-id="6c285-164">Displaying or hiding the next level in the namespace.</span></span>
-   <span data-ttu-id="6c285-165">複製、移動或刪除資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-165">Copying, moving, or deleting folders.</span></span>
-   <span data-ttu-id="6c285-166">以滑鼠右鍵按一下資料夾，以顯示快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="6c285-166">Right-clicking a folder to display a shortcut menu.</span></span>
-   <span data-ttu-id="6c285-167">選取資料夾，並在資料夾檢視中查看其內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-167">Selecting a folder and viewing its contents in the folder view.</span></span>

<span data-ttu-id="6c285-168">樹狀檢視主要透過其 [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) 介面與資料夾物件進行通訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-168">The tree view communicates with folder objects primarily through their [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="6c285-169">例如，當使用者按一下資料夾圖示旁邊的加號 (+) 時，Windows 檔案總管會展開顯示，以顯示資料夾的子資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-169">For example, when a user clicks the plus sign (+) next to the folder's icon, Windows Explorer expands the display to show the folder's subfolders.</span></span> <span data-ttu-id="6c285-170">為了取得更新樹狀檢視所需的資訊，Shell 會對資料夾物件的 **IShellFolder** 介面進行數個呼叫，以執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="6c285-170">To obtain the information needed to update the tree view, the Shell makes several calls to the folder object's **IShellFolder** interface to:</span></span>

-   <span data-ttu-id="6c285-171">要求資料夾的屬性。</span><span class="sxs-lookup"><span data-stu-id="6c285-171">Request the folder's attributes.</span></span>
-   <span data-ttu-id="6c285-172">列舉資料夾的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-172">Enumerate the contents of the folder.</span></span>
-   <span data-ttu-id="6c285-173">要求每個子資料夾的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="6c285-173">Request display names for each subfolder.</span></span>
-   <span data-ttu-id="6c285-174">要求顯示每個資料夾旁的圖示。</span><span class="sxs-lookup"><span data-stu-id="6c285-174">Request an icon to display next to each folder.</span></span>

<span data-ttu-id="6c285-175">Windows 檔案總管接著會更新樹狀檢視，以顯示所選資料夾的子資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-175">Windows Explorer then updates the tree view to show the selected folder's subfolders.</span></span> <span data-ttu-id="6c285-176">如果子資料夾有子資料夾，則會在其資料夾圖示旁邊顯示 ' + ' 字元。</span><span class="sxs-lookup"><span data-stu-id="6c285-176">If the subfolders have subfolders, a '+' character is displayed next to their folder icon.</span></span> <span data-ttu-id="6c285-177">使用者也可以使用樹狀檢視來執行一些更複雜的工作，包括：</span><span class="sxs-lookup"><span data-stu-id="6c285-177">There are a number of more sophisticated tasks that a user can also perform with the tree view, including:</span></span>

-   <span data-ttu-id="6c285-178">使用剪貼簿剪下或複製資料夾，並將它貼入另一個資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-178">Using the Clipboard to cut or copy a folder and paste it into another folder.</span></span>
-   <span data-ttu-id="6c285-179">使用拖放來剪下或複製資料夾，並將它放在另一個資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c285-179">Using drag-and-drop to cut or copy a folder and drop it on another folder.</span></span>
-   <span data-ttu-id="6c285-180">使用搜尋引擎來搜尋資料夾或其子資料夾中的專案。</span><span class="sxs-lookup"><span data-stu-id="6c285-180">Using a search engine to search for items in a folder or its subfolders.</span></span>
-   <span data-ttu-id="6c285-181">修改資料夾的屬性。</span><span class="sxs-lookup"><span data-stu-id="6c285-181">Modifying the folder's properties.</span></span>

<span data-ttu-id="6c285-182">如需命名空間延伸模組如何處理這些使用者動作的詳細討論，請參閱 [執行基本資料夾物件介面](nse-implement.md)。</span><span class="sxs-lookup"><span data-stu-id="6c285-182">For a more detailed discussion of how a namespace extension handles these user actions, see [Implementing the Basic Folder Object Interfaces](nse-implement.md).</span></span>

### <a name="folder-view"></a><span data-ttu-id="6c285-183">資料夾檢視</span><span class="sxs-lookup"><span data-stu-id="6c285-183">Folder View</span></span>

<span data-ttu-id="6c285-184">當使用者選取資料夾時，資料夾的內容會顯示在資料夾檢視中。</span><span class="sxs-lookup"><span data-stu-id="6c285-184">When a user selects a folder, the contents of the folder are displayed in the folder view.</span></span> <span data-ttu-id="6c285-185">在某些程度上，資料夾檢視的一般功能會與樹狀檢視重迭。</span><span class="sxs-lookup"><span data-stu-id="6c285-185">To some extent, the normal functionality of the folder view overlaps with the tree view.</span></span> <span data-ttu-id="6c285-186">使用者可以移動或複製資料夾、變更資料夾屬性、查看子資料夾的內容、顯示資料夾的快捷方式功能表等。</span><span class="sxs-lookup"><span data-stu-id="6c285-186">Users can move or copy folders, change folder properties, view the contents of a subfolder, display a shortcut menu for a folder, and so on.</span></span> <span data-ttu-id="6c285-187">不過，樹狀檢視和資料夾檢視之間有一些不同的差異：</span><span class="sxs-lookup"><span data-stu-id="6c285-187">However, there are some distinct differences between tree view and folder view:</span></span>

-   <span data-ttu-id="6c285-188">資料夾檢視只會顯示單一資料夾的內容，而不會顯示部分或所有的命名空間階層。</span><span class="sxs-lookup"><span data-stu-id="6c285-188">Folder view displays only the contents of a single folder, not part or all of the namespace hierarchy.</span></span>
-   <span data-ttu-id="6c285-189">資料夾檢視會顯示檔案物件以及資料夾物件。</span><span class="sxs-lookup"><span data-stu-id="6c285-189">Folder view displays file objects as well as folder objects.</span></span>
-   <span data-ttu-id="6c285-190">資料夾檢視可顯示與樹狀檢視更多的物件相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-190">Folder view can display much more information about objects than tree view.</span></span>
-   <span data-ttu-id="6c285-191">資料夾檢視可讓命名空間延伸幾乎完全掌控所顯示的資訊和方法。</span><span class="sxs-lookup"><span data-stu-id="6c285-191">Folder view allows namespace extensions to have almost complete control over what information is displayed and how.</span></span> <span data-ttu-id="6c285-192">您只能修改樹狀檢視的小部分，例如資料夾圖示。</span><span class="sxs-lookup"><span data-stu-id="6c285-192">Only minor aspects of the tree view, such as folder icons, can be modified.</span></span>

<span data-ttu-id="6c285-193">不同于樹狀檢視，Windows 檔案總管不會直接控制資料夾檢視的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-193">Unlike the tree view, Windows Explorer does not directly control the contents of the folder view.</span></span> <span data-ttu-id="6c285-194">資料夾檢視是 Windows 檔案總管提供給資料夾物件的區域。</span><span class="sxs-lookup"><span data-stu-id="6c285-194">The folder view is an area that Windows Explorer provides to folder objects.</span></span> <span data-ttu-id="6c285-195">在資料夾檢視中顯示和管理資料夾的內容是資料夾物件的責任。</span><span class="sxs-lookup"><span data-stu-id="6c285-195">Displaying and managing the contents of a folder in the folder view are the responsibility of the folder object.</span></span> <span data-ttu-id="6c285-196">雖然大部分的資料夾檢視都遵循相當標準的格式，但實際上有一些限制可顯示或如何顯示。</span><span class="sxs-lookup"><span data-stu-id="6c285-196">Although most folder views follow a fairly standard format, there are actually few limitations on what can be displayed or how.</span></span> <span data-ttu-id="6c285-197">極端的情況是，網際網路資料夾是功能完整的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="6c285-197">An extreme case is the Internet folder, which is a full-featured browser.</span></span>

<span data-ttu-id="6c285-198">當使用者選取屬於您的命名空間延伸的資料夾時，您會建立視窗並將其控制碼傳遞至 Windows 檔案總管。</span><span class="sxs-lookup"><span data-stu-id="6c285-198">When a user selects a folder that belongs to your namespace extension, you create a window and pass its handle to Windows Explorer.</span></span> <span data-ttu-id="6c285-199">此視窗會成為資料夾檢視視窗的子系。</span><span class="sxs-lookup"><span data-stu-id="6c285-199">This window becomes a child of the folder view window.</span></span> <span data-ttu-id="6c285-200">Windows 檔案總管提供資料夾檢視視窗的維度，但對子視窗的內容沒有任何限制。</span><span class="sxs-lookup"><span data-stu-id="6c285-200">Windows Explorer provides the dimensions of the folder view window but places no restrictions on the content of your child window.</span></span> <span data-ttu-id="6c285-201">然後，您可以使用子視窗來顯示資料夾的資料夾檢視。</span><span class="sxs-lookup"><span data-stu-id="6c285-201">You can then use the child window to display the folder's folder view.</span></span>

<span data-ttu-id="6c285-202">命名空間延伸會使用下列兩種方法之一來建立資料夾檢視：</span><span class="sxs-lookup"><span data-stu-id="6c285-202">Namespace extensions use one of two approaches for creating a folder view:</span></span>

-   <span data-ttu-id="6c285-203">使用您的子視窗來裝載 [清單視圖](../controls/list-view-control-reference.md) 控制項。</span><span class="sxs-lookup"><span data-stu-id="6c285-203">Use your child window to host a [list view](../controls/list-view-control-reference.md) control.</span></span> <span data-ttu-id="6c285-204">此控制項可讓您以與 Windows 檔案總管 [傳統視圖](../lwef/web-view.md)相同的方式，顯示資料夾的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-204">This control allows you to display the contents of a folder in much the same way as the Windows Explorer [classic view](../lwef/web-view.md).</span></span>
-   <span data-ttu-id="6c285-205">您可以使用子視窗來裝載 [WebBrowser 控制項](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752044(v=vs.85)) ，並使用動態 HTML (DHTML) 檔來顯示資料夾的內容。</span><span class="sxs-lookup"><span data-stu-id="6c285-205">Use your child window to host a [WebBrowser control](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752044(v=vs.85)) and use a Dynamic HTML (DHTML) document to display the contents of the folder.</span></span>

<span data-ttu-id="6c285-206">這兩種方法都會顯示一個看起來像系統資料夾所顯示的資料夾檢視。</span><span class="sxs-lookup"><span data-stu-id="6c285-206">Both approaches display a folder view that looks very much like that displayed for system folders.</span></span> <span data-ttu-id="6c285-207">但是，如果您想要使用不同的顯示配置，您可以隨意執行。</span><span class="sxs-lookup"><span data-stu-id="6c285-207">However, if you want to use a different display scheme, you are free to do so.</span></span>

### <a name="menu-bar-and-toolbars"></a><span data-ttu-id="6c285-208">功能表列和工具列</span><span class="sxs-lookup"><span data-stu-id="6c285-208">Menu Bar and Toolbars</span></span>

<span data-ttu-id="6c285-209">和大部分的 Windows 應用程式一樣，Windows 檔案總管可為使用者提供一組工具。</span><span class="sxs-lookup"><span data-stu-id="6c285-209">Like most Windows applications, Windows Explorer provides the user with a collection of tools.</span></span> <span data-ttu-id="6c285-210">您可以透過功能表列取得完整的工具選項。</span><span class="sxs-lookup"><span data-stu-id="6c285-210">A complete selection of tools is available through the menu bar.</span></span> <span data-ttu-id="6c285-211">工具列上的按鈕或編輯方塊也會以較常用的工具來表示。</span><span class="sxs-lookup"><span data-stu-id="6c285-211">The more commonly used tools are also represented by buttons or edit boxes on a toolbar.</span></span> <span data-ttu-id="6c285-212">和許多 Windows 應用程式不同的是，Windows 檔案總管的功能表列實際上是已自訂的 [工具列控制項](../controls/toolbar-control-reference.md) ，其行為就像傳統功能表一樣。</span><span class="sxs-lookup"><span data-stu-id="6c285-212">Unlike many Windows applications, the Windows Explorer menu bar is actually a [toolbar control](../controls/toolbar-control-reference.md) that has been customized to behave like a conventional menu.</span></span> <span data-ttu-id="6c285-213">功能表列和工具列都會合並到 [Rebar 控制項](../controls/rebar-control-reference.md) 中，以允許使用者組織個別控制項以符合其需求。</span><span class="sxs-lookup"><span data-stu-id="6c285-213">Both the menu bar and the toolbar are incorporated into a [rebar control](../controls/rebar-control-reference.md) to allow users to organize the individual controls to suit their needs.</span></span>

<span data-ttu-id="6c285-214">根據預設，Windows 檔案總管支援一組標準的按鈕和功能表項目，例如 [複製] 和 [屬性]。</span><span class="sxs-lookup"><span data-stu-id="6c285-214">By default, Windows Explorer supports a standard set of buttons and menu items, such as Copy and Properties.</span></span> <span data-ttu-id="6c285-215">您的命名空間延伸模組可以藉由刪除標準工具和新增自訂工具，來自訂功能表列和工具列。</span><span class="sxs-lookup"><span data-stu-id="6c285-215">Your namespace extension can customize the menu bar and toolbars by deleting standard tools and adding custom tools.</span></span> <span data-ttu-id="6c285-216">當您的資料夾 view 物件已初始化時，Windows 檔案總管會將指標傳遞至其 [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) 介面。</span><span class="sxs-lookup"><span data-stu-id="6c285-216">When your folder view object is initialized, Windows Explorer passes a pointer to its [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface.</span></span> <span data-ttu-id="6c285-217">此介面支援數個可供您呼叫的方法，以自訂功能表列和工具列。</span><span class="sxs-lookup"><span data-stu-id="6c285-217">This interface supports several methods that you can call to customize the menu bar and toolbar.</span></span> <span data-ttu-id="6c285-218">當使用者選取您的其中一個自訂功能表項目或工具列按鈕時，Windows 檔案總管將 \_ 自訂功能表和工具列專案的 WM 命令訊息轉送至子視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="6c285-218">When the user selects one of your custom menu items or toolbar buttons, Windows Explorer forwards WM\_COMMAND messages for custom menu and toolbar items to your child window's window procedure.</span></span>

### <a name="status-bar"></a><span data-ttu-id="6c285-219">狀態列</span><span class="sxs-lookup"><span data-stu-id="6c285-219">Status Bar</span></span>

<span data-ttu-id="6c285-220">Windows 檔案總管狀態列會顯示目前所選物件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6c285-220">The Windows Explorer status bar displays information about the currently selected object.</span></span> <span data-ttu-id="6c285-221">您的命名空間延伸模組可以使用狀態列來顯示狀態資訊，例如文字字串。</span><span class="sxs-lookup"><span data-stu-id="6c285-221">Your namespace extension can use the status bar to display status information, such as a text string.</span></span> <span data-ttu-id="6c285-222">您可以藉由呼叫 [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser)來自訂狀態列。</span><span class="sxs-lookup"><span data-stu-id="6c285-222">You can customize the status bar by calling [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span></span>

 

 
