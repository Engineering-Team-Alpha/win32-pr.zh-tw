---
description: 控制呼叫函式行為的旗標。 由 SHCreateThread 和 SHCreateThreadWithHandle 使用。 在這些函數中，這些值會定義為 SHCT \_ 旗標的類型。
title: 'CTF 旗標 (Shlwapi .h) '
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 66cda866-7a39-4c5a-a795-a4c5c64cbab7
api_name:
- CTF_INSIST
- CTF_THREAD_REF
- CTF_PROCESS_REF
- CTF_COINIT_STA
- CTF_COINIT
- CTF_FREELIBANDEXIT
- CTF_REF_COUNTED
- CTF_WAIT_ALLOWCOM
- CTF_UNUSED
- CTF_INHERITWOW64
- CTF_WAIT_NO_REENTRANCY
- CTF_KEYBOARD_LOCALE
- CTF_OLEINITIALIZE
- CTF_COINIT_MTA
- CTF_NOADDREFLIB
api_type:
- HeaderDef
api_location:
- Shlwapi.h
topic_type:
- APIRef
- kbSyntax
ms.openlocfilehash: db0f33daecc4abcbfbc9972d0607f4817bc7ecff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104972032"
---
# <a name="ctf-flags"></a><span data-ttu-id="1b073-105">CTF 旗標</span><span class="sxs-lookup"><span data-stu-id="1b073-105">CTF Flags</span></span>

<span data-ttu-id="1b073-106">控制呼叫函式行為的旗標。</span><span class="sxs-lookup"><span data-stu-id="1b073-106">Flags that control the calling function's behavior.</span></span> <span data-ttu-id="1b073-107">由 [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) 和 [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle)使用。</span><span class="sxs-lookup"><span data-stu-id="1b073-107">Used by [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) and [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle).</span></span> <span data-ttu-id="1b073-108">在這些函數中，這些值會定義為 SHCT \_ 旗標的類型。</span><span class="sxs-lookup"><span data-stu-id="1b073-108">In those functions, these values are defined as being of type SHCT\_FLAGS.</span></span>



| <span data-ttu-id="1b073-109">常數/值</span><span class="sxs-lookup"><span data-stu-id="1b073-109">Constant/value</span></span>                                                                                                                                                                                                                                             | <span data-ttu-id="1b073-110">Description</span><span class="sxs-lookup"><span data-stu-id="1b073-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CTF_INSIST"></span><span id="ctf_insist"></span><dl> <span data-ttu-id="1b073-111"><dt>**CTF \_堅持**</dt> <dt>0x00000001</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-111"><dt>**CTF\_INSIST**</dt> <dt>0x00000001</dt></span></span> </dl>                                       | <span data-ttu-id="1b073-112">0x00000001.</span><span class="sxs-lookup"><span data-stu-id="1b073-112">0x00000001.</span></span> <span data-ttu-id="1b073-113">如果嘗試以 [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) 建立執行緒失敗，設定這個旗標會導致 *pfnThreadProc* 所指向的函式，以同步方式從呼叫執行緒呼叫。</span><span class="sxs-lookup"><span data-stu-id="1b073-113">If the attempt to create the thread with [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) fails, setting this flag will cause the function pointed to by *pfnThreadProc* to be called synchronously from the calling thread.</span></span> <span data-ttu-id="1b073-114">只有當 *pfnCallback* 為 **Null** 時，才能使用此旗標。</span><span class="sxs-lookup"><span data-stu-id="1b073-114">This flag can be used only if *pfnCallback* is **NULL**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_THREAD_REF"></span><span id="ctf_thread_ref"></span><dl> <span data-ttu-id="1b073-115"><dt>**CTF \_執行緒 \_ REF**</dt> <dt>0x00000002</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-115"><dt>**CTF\_THREAD\_REF**</dt> <dt>0x00000002</dt></span></span> </dl>                          | <span data-ttu-id="1b073-116">0x00000002.</span><span class="sxs-lookup"><span data-stu-id="1b073-116">0x00000002.</span></span> <span data-ttu-id="1b073-117">在呼叫 *pfnThreadProc* 所指向的函式期間，保留建立執行緒的參考。</span><span class="sxs-lookup"><span data-stu-id="1b073-117">Hold a reference to the creating thread for the duration of the call to the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="1b073-118">此參考必須已設定 [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref)。</span><span class="sxs-lookup"><span data-stu-id="1b073-118">This reference must have been set with [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="CTF_PROCESS_REF"></span><span id="ctf_process_ref"></span><dl> <span data-ttu-id="1b073-119"><dt>**CTF \_進程 \_ REF**</dt> <dt>0x00000004</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-119"><dt>**CTF\_PROCESS\_REF**</dt> <dt>0x00000004</dt></span></span> </dl>                       | <span data-ttu-id="1b073-120">0x00000004.</span><span class="sxs-lookup"><span data-stu-id="1b073-120">0x00000004.</span></span> <span data-ttu-id="1b073-121">在呼叫 *pfnThreadProc* 所指向的函式期間，保留對 Windows 檔案總管進程的參考。</span><span class="sxs-lookup"><span data-stu-id="1b073-121">Hold a reference to the Windows Explorer process for the duration of the call to the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="1b073-122">此旗標適用于 [Shell 延伸模組處理常式](handlers.md)，可能需要讓 Windows 檔案總管進程無法提前關閉。</span><span class="sxs-lookup"><span data-stu-id="1b073-122">This flag is useful for [Shell extension handlers](handlers.md), which might need to keep the Windows Explorer process from closing prematurely.</span></span> <span data-ttu-id="1b073-123">在工作（例如在背景執行緒或複製檔案）時，這個動作很有用。</span><span class="sxs-lookup"><span data-stu-id="1b073-123">This action is useful during tasks such as working on a background thread or copying files.</span></span> <span data-ttu-id="1b073-124">如需詳細資訊，請參閱 [**SHGetInstanceExplorer**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer)。</span><span class="sxs-lookup"><span data-stu-id="1b073-124">For more information, see [**SHGetInstanceExplorer**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_COINIT_STA"></span><span id="ctf_coinit_sta"></span><dl> <span data-ttu-id="1b073-125"><dt>**CTF \_COINIT \_ STA**</dt> <dt>0x00000008</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-125"><dt>**CTF\_COINIT\_STA**</dt> <dt>0x00000008</dt></span></span> </dl>                          | <span data-ttu-id="1b073-126">0x00000008.</span><span class="sxs-lookup"><span data-stu-id="1b073-126">0x00000008.</span></span> <span data-ttu-id="1b073-127">在呼叫 *pfnCallback* 所指向的選擇性函式或 *pfnThreadProc* 所指向的函式之前，先將 COM 初始化為所建立執行緒的單一線程單元 (STA) 。</span><span class="sxs-lookup"><span data-stu-id="1b073-127">Initialize COM as a Single Threaded Apartment (STA) for the created thread before calling either the optional function pointed to by *pfnCallback* or the function pointed to by *pfnThreadProc*.</span></span> <span data-ttu-id="1b073-128">當 COM 需要針對執行緒初始化時，此旗標很有用。</span><span class="sxs-lookup"><span data-stu-id="1b073-128">This flag is useful when COM needs to be initialized for a thread.</span></span> <span data-ttu-id="1b073-129">COM 也會自動初始化。</span><span class="sxs-lookup"><span data-stu-id="1b073-129">COM will automatically be uninitialized as well.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="CTF_COINIT"></span><span id="ctf_coinit"></span><dl> <span data-ttu-id="1b073-130"><dt>**CTF \_COINIT**</dt> <dt>0x00000008</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-130"><dt>**CTF\_COINIT**</dt> <dt>0x00000008</dt></span></span> </dl>                                       | <span data-ttu-id="1b073-131">相當於 CTF \_ COINIT \_ STA。</span><span class="sxs-lookup"><span data-stu-id="1b073-131">Equivalent to CTF\_COINIT\_STA.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="CTF_FREELIBANDEXIT"></span><span id="ctf_freelibandexit"></span><dl> <span data-ttu-id="1b073-132"><dt>**CTF \_FREELIBANDEXIT**</dt> <dt>0x00000010</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-132"><dt>**CTF\_FREELIBANDEXIT**</dt> <dt>0x00000010</dt></span></span> </dl>               | <span data-ttu-id="1b073-133">0x00000010.</span><span class="sxs-lookup"><span data-stu-id="1b073-133">0x00000010.</span></span> <span data-ttu-id="1b073-134">**Internet Explorer 6 或更新版本。** 將會在包含 *pfnThreadProc* 函式的 DLL 上呼叫 [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) ，以防止其卸載。</span><span class="sxs-lookup"><span data-stu-id="1b073-134">**Internet Explorer 6 or later.**[**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) will be called on the DLL that contains the *pfnThreadProc* function to prevent it from being unloaded.</span></span> <span data-ttu-id="1b073-135">*PfnThreadProc* 傳回之後，會使用 [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary)釋放 dll，藉此減少 dll 參考計數。</span><span class="sxs-lookup"><span data-stu-id="1b073-135">After *pfnThreadProc* returns, the DLL will be freed with [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary), thereby decrementing the DLL reference count.</span></span> <span data-ttu-id="1b073-136">傳遞此旗標以防止 DLL 提前卸載;例如， [**CoFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries)。</span><span class="sxs-lookup"><span data-stu-id="1b073-136">Pass this flag to prevent the DLL from being unloaded prematurely; for example, by [**CoFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries).</span></span> <span data-ttu-id="1b073-137">請注意，如果傳遞此旗標， *pfnThreadProc* 函式必須位於 DLL 中。</span><span class="sxs-lookup"><span data-stu-id="1b073-137">Note that if this flag is passed, the *pfnThreadProc* function must reside in a DLL.</span></span> <span data-ttu-id="1b073-138">在 Windows Vista 和更新版本中，這個旗標是隱含的。</span><span class="sxs-lookup"><span data-stu-id="1b073-138">This flag is implicit in Windows Vista and later.</span></span><br/>                                                                                                                                                                                                                                                                   |
| <span id="CTF_REF_COUNTED"></span><span id="ctf_ref_counted"></span><dl> <span data-ttu-id="1b073-139"><dt>**CTF \_參考 \_ 計數**</dt> <dt>0x00000020</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-139"><dt>**CTF\_REF\_COUNTED**</dt> <dt>0x00000020</dt></span></span> </dl>                       | <span data-ttu-id="1b073-140">0x00000020.</span><span class="sxs-lookup"><span data-stu-id="1b073-140">0x00000020.</span></span> <span data-ttu-id="1b073-141">**Internet Explorer 6 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-141">**Internet Explorer 6 or later.**</span></span> <span data-ttu-id="1b073-142">系統會自動為所建立的執行緒建立執行緒參考，並使用 [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref)進行設定。</span><span class="sxs-lookup"><span data-stu-id="1b073-142">A thread reference will automatically be created for the created thread and set with [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span></span> <span data-ttu-id="1b073-143">在 *pfnThreadProc* 傳回之後，會釋放執行緒參考並傳送訊息，直到執行緒參考上的參考計數降至零為止，也就是，直到相依于所建立執行緒的執行緒釋放其參考為止。</span><span class="sxs-lookup"><span data-stu-id="1b073-143">After the *pfnThreadProc* returns, the thread reference is released and messages are sent until the reference count on the thread reference drops to zero, that is, until threads that are dependent on the created thread have released their references.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_WAIT_ALLOWCOM"></span><span id="ctf_wait_allowcom"></span><dl> <span data-ttu-id="1b073-144"><dt>**CTF \_等候 \_ ALLOWCOM**</dt> <dt>0x00000040</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-144"><dt>**CTF\_WAIT\_ALLOWCOM**</dt> <dt>0x00000040</dt></span></span> </dl>                 | <span data-ttu-id="1b073-145">0x00000040.</span><span class="sxs-lookup"><span data-stu-id="1b073-145">0x00000040.</span></span> <span data-ttu-id="1b073-146">**Internet Explorer 6 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-146">**Internet Explorer 6 or later.**</span></span> <span data-ttu-id="1b073-147">呼叫執行緒會等待並提取 COM 和 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 訊息。</span><span class="sxs-lookup"><span data-stu-id="1b073-147">The calling thread waits and pumps COM and [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) messages.</span></span> <span data-ttu-id="1b073-148">如果同步程式嘗試將具有 **SendMessage** 的 Windows 訊息傳送至裝載于呼叫執行緒上的視窗，訊息將會成功抵達。</span><span class="sxs-lookup"><span data-stu-id="1b073-148">If the synchronous procedure attempts to send a Windows message with **SendMessage** to a window hosted on the calling thread, the message will arrive successfully.</span></span> <span data-ttu-id="1b073-149">如果同步程式嘗試使用 COM 與裝載于呼叫執行緒上的 STA 物件進行通訊，則函式呼叫會成功抵達預定的物件。</span><span class="sxs-lookup"><span data-stu-id="1b073-149">If the synchronous procedure attempts to use COM to communicate with an STA object hosted on the calling thread, the function call will successfully reach the intended object.</span></span> <span data-ttu-id="1b073-150">呼叫端執行緒會開啟以重新進入脆弱數。</span><span class="sxs-lookup"><span data-stu-id="1b073-150">The calling thread is open to re-entrance fragility.</span></span> <span data-ttu-id="1b073-151">雖然呼叫執行緒可以處理 **SendMessage** 和 com 的同步程式，但如果其他執行緒使用 **SendMessage** 或 com 來與呼叫執行緒上裝載的物件進行通訊，則這些可能是未預期的訊息或在同步程式完成時處理的函式呼叫。</span><span class="sxs-lookup"><span data-stu-id="1b073-151">While the calling thread can handle the synchronous procedure's use of **SendMessage** and COM, if other threads are using **SendMessage** or COM to communicate to objects hosted on the calling thread, then these might be unexpected messages or function calls which are processed while the synchronous procedure is completing.</span></span><br/> |
| <span id="CTF_UNUSED"></span><span id="ctf_unused"></span><dl> <span data-ttu-id="1b073-152"><dt>**CTF \_未使用**</dt>的 <dt>0x00000080</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-152"><dt>**CTF\_UNUSED**</dt> <dt>0x00000080</dt></span></span> </dl>                                       | <span data-ttu-id="1b073-153">0x00000080.</span><span class="sxs-lookup"><span data-stu-id="1b073-153">0x00000080.</span></span> <span data-ttu-id="1b073-154">**Internet Explorer 7 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-154">**Internet Explorer 7 or later.**</span></span> <span data-ttu-id="1b073-155">未使用。</span><span class="sxs-lookup"><span data-stu-id="1b073-155">Not used.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_INHERITWOW64"></span><span id="ctf_inheritwow64"></span><dl> <span data-ttu-id="1b073-156"><dt>**CTF \_INHERITWOW64**</dt> <dt>0x00000100</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-156"><dt>**CTF\_INHERITWOW64**</dt> <dt>0x00000100</dt></span></span> </dl>                     | <span data-ttu-id="1b073-157">0x00000100.</span><span class="sxs-lookup"><span data-stu-id="1b073-157">0x00000100.</span></span> <span data-ttu-id="1b073-158">**Internet Explorer 7 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-158">**Internet Explorer 7 or later.**</span></span> <span data-ttu-id="1b073-159">新的執行緒會繼承 Windows on Windows 64 位 (WOW64) 停用檔案系統重新導向器的狀態。</span><span class="sxs-lookup"><span data-stu-id="1b073-159">The new thread inherits the Windows-on-Windows 64-bit (WOW64) disable state for the file system redirector.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_WAIT_NO_REENTRANCY"></span><span id="ctf_wait_no_reentrancy"></span><dl> <span data-ttu-id="1b073-160"><dt>**CTF \_等候 \_ 無 \_**</dt>重新進入 <dt>0x00000200</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-160"><dt>**CTF\_WAIT\_NO\_REENTRANCY**</dt> <dt>0x00000200</dt></span></span> </dl> | <span data-ttu-id="1b073-161">0x00000200.</span><span class="sxs-lookup"><span data-stu-id="1b073-161">0x00000200.</span></span> <span data-ttu-id="1b073-162">**Windows Vista 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-162">**Windows Vista or later.**</span></span> <span data-ttu-id="1b073-163">呼叫執行緒會在等候同步程式在新執行緒上執行時，封鎖所有其他進程。</span><span class="sxs-lookup"><span data-stu-id="1b073-163">The calling thread blocks all other processes while waiting for the synchronous procedure to run on the new thread.</span></span> <span data-ttu-id="1b073-164">如果同步程式嘗試將具有 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 的 Windows 訊息傳送至裝載于呼叫執行緒上的視窗，這會導致同步程式鎖死。</span><span class="sxs-lookup"><span data-stu-id="1b073-164">If the synchronous procedure attempts to send a Windows message with [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) to a window hosted on the calling thread, this causes the synchronous procedure to deadlock.</span></span> <span data-ttu-id="1b073-165">如果同步程式嘗試使用 COM 來與裝載于呼叫執行緒上的 STA 物件通訊，這也會導致同步程式鎖死。</span><span class="sxs-lookup"><span data-stu-id="1b073-165">If the synchronous procedure attempts to use COM to talk to an STA object hosted on the calling thread, this also causes the synchronous procedure to deadlock.</span></span> <span data-ttu-id="1b073-166">藉由指定此旗標，呼叫執行緒會受到保護，以防止所有重新進入的考慮。</span><span class="sxs-lookup"><span data-stu-id="1b073-166">The calling thread is protected from all re-entrance concerns by specifying this flag.</span></span><br/>                                                                                                                                                                                                                                                                |
| <span id="CTF_KEYBOARD_LOCALE"></span><span id="ctf_keyboard_locale"></span><dl> <span data-ttu-id="1b073-167"><dt>**CTF \_鍵盤 \_ 地區**</dt>設定 <dt>0x00000400</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-167"><dt>**CTF\_KEYBOARD\_LOCALE**</dt> <dt>0x00000400</dt></span></span> </dl>           | <span data-ttu-id="1b073-168">0x00000400.</span><span class="sxs-lookup"><span data-stu-id="1b073-168">0x00000400.</span></span> <span data-ttu-id="1b073-169">**Windows 7 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-169">**Windows 7 or later.**</span></span> <span data-ttu-id="1b073-170">在它所產生的新執行緒中，使用來自原始執行緒的鍵盤地區設定。</span><span class="sxs-lookup"><span data-stu-id="1b073-170">Use the keyboard locale from the original thread in the new thread that it spawns.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_OLEINITIALIZE"></span><span id="ctf_oleinitialize"></span><dl> <span data-ttu-id="1b073-171"><dt>**CTF \_OLEINITIALIZE**</dt> <dt>0x00000800</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-171"><dt>**CTF\_OLEINITIALIZE**</dt> <dt>0x00000800</dt></span></span> </dl>                  | <span data-ttu-id="1b073-172">0x00000800.</span><span class="sxs-lookup"><span data-stu-id="1b073-172">0x00000800.</span></span> <span data-ttu-id="1b073-173">**Windows 7 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-173">**Windows 7 or later.**</span></span> <span data-ttu-id="1b073-174">針對建立的執行緒，使用單一執行緒的單元 (STA) 模型初始化 COM。</span><span class="sxs-lookup"><span data-stu-id="1b073-174">Initialize COM with the single-threaded apartment (STA) model for the created thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_COINIT_MTA"></span><span id="ctf_coinit_mta"></span><dl> <span data-ttu-id="1b073-175"><dt>**CTF \_COINIT \_ MTA**</dt> <dt>0x00001000</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-175"><dt>**CTF\_COINIT\_MTA**</dt> <dt>0x00001000</dt></span></span> </dl>                          | <span data-ttu-id="1b073-176">0x00001000.</span><span class="sxs-lookup"><span data-stu-id="1b073-176">0x00001000.</span></span> <span data-ttu-id="1b073-177">**Windows 7 和更新版本**。</span><span class="sxs-lookup"><span data-stu-id="1b073-177">**Windows 7 and later**.</span></span> <span data-ttu-id="1b073-178">使用建立之執行緒的多執行緒單元 (MTA) 模型初始化 COM。</span><span class="sxs-lookup"><span data-stu-id="1b073-178">Initialize COM with the multithreaded apartment (MTA) model for the created thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_NOADDREFLIB"></span><span id="ctf_noaddreflib"></span><dl> <span data-ttu-id="1b073-179"><dt>**CTF \_NOADDREFLIB**</dt> <dt>0x00002000</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-179"><dt>**CTF\_NOADDREFLIB**</dt> <dt>0x00002000</dt></span></span> </dl>                        | <span data-ttu-id="1b073-180">0x00002000.</span><span class="sxs-lookup"><span data-stu-id="1b073-180">0x00002000.</span></span> <span data-ttu-id="1b073-181">**Windows 7 或更新版本。**</span><span class="sxs-lookup"><span data-stu-id="1b073-181">**Windows 7 or later.**</span></span> <span data-ttu-id="1b073-182">此旗標基本上與 CTF FREELIBANDEXIT 相反 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1b073-182">This flag is essentially the opposite of CTF\_FREELIBANDEXIT.</span></span> <span data-ttu-id="1b073-183">這 [](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) / 可避免可能導致載入器鎖定爭用的 LoadLibrary [**FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread)呼叫。</span><span class="sxs-lookup"><span data-stu-id="1b073-183">This avoids [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)/[**FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) calls that can result in contention for the loader lock.</span></span> <span data-ttu-id="1b073-184">\_只有當新執行緒有方法可確保原始執行緒程式的程式碼仍會保持載入時，才使用 CTF NOADDREFLIB。</span><span class="sxs-lookup"><span data-stu-id="1b073-184">Use CTF\_NOADDREFLIB only when the new thread has means to ensure that the code of the original thread procedure will remain loaded.</span></span> <span data-ttu-id="1b073-185">此值不應該用於 COM 物件的內容中，因為 COM 物件必須確保 DLL 會保持載入 (正常，COM 會將 Dll) 。</span><span class="sxs-lookup"><span data-stu-id="1b073-185">This value should not be used in the context of COM objects, because COM objects must ensure that the DLL stays loaded (normally, COM unloads the DLLs).</span></span><br/>                                                                                                                                                                                                                                                                                                                    |



## <a name="remarks"></a><span data-ttu-id="1b073-186">備註</span><span class="sxs-lookup"><span data-stu-id="1b073-186">Remarks</span></span>

<span data-ttu-id="1b073-187">如果未 \_ 指定 CTF WAIT \_ 旗標，呼叫執行緒將會等候並傳送 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 訊息。</span><span class="sxs-lookup"><span data-stu-id="1b073-187">If no CTF\_WAIT\_ flag is specified, the calling thread will wait and send [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) messages.</span></span> <span data-ttu-id="1b073-188">如果同步程式嘗試將具有 **SendMessage** 的 Windows 訊息傳送至裝載于呼叫執行緒上的視窗，訊息將會進入預期的視窗。</span><span class="sxs-lookup"><span data-stu-id="1b073-188">If the synchronous procedure attempts to send a Windows message with **SendMessage** to a window hosted on the calling thread, the message will get to the intended window.</span></span> <span data-ttu-id="1b073-189">如果同步程式嘗試使用 COM 來與裝載于呼叫執行緒上的 STA 物件通訊，同步程式將會鎖死。</span><span class="sxs-lookup"><span data-stu-id="1b073-189">If the synchronous procedure attempts to use COM to talk to an STA object hosted on the calling thread, the synchronous procedure will deadlock.</span></span> <span data-ttu-id="1b073-190">呼叫端執行緒會開啟以重新進入脆弱數。</span><span class="sxs-lookup"><span data-stu-id="1b073-190">The calling thread is open to re-entrance fragility.</span></span> <span data-ttu-id="1b073-191">雖然呼叫執行緒可以處理同步程式使用 **SendMessage**，但如果其他執行緒使用 **SendMessage** 來與呼叫執行緒上裝載的視窗進行通訊，則這些訊息可能是非預期的。</span><span class="sxs-lookup"><span data-stu-id="1b073-191">While the calling thread can handle the synchronous procedure's use of **SendMessage**, if other threads use **SendMessage** to communicate to an window hosted on the calling thread, then these messages might be unexpected.</span></span> <span data-ttu-id="1b073-192">這可能會在同步程式完成時進行處理。</span><span class="sxs-lookup"><span data-stu-id="1b073-192">This can cause them to be processed while the synchronous procedure is completing.</span></span>

## <a name="requirements"></a><span data-ttu-id="1b073-193">規格需求</span><span class="sxs-lookup"><span data-stu-id="1b073-193">Requirements</span></span>



| <span data-ttu-id="1b073-194">需求</span><span class="sxs-lookup"><span data-stu-id="1b073-194">Requirement</span></span> | <span data-ttu-id="1b073-195">值</span><span class="sxs-lookup"><span data-stu-id="1b073-195">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------|
| <span data-ttu-id="1b073-196">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="1b073-196">Minimum supported client</span></span><br/> | <span data-ttu-id="1b073-197">僅限 windows 2000 Professional、Windows XP、Windows 7 \[ desktop 應用程式\]</span><span class="sxs-lookup"><span data-stu-id="1b073-197">Windows 2000 Professional, Windows XP, Windows 7 \[desktop apps only\]</span></span><br/>    |
| <span data-ttu-id="1b073-198">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="1b073-198">Minimum supported server</span></span><br/> | <span data-ttu-id="1b073-199">Windows 2000 Server \[僅限傳統型應用程式\]</span><span class="sxs-lookup"><span data-stu-id="1b073-199">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                 |
| <span data-ttu-id="1b073-200">標頭</span><span class="sxs-lookup"><span data-stu-id="1b073-200">Header</span></span><br/>                   | <dl> <span data-ttu-id="1b073-201"><dt>Shlwapi。h</dt></span><span class="sxs-lookup"><span data-stu-id="1b073-201"><dt>Shlwapi.h</dt></span></span> </dl> |



 

 
