---
description: Windows 介面包含名為工作列的特殊應用程式桌面工具列。 您可以使用工作列來進行這類工作，像是在開啟的視窗和啟動新的應用程式之間切換。
ms.assetid: 14d520e7-7c15-441d-9662-24b972d208ac
title: 工作列
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cce37991c6265f02ab92ece62dbae341031d272a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104991707"
---
# <a name="the-taskbar"></a><span data-ttu-id="8305b-104">工作列</span><span class="sxs-lookup"><span data-stu-id="8305b-104">The Taskbar</span></span>

<span data-ttu-id="8305b-105">Windows 介面包含名為 *工作列* 的特殊 [應用程式桌面工具列](application-desktop-toolbars.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-105">The Windows interface includes a special [application desktop toolbar](application-desktop-toolbars.md) called the *taskbar*.</span></span> <span data-ttu-id="8305b-106">您可以使用工作列來進行這類工作，像是在開啟的視窗和啟動新的應用程式之間切換。</span><span class="sxs-lookup"><span data-stu-id="8305b-106">You can use the taskbar for such tasks as switching between open windows and starting new applications.</span></span>

> [!Note]  
> <span data-ttu-id="8305b-107">如需 Windows 7 的工作列變更的詳細資訊，請參閱 [工作列擴充](taskbar-extensions.md)功能。</span><span class="sxs-lookup"><span data-stu-id="8305b-107">For information on changes made to the taskbar as of Windows 7, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

 

<span data-ttu-id="8305b-108">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="8305b-108">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="8305b-109">關於工作列</span><span class="sxs-lookup"><span data-stu-id="8305b-109">About the Taskbar</span></span>](#about-the-taskbar)
    -   [<span data-ttu-id="8305b-110">工作列顯示選項</span><span class="sxs-lookup"><span data-stu-id="8305b-110">Taskbar Display Options</span></span>](#taskbar-display-options)
    -   <span data-ttu-id="8305b-111">[將快捷方式新增至 [開始] 功能表](#adding-shortcuts-to-the-start-menu)</span><span class="sxs-lookup"><span data-stu-id="8305b-111">[Adding Shortcuts to the Start Menu](#adding-shortcuts-to-the-start-menu)</span></span>
    -   [<span data-ttu-id="8305b-112">管理工作列按鈕</span><span class="sxs-lookup"><span data-stu-id="8305b-112">Managing Taskbar Buttons</span></span>](#managing-taskbar-buttons)
    -   [<span data-ttu-id="8305b-113">新增、修改和刪除通知區域中的圖示</span><span class="sxs-lookup"><span data-stu-id="8305b-113">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>](#adding-modifying-and-deleting-icons-in-the-notification-area)
    -   [<span data-ttu-id="8305b-114">工作列建立通知</span><span class="sxs-lookup"><span data-stu-id="8305b-114">Taskbar Creation Notification</span></span>](#taskbar-creation-notification)
-   [<span data-ttu-id="8305b-115">使用工作列</span><span class="sxs-lookup"><span data-stu-id="8305b-115">Using the Taskbar</span></span>](#using-the-taskbar)
    -   [<span data-ttu-id="8305b-116">新增和刪除通知區域中的工作列圖示</span><span class="sxs-lookup"><span data-stu-id="8305b-116">Adding and Deleting Taskbar Icons in the Notification Area</span></span>](#adding-and-deleting-taskbar-icons-in-the-notification-area)
    -   [<span data-ttu-id="8305b-117">接收滑鼠事件</span><span class="sxs-lookup"><span data-stu-id="8305b-117">Receiving Mouse Events</span></span>](#receiving-mouse-events)

## <a name="about-the-taskbar"></a><span data-ttu-id="8305b-118">關於工作列</span><span class="sxs-lookup"><span data-stu-id="8305b-118">About the Taskbar</span></span>

<span data-ttu-id="8305b-119">工作列包含下列各項：</span><span class="sxs-lookup"><span data-stu-id="8305b-119">The taskbar includes the following:</span></span>

-   <span data-ttu-id="8305b-120">**開始** 功能表</span><span class="sxs-lookup"><span data-stu-id="8305b-120">**Start** menu</span></span>
-   <span data-ttu-id="8305b-121">快速啟動 bar (Windows Vista 及更早版本) </span><span class="sxs-lookup"><span data-stu-id="8305b-121">Quick Launch bar (Windows Vista and earlier only)</span></span>
-   <span data-ttu-id="8305b-122">工作列按鈕</span><span class="sxs-lookup"><span data-stu-id="8305b-122">Taskbar buttons</span></span>
-   <span data-ttu-id="8305b-123">工具列 (選用) </span><span class="sxs-lookup"><span data-stu-id="8305b-123">Toolbars (optional)</span></span>
-   <span data-ttu-id="8305b-124">[通知] 區域</span><span class="sxs-lookup"><span data-stu-id="8305b-124">Notification area</span></span>

<span data-ttu-id="8305b-125">[ **開始** ] 功能表包含可存取程式、檔和設定的命令。</span><span class="sxs-lookup"><span data-stu-id="8305b-125">The **Start** menu contains commands that can access programs, documents, and settings.</span></span> <span data-ttu-id="8305b-126">這些命令包括 **所有程式**、 **檔**、 **主控台**、 **遊戲**、說明 **及支援**、 **關機** 以及 **搜尋程式和** 檔案。</span><span class="sxs-lookup"><span data-stu-id="8305b-126">These commands include **All Programs**, **Documents**, **Control Panel**, **Games**, **Help and Support**, **Shut down**, and **Search programs and files**.</span></span>

<span data-ttu-id="8305b-127">在舊版的 Windows 中，**從** windows Vista 和更新版本的 **搜尋程式和** 檔案中包含的專案，像是 [**尋找**] 和 [**執行**]。</span><span class="sxs-lookup"><span data-stu-id="8305b-127">The **Start** in earlier versions of Windows contained items such as **Find** and **Run**, the functionality of which was included in **Search programs and files** in Windows Vista and later.</span></span>

<span data-ttu-id="8305b-128">在 Windows 7 之前的 Windows 版本中提供的快速啟動 bar，包含應用程式的快捷方式。</span><span class="sxs-lookup"><span data-stu-id="8305b-128">The Quick Launch bar, available in versions of Windows earlier than Windows 7, contains shortcuts to applications.</span></span> <span data-ttu-id="8305b-129">Windows 提供預設的專案，例如 Windows Internet Explorer，而使用者可以加入他們選擇的任何進一步的快捷方式。</span><span class="sxs-lookup"><span data-stu-id="8305b-129">Windows provides default entries, such as Windows Internet Explorer, and the user can add any further shortcuts that they choose.</span></span> <span data-ttu-id="8305b-130">此區域中的圖示只會回應按一下。</span><span class="sxs-lookup"><span data-stu-id="8305b-130">Icons in this area respond to a single click.</span></span> <span data-ttu-id="8305b-131">在 Windows 7 和更新版本中，這項功能包含在工作列按鈕中。</span><span class="sxs-lookup"><span data-stu-id="8305b-131">In Windows 7 and later, this functionality is included in the taskbar buttons.</span></span>

<span data-ttu-id="8305b-132">每當應用程式建立無主視窗（也就是沒有父代且具有適當擴充樣式位的視窗）時，Shell 會在工作列上放置一個按鈕 (請參閱 [管理工作列按鈕](#managing-taskbar-buttons)，如下) 。</span><span class="sxs-lookup"><span data-stu-id="8305b-132">The Shell places a button on the taskbar whenever an application creates an unowned window—that is, a window that does not have a parent and that has the appropriate extended style bits (see [Managing Taskbar Buttons](#managing-taskbar-buttons), below).</span></span> <span data-ttu-id="8305b-133">若要切換至視窗，使用者可以按一下視窗按鈕。</span><span class="sxs-lookup"><span data-stu-id="8305b-133">To switch to a window, the user clicks its window button.</span></span> <span data-ttu-id="8305b-134">從 Windows 7 起，這項功能已經大幅擴充。</span><span class="sxs-lookup"><span data-stu-id="8305b-134">This functionality has been greatly expanded as of Windows 7.</span></span> <span data-ttu-id="8305b-135">如需詳細資訊，請參閱 [工作列擴充](taskbar-extensions.md)功能。</span><span class="sxs-lookup"><span data-stu-id="8305b-135">For more information, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

<span data-ttu-id="8305b-136">應用程式可以將圖示放在通知區域中，以指出作業的狀態，或通知使用者有關事件的狀態。</span><span class="sxs-lookup"><span data-stu-id="8305b-136">Applications can put icons in the notification area to indicate the status of an operation or to notify the user about an event.</span></span> <span data-ttu-id="8305b-137">例如，應用程式可能會在通知區域中放置印表機圖示，以顯示列印工作正在進行中。</span><span class="sxs-lookup"><span data-stu-id="8305b-137">For example, an application might put a printer icon in the notification area to show that a print job is under way.</span></span> <span data-ttu-id="8305b-138">不過，在 Windows 7 和更新版本中，某些先前由通知區域提供的資訊，應該透過應用程式的工作列按鈕提供。</span><span class="sxs-lookup"><span data-stu-id="8305b-138">However, in Windows 7 and later, some of the information previously provided by the notification area should be provided through an application's taskbar button.</span></span> <span data-ttu-id="8305b-139">通知區域位於工作列的右邊緣 (如果工作列為水準) ，或如果工作列垂直) ，則位於底部 (。</span><span class="sxs-lookup"><span data-stu-id="8305b-139">The notification area is located at the right edge of the taskbar (if the taskbar is horizontal) or at the bottom (if the taskbar is vertical).</span></span> <span data-ttu-id="8305b-140">如需詳細資訊，請參閱 [通知和通知區域](notification-area.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-140">For more information, see [Notifications and the Notification Area](notification-area.md).</span></span>

<span data-ttu-id="8305b-141">如果選取此選項，通知區域也會顯示目前的時間。</span><span class="sxs-lookup"><span data-stu-id="8305b-141">The notification area also displays the current time if that option is selected.</span></span> <span data-ttu-id="8305b-142">此選項會找到：</span><span class="sxs-lookup"><span data-stu-id="8305b-142">The option is found as:</span></span>

-   <span data-ttu-id="8305b-143">**Windows 7 和更新版本**：**通知區域圖示** 的 [**開啟或關閉系統圖示**] 頁面中的 [**時鐘**] 下拉式清單主控台應用程式 (也可透過 [通知] 區域屬性) 存取。</span><span class="sxs-lookup"><span data-stu-id="8305b-143">**Windows 7 and later**: The **Clock** drop-down list in the **Turn system icons on or off** page of the **Notification Area Icons** Control Panel application (also accessible through the notification area properties).</span></span>
-   <span data-ttu-id="8305b-144">**Windows Vista**： [**工作列] 和 [開始] 功能表**[屬性] 視窗的 [通知]**區域** 頁面中的 [**時鐘**] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="8305b-144">**Windows Vista**: The **Clock** check box in the **Notification Area** page of the **Taskbar and Start Menu** properties window.</span></span>
-   <span data-ttu-id="8305b-145">**WINDOWS XP**： [**工作列] 和 [開始功能表** 屬性] 視窗中的 [**顯示時鐘**] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="8305b-145">**Windows XP**: The **Show the clock** check box in the **Taskbar and Start Menu** properties window.</span></span>

<span data-ttu-id="8305b-146">使用者可以在工作列上按一下滑鼠右鍵，以顯示快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="8305b-146">The user can right-click the taskbar to display the shortcut menu.</span></span> <span data-ttu-id="8305b-147">快捷方式功能表包含了串聯視窗、堆疊視窗、並排顯示視窗、顯示桌面、開始工作管理員以及設定工作列屬性的命令。</span><span class="sxs-lookup"><span data-stu-id="8305b-147">The shortcut menu includes commands to cascade windows, stack windows, show windows side-by-side, show the desktop, start Task Manager, and set taskbar properties.</span></span> <span data-ttu-id="8305b-148">快速鍵功能表也提供選項，可讓您從工作列新增或移除一組工具列。</span><span class="sxs-lookup"><span data-stu-id="8305b-148">The shortcut menu also provides the option to add or remove a set of toolbars from the taskbar.</span></span> <span data-ttu-id="8305b-149">您可以藉由在 CATID DeskBand 類別下註冊，將新的工具列新增至這個功能表中 \_ 。</span><span class="sxs-lookup"><span data-stu-id="8305b-149">You can add new toolbars to this menu by registering them under the CATID\_DeskBand category.</span></span> <span data-ttu-id="8305b-150">如需詳細資訊，請參閱 [執行頻外物件](band-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-150">For more information, see [Implementing Band Objects](band-objects.md).</span></span> <span data-ttu-id="8305b-151">請注意，從 Windows 7，工作列和通知區域都有個別的快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="8305b-151">Note that as of Windows 7, the taskbar and the notification area have separate shortcut menus.</span></span> <span data-ttu-id="8305b-152">這些快捷方式功能表會共用一些選項，例如視窗排列，並加入其他選項。</span><span class="sxs-lookup"><span data-stu-id="8305b-152">These shortcut menus share some options, such as window arrangement, and add others.</span></span>

### <a name="taskbar-display-options"></a><span data-ttu-id="8305b-153">工作列顯示選項</span><span class="sxs-lookup"><span data-stu-id="8305b-153">Taskbar Display Options</span></span>

<span data-ttu-id="8305b-154">工作列支援兩種顯示選項：自動隱藏，而且只有在 Windows Vista 和較早的版本中，Always On 頂端 (工作列在 Windows 7 和更新版本的) 中一律處於此模式。</span><span class="sxs-lookup"><span data-stu-id="8305b-154">The taskbar supports two display options: Auto-Hide and, in Windows Vista and earlier only, Always On Top (the taskbar is always in this mode in Windows 7 and later).</span></span> <span data-ttu-id="8305b-155">若要設定這些選項，使用者必須開啟工作列快捷方式功能表，按一下 [ **屬性**]，然後選取或清除 [ **自動隱藏工作列** ] 核取方塊或 [ **將工作列保持在其他視窗上方** ] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="8305b-155">To set these options, the user must open the taskbar shortcut menu, click **Properties**, and select or clear the **Auto-hide the taskbar** check box or the **Keep the taskbar on top of other windows** check box.</span></span> <span data-ttu-id="8305b-156">若要取得這些顯示選項的狀態，請使用 [**ABM \_ >getstate**](abm-getstate.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-156">To retrieve the state of these display options, use the [**ABM\_GETSTATE**](abm-getstate.md) message.</span></span> <span data-ttu-id="8305b-157">如果您想要在這些顯示選項的狀態變更時收到通知，請在您的視窗程式中處理 [**ABN \_ STATECHANGE**](abn-statechange.md) 通知訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-157">If you would like to be notified when the state of these display options changes, process the [**ABN\_STATECHANGE**](abn-statechange.md) notification message in your window procedure.</span></span> <span data-ttu-id="8305b-158">若要變更這些顯示選項的狀態，請使用 [**ABM \_ SETSTATE**](abm-setstate.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-158">To change the state of these display options, use the [**ABM\_SETSTATE**](abm-setstate.md) message.</span></span>

<span data-ttu-id="8305b-159">*工作區* 是工作列未遮蔽的畫面部分。</span><span class="sxs-lookup"><span data-stu-id="8305b-159">The *work area* is the portion of the screen not obscured by the taskbar.</span></span> <span data-ttu-id="8305b-160">若要取得工作區域的大小，請使用已設定的 **SPI \_ GETWORKAREA** 值來呼叫 [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa)函式。</span><span class="sxs-lookup"><span data-stu-id="8305b-160">To retrieve the size of the work area, call the [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) function with the **SPI\_GETWORKAREA** value set.</span></span> <span data-ttu-id="8305b-161">若要取出描述工作列位置的矩形座標，請使用 [**ABM \_ GETTASKBARPOS**](abm-gettaskbarpos.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-161">To retrieve the rectangle coordinates that describe the location of the taskbar, use the [**ABM\_GETTASKBARPOS**](abm-gettaskbarpos.md) message.</span></span>

<span data-ttu-id="8305b-162">您可以使用 [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos)，明確地設定等於畫面大小的視窗矩形大小，以涵蓋工作列。</span><span class="sxs-lookup"><span data-stu-id="8305b-162">It is possible to cover the taskbar by explicitly setting the size of the window rectangle equal to the size of the screen with [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span></span> <span data-ttu-id="8305b-163">若為 Windows 2000 系統或更新版本，視窗必須要有 [**ws \_ 標題**](../winmsg/window-styles.md) 或 [**ws \_ THICKFRAME**](../winmsg/window-styles.md)，否則視窗必須調整大小，才能讓工作區涵蓋整個畫面。</span><span class="sxs-lookup"><span data-stu-id="8305b-163">For Windows 2000 systems or later, the window must lack either [**WS\_CAPTION**](../winmsg/window-styles.md) or [**WS\_THICKFRAME**](../winmsg/window-styles.md), or else the window must be sized so that the client area covers the entire screen.</span></span> <span data-ttu-id="8305b-164">也特別是對於這些系統而言，如果工作列設定為 Always On Top，則只有在應用程式是前景應用程式時，它才會保持隱藏。</span><span class="sxs-lookup"><span data-stu-id="8305b-164">Also particular to those systems, if the taskbar is set to Always On Top, it will remain hidden only while the application is the foreground application.</span></span>

### <a name="adding-shortcuts-to-the-start-menu"></a><span data-ttu-id="8305b-165">將快捷方式新增至 [開始] 功能表</span><span class="sxs-lookup"><span data-stu-id="8305b-165">Adding Shortcuts to the Start Menu</span></span>

<span data-ttu-id="8305b-166">若要將專案新增至 Microsoft Windows NT 4.0、Windows 2000 和更新版本或 Windows 95 或更新版本上的 [ **程式** ] 子功能表，請遵循下列步驟。</span><span class="sxs-lookup"><span data-stu-id="8305b-166">To add an item to the **Programs** submenu on Microsoft Windows NT 4.0, Windows 2000 and later, or Windows 95 or later, follow these steps.</span></span>

1.  <span data-ttu-id="8305b-167">使用 [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka)介面建立 [shell 連結](./links.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-167">Create a [shell link](./links.md) by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface.</span></span>
2.  <span data-ttu-id="8305b-168">使用 [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation)傳遞 [**CSIDL \_ 程式**](csidl.md)，以取得 [程式] 資料夾的 PIDL。</span><span class="sxs-lookup"><span data-stu-id="8305b-168">Obtain the PIDL of the Programs folder by using [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passing [**CSIDL\_PROGRAMS**](csidl.md).</span></span>
3.  <span data-ttu-id="8305b-169">將 Shell 連結新增至 [程式] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="8305b-169">Add the Shell link to the Programs folder.</span></span> <span data-ttu-id="8305b-170">您也可以在 [程式] 資料夾中建立資料夾，並將連結新增至該資料夾。</span><span class="sxs-lookup"><span data-stu-id="8305b-170">You can also create a folder in the Programs folder and add the link to that folder.</span></span>

### <a name="managing-taskbar-buttons"></a><span data-ttu-id="8305b-171">管理工作列按鈕</span><span class="sxs-lookup"><span data-stu-id="8305b-171">Managing Taskbar Buttons</span></span>

<span data-ttu-id="8305b-172">每當應用程式建立不是所擁有的視窗時，Shell 會在工作列上建立一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="8305b-172">The Shell creates a button on the taskbar whenever an application creates a window that isn't owned.</span></span> <span data-ttu-id="8305b-173">若要確定視窗按鈕是放置在工作列上，請建立具有 [**WS \_ EX \_ APPWINDOW**](../winmsg/extended-window-styles.md) 延伸樣式的無主視窗。</span><span class="sxs-lookup"><span data-stu-id="8305b-173">To ensure that the window button is placed on the taskbar, create an unowned window with the [**WS\_EX\_APPWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="8305b-174">若要防止視窗按鈕放在工作列上，請建立具有 [**WS \_ EX \_ 工具視窗**](../winmsg/extended-window-styles.md) 延伸樣式的無主視窗。</span><span class="sxs-lookup"><span data-stu-id="8305b-174">To prevent the window button from being placed on the taskbar, create the unowned window with the [**WS\_EX\_TOOLWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="8305b-175">或者，您也可以建立隱藏的視窗，讓這個隱藏視窗成為可見視窗的擁有者。</span><span class="sxs-lookup"><span data-stu-id="8305b-175">As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.</span></span>

<span data-ttu-id="8305b-176">只有當視窗的樣式支援可見的工作列按鈕時，Shell 才會從工作列移除視窗的按鈕。</span><span class="sxs-lookup"><span data-stu-id="8305b-176">The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons.</span></span> <span data-ttu-id="8305b-177">如果您想要以動態方式將視窗的樣式變更為不支援可見工作列按鈕的樣式，您必須使用 [ **SW \_ 隱藏**) ] 來呼叫 [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) 、變更視窗樣式，然後顯示視窗，以將視窗的樣式隱藏在第一個 (。</span><span class="sxs-lookup"><span data-stu-id="8305b-177">If you want to dynamically change a window's style to one that does not support visible taskbar buttons, you must hide the window first (by calling [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) with **SW\_HIDE**), change the window style, and then show the window.</span></span>

<span data-ttu-id="8305b-178">視窗按鈕通常會包含應用程式圖示和標題。</span><span class="sxs-lookup"><span data-stu-id="8305b-178">The window button typically contains the application icon and title.</span></span> <span data-ttu-id="8305b-179">但是，如果應用程式不包含系統功能表，則會建立沒有圖示的視窗按鈕。</span><span class="sxs-lookup"><span data-stu-id="8305b-179">However, if the application does not contain a system menu, the window button is created without the icon.</span></span>

<span data-ttu-id="8305b-180">如果您想要讓應用程式在視窗非使用中時讓使用者注意，請使用 [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) 函數讓使用者知道訊息正在等候。</span><span class="sxs-lookup"><span data-stu-id="8305b-180">If you want your application to get the user's attention when the window is not active, use the [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) function to let the user know that a message is waiting.</span></span> <span data-ttu-id="8305b-181">此函式會將視窗按鈕閃爍。</span><span class="sxs-lookup"><span data-stu-id="8305b-181">This function flashes the window button.</span></span> <span data-ttu-id="8305b-182">當使用者按一下 [視窗] 按鈕以啟動視窗時，您的應用程式就會顯示訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-182">Once the user clicks the window button to activate the window, your application can display the message.</span></span>

### <a name="modifying-the-contents-of-the-taskbar"></a><span data-ttu-id="8305b-183">修改工作列的內容</span><span class="sxs-lookup"><span data-stu-id="8305b-183">Modifying the Contents of the Taskbar</span></span>

<span data-ttu-id="8305b-184">Shell32.dll [4.71 版和更新版本](versions.md)新增了修改工作列內容的功能。</span><span class="sxs-lookup"><span data-stu-id="8305b-184">[Version 4.71 and later](versions.md) of Shell32.dll adds the capability to modify the contents of the taskbar.</span></span> <span data-ttu-id="8305b-185">您現在可以從應用程式新增、移除和啟動工作列按鈕。</span><span class="sxs-lookup"><span data-stu-id="8305b-185">From an application, you can now add, remove, and activate taskbar buttons.</span></span> <span data-ttu-id="8305b-186">啟用專案並不會啟動視窗;它會顯示在工作列上按下的專案。</span><span class="sxs-lookup"><span data-stu-id="8305b-186">Activating the item does not activate the window; it shows the item as pressed on the taskbar.</span></span>

<span data-ttu-id="8305b-187">工作列修改功能是在元件物件模型中執行， (COM) 物件 (CLSID \_ TaskbarList ) ，它會公開 [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) 介面 (IID \_ ITaskbarList) 。</span><span class="sxs-lookup"><span data-stu-id="8305b-187">The taskbar modification capabilities are implemented in a Component Object Model (COM) object (CLSID\_TaskbarList ) that exposes the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface (IID\_ITaskbarList).</span></span> <span data-ttu-id="8305b-188">您必須呼叫 [**ITaskbarList：： HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) 方法來初始化物件。</span><span class="sxs-lookup"><span data-stu-id="8305b-188">You must call the [**ITaskbarList::HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) method to initialize the object.</span></span> <span data-ttu-id="8305b-189">然後，您可以使用 [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) 介面的方法來修改工作列的內容。</span><span class="sxs-lookup"><span data-stu-id="8305b-189">You can then use the methods of the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface to modify the contents of the taskbar.</span></span>

### <a name="adding-modifying-and-deleting-icons-in-the-notification-area"></a><span data-ttu-id="8305b-190">新增、修改和刪除通知區域中的圖示</span><span class="sxs-lookup"><span data-stu-id="8305b-190">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>

<span data-ttu-id="8305b-191">使用 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) 函式來新增、修改或刪除通知區域中的圖示。</span><span class="sxs-lookup"><span data-stu-id="8305b-191">Use the [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) function to add, modify, or delete icons from the notification area.</span></span> <span data-ttu-id="8305b-192">**Shell \_ NotifyIcon** 的 *dwMessage* 參數是用來指定要採取之動作的工作列訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-192">The *dwMessage* parameter of **Shell\_NotifyIcon** is a message to the taskbar that specifies the action to be taken.</span></span> <span data-ttu-id="8305b-193">*Pnid* 參數是 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)結構的指標，用來識別圖示並傳遞系統處理訊息所需的任何其他資訊。</span><span class="sxs-lookup"><span data-stu-id="8305b-193">The *pnid* parameter is a pointer to a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure that is used to identify the icon and pass any additional information that is needed for the system to process the message.</span></span>

<span data-ttu-id="8305b-194">您可以使用通知區域圖示來執行下列動作。</span><span class="sxs-lookup"><span data-stu-id="8305b-194">You can perform the following actions with notification area icons.</span></span>

-   <span data-ttu-id="8305b-195">若要將圖示加入至工作列的通知區域，請呼叫 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *DWMESSAGE* 參數設定為 NIM \_ add。</span><span class="sxs-lookup"><span data-stu-id="8305b-195">To add an icon to the taskbar's notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_ADD.</span></span> <span data-ttu-id="8305b-196">[**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)結構是用來指定圖示的控制碼和識別碼，以及任何工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="8305b-196">The [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure is used to specify the icon's handle and identifier, and any tooltip text.</span></span> <span data-ttu-id="8305b-197">如果使用者已在工作列內容中選取 [ **顯示時鐘** ] 核取方塊，系統就會將圖示放在時鐘的最左邊。</span><span class="sxs-lookup"><span data-stu-id="8305b-197">If the user has selected the **Show Clock** check box in the taskbar properties, the system places the icon to the immediate left of the clock.</span></span> <span data-ttu-id="8305b-198">否則，圖示會出現在工作列的右側或底部。</span><span class="sxs-lookup"><span data-stu-id="8305b-198">Otherwise, the icon appears on the right side or at the bottom of the taskbar.</span></span> <span data-ttu-id="8305b-199">任何現有的圖示都會向左移動，以騰出空間給新的圖示。</span><span class="sxs-lookup"><span data-stu-id="8305b-199">Any existing icons are shifted to the left to make room for the new icon.</span></span>
-   <span data-ttu-id="8305b-200">若要修改圖示的資訊，包括其圖示控制碼、工具提示文字和回呼訊息識別碼，請呼叫 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *dwMessage* 設定為 NIM \_ modify。</span><span class="sxs-lookup"><span data-stu-id="8305b-200">To modify an icon's information, including its icon handle, tooltip text, and callback message identifier, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_MODIFY.</span></span>
-   <span data-ttu-id="8305b-201">若要刪除通知區域中的圖示，請呼叫 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *DWMESSAGE* 參數設定為 NIM \_ delete。</span><span class="sxs-lookup"><span data-stu-id="8305b-201">To delete an icon from the notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_DELETE.</span></span>

<span data-ttu-id="8305b-202">當您完成使用者介面作業之後，請呼叫 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *dwMessage* 設定為 NIM SETFOCUS，以將焦點傳回至通知區域 \_ 。</span><span class="sxs-lookup"><span data-stu-id="8305b-202">When you have completed a user interface operation, return focus to the notification area by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_SETFOCUS.</span></span> <span data-ttu-id="8305b-203">例如，您可以在工作列圖示顯示快捷方式功能表時這麼做，但使用者按下 ESC 鍵即可取消。</span><span class="sxs-lookup"><span data-stu-id="8305b-203">For example, you could do this when a taskbar icon displays a shortcut menu, but the user cancels it by pressing the ESCAPE key.</span></span>

### <a name="receiving-notification-area-callback-messages"></a><span data-ttu-id="8305b-204">接收通知區域回呼訊息</span><span class="sxs-lookup"><span data-stu-id="8305b-204">Receiving Notification Area Callback Messages</span></span>

<span data-ttu-id="8305b-205">應用程式通常會將圖示放在工作列的通知區域中，以做為狀態指示器。</span><span class="sxs-lookup"><span data-stu-id="8305b-205">Applications commonly put icons in the notification area of the taskbar to serve as status indicators.</span></span> <span data-ttu-id="8305b-206">您可以在使用者執行滑鼠動作時提供其他資訊，例如將滑鼠指標移到圖示上方或按一下圖示。</span><span class="sxs-lookup"><span data-stu-id="8305b-206">You can provide additional information when the user performs mouse actions, such as moving the mouse pointer over the icon or clicking the icon.</span></span>

<span data-ttu-id="8305b-207">系統會傳送與特定圖示相關聯的應用程式定義回呼訊息，以通知您滑鼠和鍵盤事件。</span><span class="sxs-lookup"><span data-stu-id="8305b-207">The system notifies you of mouse and keyboard events by sending an application-defined callback message that is associated with a particular icon.</span></span> <span data-ttu-id="8305b-208">如此一來，當使用者按一下圖示或按下按鍵選取圖示時，系統就可以通知應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-208">In this way, the system can notify an application when the user, for instance, clicks the icon or selects it by pressing a key.</span></span>

<span data-ttu-id="8305b-209">當您將圖示新增至工作列時，您會定義圖示的回呼訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-209">You define an icon's callback message when you add the icon to the taskbar.</span></span> <span data-ttu-id="8305b-210">回呼訊息識別碼是在以 NIM ADD 傳遞的 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)結構的 **uCallbackMessage** 成員中指定 \_ 。</span><span class="sxs-lookup"><span data-stu-id="8305b-210">The callback message identifier is specified in the **uCallbackMessage** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure passed with NIM\_ADD.</span></span> <span data-ttu-id="8305b-211">當事件發生時，系統會將回呼訊息傳送至 **hWnd** 成員所指定視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-211">When an event occurs, the system sends the callback message to the window procedure of the window specified by the **hWnd** member.</span></span> <span data-ttu-id="8305b-212">訊息的 *wParam* 參數包含發生事件的工作列圖示識別碼。</span><span class="sxs-lookup"><span data-stu-id="8305b-212">The *wParam* parameter of the message contains the identifier of the taskbar icon in which the event occurred.</span></span> <span data-ttu-id="8305b-213">*LParam* 參數會保存與事件相關聯的滑鼠或鍵盤訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-213">The *lParam* parameter holds the mouse or keyboard message associated with the event.</span></span> <span data-ttu-id="8305b-214">例如，當滑鼠指標移至工作列圖示時， *lParam* 會包含 [**WM \_ MOUSEMOVE**](../inputdev/wm-mousemove.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-214">For example, when the mouse pointer moves onto a taskbar icon, *lParam* contains [**WM\_MOUSEMOVE**](../inputdev/wm-mousemove.md).</span></span>

<span data-ttu-id="8305b-215">各種滑鼠事件的結果可摘要如下：</span><span class="sxs-lookup"><span data-stu-id="8305b-215">The results of various mouse events can be summarized as follows:</span></span>

-   <span data-ttu-id="8305b-216">當使用者將滑鼠指標移到圖示上方時，系統會顯示 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)中所指定的工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="8305b-216">When the user moves the mouse pointer over the icon, the system displays the tooltip text that was specified in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span></span>
-   <span data-ttu-id="8305b-217">當使用者按一下圖示時，您的應用程式會收到 [**WM \_ LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="8305b-217">When the user clicks the icon, your application receives a [**WM\_LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) notification.</span></span>
-   <span data-ttu-id="8305b-218">當使用者以滑鼠右鍵按一下圖示時，您的應用程式會收到 [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="8305b-218">When the user right-clicks the icon, your application receives a [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) notification.</span></span>
-   <span data-ttu-id="8305b-219">當使用者按兩下該圖示時，您的應用程式會收到 [**WM \_ LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="8305b-219">When the user double-clicks the icon, your application receives a [**WM\_LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) notification.</span></span>

<span data-ttu-id="8305b-220">一般而言，按一下圖示會導致應用程式顯示具有其他資訊的視窗，以滑鼠右鍵按一下以顯示快捷方式功能表，然後按兩下 [執行預設快捷方式功能表] 命令。</span><span class="sxs-lookup"><span data-stu-id="8305b-220">Typically, clicking the icon causes the application to display a window with additional information, right-clicking displays a shortcut menu, and double-clicking executes the default shortcut menu command.</span></span>

<span data-ttu-id="8305b-221">如需如何變更與通知區域圖示相關聯的工具提示文字的範例，請參閱 [狀態列圖示的氣球工具提示](../controls/tooltip-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="8305b-221">For an example of how to change the tooltip text associated with a notification area icon, see [Balloon Tooltips for Status Bar Icons](../controls/tooltip-controls.md).</span></span>

<span data-ttu-id="8305b-222">Shell 的5.0 版和更新版本會以不同的方式來 [**\_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) 滑鼠和鍵盤事件，而不像舊版的 shell 版本 Windows NT 4.0、Windows 95 和 Windows 98。</span><span class="sxs-lookup"><span data-stu-id="8305b-222">Versions 5.0 and later of the Shell handle [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) mouse and keyboard events in different ways than earlier Shell versions found on Windows NT 4.0, Windows 95, and Windows 98.</span></span> <span data-ttu-id="8305b-223">差異如下：</span><span class="sxs-lookup"><span data-stu-id="8305b-223">The differences are as follows:</span></span>

-   <span data-ttu-id="8305b-224">如果使用者向鍵盤要求通知圖示的快捷方式功能表，5.0 版 Shell 會傳送一個 [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) 訊息給相關聯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-224">If a user requests a notify icon's shortcut menu with the keyboard, the version 5.0 Shell sends the associated application a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message.</span></span> <span data-ttu-id="8305b-225">舊版會傳送 [**wm \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) 和 [**wm \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-225">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="8305b-226">如果使用者使用鍵盤選取 [通知] 圖示，並以空格鍵或 ENTER 鍵啟動它，則5.0 版 Shell 會將 **>nin \_ KEYSELECT** 通知傳送給相關聯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-226">If a user selects a notify icon with the keyboard and activates it with the space bar or ENTER key, the version 5.0 Shell sends the associated application an **NIN\_KEYSELECT** notification.</span></span> <span data-ttu-id="8305b-227">舊版會傳送 [**wm \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) 和 [**wm \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-227">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="8305b-228">如果使用者使用滑鼠選取 [通知] 圖示，並使用 ENTER 鍵啟動它，則5.0 版 Shell 會傳送 **>nin \_ SELECT** 通知給相關聯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-228">If a user selects a notify icon with the mouse and activates it with the ENTER key, the version 5.0 Shell sends the associated application an **NIN\_SELECT** notification.</span></span> <span data-ttu-id="8305b-229">舊版會傳送 [**wm \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) 和 [**wm \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-229">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="8305b-230">如果使用者將滑鼠指標移到與氣球工具提示相關聯的圖示上，版本 6.0 Shell (Windows XP) 傳送下列訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-230">If a user passes the mouse pointer over an icon with which a balloon tooltip is associated, the version 6.0 Shell (Windows XP)sends the following messages.</span></span>
    -   -   <span data-ttu-id="8305b-231">**>nin \_BALLOONSHOW** -在顯示氣球時傳送 (球標排入佇列) 。</span><span class="sxs-lookup"><span data-stu-id="8305b-231">**NIN\_BALLOONSHOW** - Sent when the balloon is shown (balloons are queued).</span></span>
        -   <span data-ttu-id="8305b-232">**>nin \_BALLOONHIDE** -當氣球消失時傳送，例如，當刪除圖示時。</span><span class="sxs-lookup"><span data-stu-id="8305b-232">**NIN\_BALLOONHIDE** - Sent when the balloon disappears—for example, when the icon is deleted.</span></span> <span data-ttu-id="8305b-233">如果因為超時或按下滑鼠，而關閉球標，則不會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-233">This message is not sent if the balloon is dismissed because of a timeout or a mouse click.</span></span>
        -   <span data-ttu-id="8305b-234">**>nin \_BALLOONTIMEOUT** -當氣球因為 timeout 而關閉時傳送。</span><span class="sxs-lookup"><span data-stu-id="8305b-234">**NIN\_BALLOONTIMEOUT** - Sent when the balloon is dismissed because of a timeout.</span></span>
        -   <span data-ttu-id="8305b-235">**>nin \_BALLOONUSERCLICK** -當氣球因為滑鼠按一下而關閉時傳送。</span><span class="sxs-lookup"><span data-stu-id="8305b-235">**NIN\_BALLOONUSERCLICK** - Sent when the balloon is dismissed because of a mouse click.</span></span>

<span data-ttu-id="8305b-236">您可以藉由呼叫 [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *dwMessage* 設定為 **NIM \_ SETVERSION**，來選取 shell 的行為方式。</span><span class="sxs-lookup"><span data-stu-id="8305b-236">You can select which way the Shell should behave by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_SETVERSION**.</span></span> <span data-ttu-id="8305b-237">設定 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)結構的 **uVersion** 成員，以指出您是否想要5.0 版或5.0 版之前的行為。</span><span class="sxs-lookup"><span data-stu-id="8305b-237">Set the **uVersion** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure to indicate whether you want version 5.0 or pre-version 5.0 behavior.</span></span>

### <a name="taskbar-creation-notification"></a><span data-ttu-id="8305b-238">工作列建立通知</span><span class="sxs-lookup"><span data-stu-id="8305b-238">Taskbar Creation Notification</span></span>

<span data-ttu-id="8305b-239">使用 Microsoft Internet Explorer 4.0 和更新版本時，Shell 會通知應用程式已建立工作列。</span><span class="sxs-lookup"><span data-stu-id="8305b-239">With Microsoft Internet Explorer 4.0 and later, the Shell notifies applications that the taskbar has been created.</span></span> <span data-ttu-id="8305b-240">當工作列建立時，它會向 TaskbarCreated 字串註冊訊息，然後將此訊息廣播到所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="8305b-240">When the taskbar is created, it registers a message with the TaskbarCreated string and then broadcasts this message to all top-level windows.</span></span> <span data-ttu-id="8305b-241">當工作列應用程式接收到此訊息時，應假設它所新增的任何工作列圖示都已移除，並再次新增。</span><span class="sxs-lookup"><span data-stu-id="8305b-241">When your taskbar application receives this message, it should assume that any taskbar icons it added have been removed and add them again.</span></span> <span data-ttu-id="8305b-242">這項功能通常僅適用于 Shell 啟動時已在執行中的服務。</span><span class="sxs-lookup"><span data-stu-id="8305b-242">This feature generally applies only to services that are already running when the Shell launches.</span></span> <span data-ttu-id="8305b-243">下列範例顯示非常簡單的方法來處理此案例。</span><span class="sxs-lookup"><span data-stu-id="8305b-243">The following example shows a very simplified method for handling this case.</span></span>

<span data-ttu-id="8305b-244">在 Windows 10 上，當主顯示器的 DPI 變更時，工作列也會廣播此訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-244">On Windows 10, the taskbar also broadcasts this message when the DPI of the primary display changes.</span></span>

```
LRESULT CALLBACK WndProc(HWND hWnd, 
                         UINT uMessage, 
                         WPARAM wParam, 
                         LPARAM lParam)
{
    static UINT s_uTaskbarRestart;

    switch(uMessage)
    {
        case WM_CREATE:
            s_uTaskbarRestart = RegisterWindowMessage(TEXT("TaskbarCreated"));
            break;
        
        default:
            if(uMessage == s_uTaskbarRestart)
                AddTaskbarIcons();
            break;
    }

    return DefWindowProc(hWnd, uMessage, wParam, lParam);
}
```



## <a name="using-the-taskbar"></a><span data-ttu-id="8305b-245">使用工作列</span><span class="sxs-lookup"><span data-stu-id="8305b-245">Using the Taskbar</span></span>

<span data-ttu-id="8305b-246">本章節包含的範例將示範如何將圖示加入工作列通知區域，以及如何處理工作列圖示的回呼訊息。</span><span class="sxs-lookup"><span data-stu-id="8305b-246">This section includes examples that demonstrate how to add icons to the taskbar notification area and how to process callback messages for taskbar icons.</span></span>

### <a name="adding-and-deleting-taskbar-icons-in-the-notification-area"></a><span data-ttu-id="8305b-247">新增和刪除通知區域中的工作列圖示</span><span class="sxs-lookup"><span data-stu-id="8305b-247">Adding and Deleting Taskbar Icons in the Notification Area</span></span>

<span data-ttu-id="8305b-248">您可以藉由填妥 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) 結構，然後將結構傳遞給 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) ，並將 *dwMessage* 設定為 **NIM \_ add**，將圖示加入工作列通知區域中。</span><span class="sxs-lookup"><span data-stu-id="8305b-248">You add an icon to the taskbar notification area by filling in a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and then passing the structure to [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_ADD**.</span></span> <span data-ttu-id="8305b-249">結構成員必須指定要加入圖示的視窗控制碼，以及圖示識別碼和圖示控制碼。</span><span class="sxs-lookup"><span data-stu-id="8305b-249">The structure members must specify the handle to the window that is adding the icon, as well as the icon identifier and icon handle.</span></span> <span data-ttu-id="8305b-250">您也可以指定圖示的工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="8305b-250">You can also specify tooltip text for the icon.</span></span> <span data-ttu-id="8305b-251">如果您需要接收圖示的滑鼠訊息，請指定系統應該用來將訊息傳送至視窗程式之回呼訊息的識別碼。</span><span class="sxs-lookup"><span data-stu-id="8305b-251">If you need to receive mouse messages for the icon, specify the identifier of the callback message that the system should use to send the message to the window procedure.</span></span>

<span data-ttu-id="8305b-252">下列範例中的函式示範如何將圖示加入至工作列。</span><span class="sxs-lookup"><span data-stu-id="8305b-252">The function in the following example demonstrates how to add an icon to the taskbar.</span></span>


```
// MyTaskBarAddIcon - adds an icon to the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window to receive callback messages 
// uID - identifier of the icon 
// hicon - handle to the icon to add 
// lpszTip - tooltip text 

BOOL MyTaskBarAddIcon(HWND hwnd, UINT uID, HICON hicon, LPSTR lpszTip) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
    tnid.uFlags = NIF_MESSAGE | NIF_ICON | NIF_TIP; 
    tnid.uCallbackMessage = MYWM_NOTIFYICON; 
    tnid.hIcon = hicon; 
    if (lpszTip) 
        hr = StringCbCopyN(tnid.szTip, sizeof(tnid.szTip), lpszTip, 
                           sizeof(tnid.szTip));
        // TODO: Add error handling for the HRESULT.
    else 
        tnid.szTip[0] = (TCHAR)'\0'; 
 
    res = Shell_NotifyIcon(NIM_ADD, &tnid); 
 
    if (hicon) 
        DestroyIcon(hicon); 
 
    return res; 
}
```



<span data-ttu-id="8305b-253">若要刪除工作列通知區域中的圖示，請填妥 [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa)結構，並將 *DwMessage* 設定為 **NIM \_ delete** 來呼叫 [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) 。</span><span class="sxs-lookup"><span data-stu-id="8305b-253">To delete an icon from the taskbar notification area, fill a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_DELETE**.</span></span> <span data-ttu-id="8305b-254">刪除工作列圖示時，請只指定結構的 **cbSize**、 **hWnd** 和 **uID** 成員。</span><span class="sxs-lookup"><span data-stu-id="8305b-254">When deleting a taskbar icon, specify only the **cbSize**, **hWnd**, and **uID** members of the structure.</span></span> <span data-ttu-id="8305b-255">例如：</span><span class="sxs-lookup"><span data-stu-id="8305b-255">For example:</span></span>


```
// MyTaskBarDeleteIcon - deletes an icon from the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window that added the icon. 
// uID - identifier of the icon to delete. 

BOOL MyTaskBarDeleteIcon(HWND hwnd, UINT uID) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
         
    res = Shell_NotifyIcon(NIM_DELETE, &tnid); 
    return res; 
}
```



### <a name="receiving-mouse-events"></a><span data-ttu-id="8305b-256">接收滑鼠事件</span><span class="sxs-lookup"><span data-stu-id="8305b-256">Receiving Mouse Events</span></span>

<span data-ttu-id="8305b-257">如果您指定工作列圖示的回呼訊息，系統會在圖示的周框中出現滑鼠事件時，將訊息傳送至您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-257">If you specify a callback message for a taskbar icon, the system sends the message to your application whenever a mouse event occurs in the icon's bounding rectangle.</span></span> <span data-ttu-id="8305b-258">訊息的 *wParam* 參數會指定工作列圖示的識別碼，而訊息的 *lParam* 參數會指定系統產生的訊息，作為滑鼠事件的結果。</span><span class="sxs-lookup"><span data-stu-id="8305b-258">The *wParam* parameter of the message specifies the identifier of the taskbar icon, and the *lParam* parameter of the message specifies the message that the system generated as a result of the mouse event.</span></span>

<span data-ttu-id="8305b-259">下列範例中的函式來自于將電池和印表機圖示新增至工作列的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8305b-259">The function in the following example is from an application that adds both battery and printer icons to the taskbar.</span></span> <span data-ttu-id="8305b-260">應用程式會在收到回呼訊息時呼叫函數。</span><span class="sxs-lookup"><span data-stu-id="8305b-260">The application calls the function when it receives a callback message.</span></span> <span data-ttu-id="8305b-261">此函式會判斷使用者是否已按下其中一個圖示，如果出現 click，則會呼叫應用程式定義的函式來顯示狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="8305b-261">The function determines whether the user has clicked one of the icons and, if a click has occurred, calls an application-defined function to display status information.</span></span>


```
// On_MYWM_NOTIFYICON - processes callback messages for taskbar icons. 
// wParam - first message parameter of the callback message. 
// lParam - second message parameter of the callback message. 

void On_MYWM_NOTIFYICON(WPARAM wParam, LPARAM lParam) 
{ 
    UINT uID; 
    UINT uMouseMsg; 
 
    uID = (UINT) wParam; 
    uMouseMsg = (UINT) lParam; 
 
    if (uMouseMsg == WM_LBUTTONDOWN) 
    { 
        switch (uID) 
        { 
            case IDI_MYBATTERYICON: 
 
                // The user clicked the battery icon. Display the 
                // battery status. 
                ShowBatteryStatus(); 
                break; 
 
            case IDI_MYPRINTERICON: 
 
                // The user clicked the printer icon. Display the 
                // status of the print job. 
                ShowJobStatus(); 
                break; 
 
            default: 
                break; 
        } 
     } 

     return; 
 }
```



 

 
