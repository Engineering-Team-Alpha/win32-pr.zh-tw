---
description: 本節說明 Shlwapi.dll 所匯出的 Windows Shell 函式，並在不屬於其他公用程式函式類別的 Shlwapi 和 Shlwapi 中定義。
title: Shell 其他公用程式函式
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 11787717-6370-408d-9a86-e208b33521c7
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: d60a0efbe9bffda671fb3be87d60357766d645e7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104026905"
---
# <a name="shell-miscellaneous-utility-functions"></a><span data-ttu-id="0a39e-103">Shell 其他公用程式函式</span><span class="sxs-lookup"><span data-stu-id="0a39e-103">Shell Miscellaneous Utility Functions</span></span>

<span data-ttu-id="0a39e-104">本節說明 Shlwapi.dll 所匯出的 Windows Shell 函式，並在不屬於其他公用程式函式類別的 Shlwapi 和 Shlwapi 中定義。</span><span class="sxs-lookup"><span data-stu-id="0a39e-104">This section describes those Windows Shell functions exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib that do not fall under one of the other utility function categories.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="0a39e-105">本節內容</span><span class="sxs-lookup"><span data-stu-id="0a39e-105">In this section</span></span>



| <span data-ttu-id="0a39e-106">主題</span><span class="sxs-lookup"><span data-stu-id="0a39e-106">Topic</span></span>                                                                   | <span data-ttu-id="0a39e-107">描述</span><span class="sxs-lookup"><span data-stu-id="0a39e-107">Description</span></span>                                                                                                                                                                                                                                                                      |
|-------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0a39e-108">**DllInstall**</span><span class="sxs-lookup"><span data-stu-id="0a39e-108">**DllInstall**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-dllinstall)<br/>                             | <span data-ttu-id="0a39e-109">處理 DLL 的安裝和設定。</span><span class="sxs-lookup"><span data-stu-id="0a39e-109">Handles installation and setup for a DLL.</span></span><br/>                                                                                                                                                                                                                             |
| [<span data-ttu-id="0a39e-110">**GetProcessReference**</span><span class="sxs-lookup"><span data-stu-id="0a39e-110">**GetProcessReference**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-getprocessreference)<br/>           | <span data-ttu-id="0a39e-111">抓取 [**SetProcessReference**](/windows/desktop/api/Shlwapi/nf-shlwapi-setprocessreference)所提供的進程特定物件，遞增參考計數以使進程保持運作。</span><span class="sxs-lookup"><span data-stu-id="0a39e-111">Retrieves the process-specific object supplied by [**SetProcessReference**](/windows/desktop/api/Shlwapi/nf-shlwapi-setprocessreference), incrementing the reference count to keep the process alive.</span></span><br/>                                                                                                     |
| [<span data-ttu-id="0a39e-112">**HashData**</span><span class="sxs-lookup"><span data-stu-id="0a39e-112">**HashData**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-hashdata)<br/>                                 | <span data-ttu-id="0a39e-113">雜湊資料的陣列。</span><span class="sxs-lookup"><span data-stu-id="0a39e-113">Hashes an array of data.</span></span><br/>                                                                                                                                                                                                                                              |
| [<span data-ttu-id="0a39e-114">**IsInternetESCEnabled**</span><span class="sxs-lookup"><span data-stu-id="0a39e-114">**IsInternetESCEnabled**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-isinternetescenabled)<br/>         | <span data-ttu-id="0a39e-115">判斷 Windows Internet Explorer 是否在增強式安全性設定中。</span><span class="sxs-lookup"><span data-stu-id="0a39e-115">Determines whether Windows Internet Explorer is in the Enhanced Security Configuration.</span></span><br/>                                                                                                                                                                               |
| [<span data-ttu-id="0a39e-116">**Iso**</span><span class="sxs-lookup"><span data-stu-id="0a39e-116">**IsOS**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-isos)<br/>                                         | <span data-ttu-id="0a39e-117">檢查指定的作業系統和作業系統功能。</span><span class="sxs-lookup"><span data-stu-id="0a39e-117">Checks for specified operating systems and operating system features.</span></span><br/>                                                                                                                                                                                                 |
| [<span data-ttu-id="0a39e-118">**IStream \_ 複製**</span><span class="sxs-lookup"><span data-stu-id="0a39e-118">**IStream\_Copy**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_copy)<br/>                        | <span data-ttu-id="0a39e-119">將資料流程複製到另一個資料流程。</span><span class="sxs-lookup"><span data-stu-id="0a39e-119">Copies a stream to another stream.</span></span><br/>                                                                                                                                                                                                                                    |
| [<span data-ttu-id="0a39e-120">**IStream \_ 讀取**</span><span class="sxs-lookup"><span data-stu-id="0a39e-120">**IStream\_Read**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_read)<br/>                        | <span data-ttu-id="0a39e-121">從指定的資料流程讀取位元組，並傳回值，這個值表示是否已成功讀取所有的位元組。</span><span class="sxs-lookup"><span data-stu-id="0a39e-121">Reads bytes from a specified stream and returns a value that indicates whether all bytes were successfully read.</span></span><br/>                                                                                                                                                      |
| [<span data-ttu-id="0a39e-122">**IStream \_ ReadPidl**</span><span class="sxs-lookup"><span data-stu-id="0a39e-122">**IStream\_ReadPidl**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_readpidl)<br/>                | <span data-ttu-id="0a39e-123">讀取專案識別碼清單的指標， (從 [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) 物件將) PIDL 至 PIDLIST 的 \_ 相對物件。</span><span class="sxs-lookup"><span data-stu-id="0a39e-123">Reads a pointer to an item identifier list (PIDL) from an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) object into a PIDLIST\_RELATIVE object.</span></span><br/>                                                                                                                                          |
| [<span data-ttu-id="0a39e-124">**IStream \_ ReadStr**</span><span class="sxs-lookup"><span data-stu-id="0a39e-124">**IStream\_ReadStr**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_readstr)<br/>                  | <span data-ttu-id="0a39e-125">從資料流程讀取並寫入字串。</span><span class="sxs-lookup"><span data-stu-id="0a39e-125">Reads from a stream and writes into a string.</span></span><br/>                                                                                                                                                                                                                         |
| [<span data-ttu-id="0a39e-126">**IStream \_ 重設**</span><span class="sxs-lookup"><span data-stu-id="0a39e-126">**IStream\_Reset**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_reset)<br/>                      | <span data-ttu-id="0a39e-127">將指定資料流程中的搜尋位置移至資料流程的開頭。</span><span class="sxs-lookup"><span data-stu-id="0a39e-127">Moves the seek position in a specified stream to the beginning of the stream.</span></span><br/>                                                                                                                                                                                         |
| [<span data-ttu-id="0a39e-128">**IStream \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="0a39e-128">**IStream\_Size**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_size)<br/>                        | <span data-ttu-id="0a39e-129">抓取指定資料流程的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="0a39e-129">Retrieves the size, in bytes, of a specified stream.</span></span><br/>                                                                                                                                                                                                                  |
| [<span data-ttu-id="0a39e-130">**IStream \_ 寫入**</span><span class="sxs-lookup"><span data-stu-id="0a39e-130">**IStream\_Write**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_write)<br/>                      | <span data-ttu-id="0a39e-131">將未知格式的資料從緩衝區寫入至指定的資料流程。</span><span class="sxs-lookup"><span data-stu-id="0a39e-131">Writes data of unknown format from a buffer to a specified stream.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="0a39e-132">**IStream \_ WritePidl**</span><span class="sxs-lookup"><span data-stu-id="0a39e-132">**IStream\_WritePidl**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_writepidl)<br/>              | <span data-ttu-id="0a39e-133">將 PIDL 從 PCUIDLIST 的 \_ 相對物件寫入 [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) 物件中。</span><span class="sxs-lookup"><span data-stu-id="0a39e-133">Writes a PIDL from a PCUIDLIST\_RELATIVE object into an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) object.</span></span><br/>                                                                                                                                                                            |
| [<span data-ttu-id="0a39e-134">**IStream \_ WriteStr**</span><span class="sxs-lookup"><span data-stu-id="0a39e-134">**IStream\_WriteStr**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-istream_writestr)<br/>                | <span data-ttu-id="0a39e-135">從字串讀取並寫入資料流程。</span><span class="sxs-lookup"><span data-stu-id="0a39e-135">Reads from a string and writes into a stream.</span></span><br/>                                                                                                                                                                                                                         |
| [<span data-ttu-id="0a39e-136">**IUnknown \_ AtomicRelease**</span><span class="sxs-lookup"><span data-stu-id="0a39e-136">**IUnknown\_AtomicRelease**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_atomicrelease)<br/>    | <span data-ttu-id="0a39e-137">釋放元件物件模型 (COM) 指標，並將它設定為 **Null**。</span><span class="sxs-lookup"><span data-stu-id="0a39e-137">Releases a Component Object Model (COM) pointer and sets it to **NULL**.</span></span><br/>                                                                                                                                                                                              |
| [<span data-ttu-id="0a39e-138">**IUnknown \_ GetSite**</span><span class="sxs-lookup"><span data-stu-id="0a39e-138">**IUnknown\_GetSite**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_getsite)<br/>                | <span data-ttu-id="0a39e-139">呼叫指定之物件的 [**IObjectWithSite：： GetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-getsite) 方法。</span><span class="sxs-lookup"><span data-stu-id="0a39e-139">Calls the specified object's [**IObjectWithSite::GetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-getsite) method.</span></span><br/>                                                                                                                                                                      |
| [<span data-ttu-id="0a39e-140">**IUnknown \_ GetWindow**</span><span class="sxs-lookup"><span data-stu-id="0a39e-140">**IUnknown\_GetWindow**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_getwindow)<br/>            | <span data-ttu-id="0a39e-141">藉由查詢具有 **GetWindow** 方法的各種介面，嘗試從 COM 物件中取出視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="0a39e-141">Attempts to retrieve a window handle from a COM object by querying for various interfaces that have a **GetWindow** method.</span></span><br/>                                                                                                                                           |
| [<span data-ttu-id="0a39e-142">**IUnknown \_ QueryService**</span><span class="sxs-lookup"><span data-stu-id="0a39e-142">**IUnknown\_QueryService**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_queryservice)<br/>      | <span data-ttu-id="0a39e-143">從指定的物件中，抓取服務的介面。</span><span class="sxs-lookup"><span data-stu-id="0a39e-143">Retrieves an interface for a service from a specified object.</span></span><br/>                                                                                                                                                                                                         |
| [<span data-ttu-id="0a39e-144">**IUnknown \_ 設定**</span><span class="sxs-lookup"><span data-stu-id="0a39e-144">**IUnknown\_Set**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_set)<br/>                        | <span data-ttu-id="0a39e-145">變更 COM 介面指標的值，並釋放先前的介面。</span><span class="sxs-lookup"><span data-stu-id="0a39e-145">Changes the value of a COM interface pointer and releases the previous interface.</span></span><br/>                                                                                                                                                                                     |
| [<span data-ttu-id="0a39e-146">**IUnknown \_ SetSite**</span><span class="sxs-lookup"><span data-stu-id="0a39e-146">**IUnknown\_SetSite**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_setsite)<br/>                | <span data-ttu-id="0a39e-147">藉由呼叫 [**IObjectWithSite：： SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) 方法來設定指定物件的網站。</span><span class="sxs-lookup"><span data-stu-id="0a39e-147">Sets the specified object's site by calling its [**IObjectWithSite::SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) method.</span></span><br/>                                                                                                                                                   |
| [<span data-ttu-id="0a39e-148">**ParseURL**</span><span class="sxs-lookup"><span data-stu-id="0a39e-148">**ParseURL**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-parseurla)<br/>                                 | <span data-ttu-id="0a39e-149">執行 URL 的基本剖析。</span><span class="sxs-lookup"><span data-stu-id="0a39e-149">Performs rudimentary parsing of a URL.</span></span><br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="0a39e-150">**QISearch**</span><span class="sxs-lookup"><span data-stu-id="0a39e-150">**QISearch**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-qisearch)<br/>                                 | <span data-ttu-id="0a39e-151">[**IUnknown：： QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))方法的資料表驅動實作為。</span><span class="sxs-lookup"><span data-stu-id="0a39e-151">A table-driven implementation of the [**IUnknown::QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span><br/>                                                                                                                                                              |
| [<span data-ttu-id="0a39e-152">**SetProcessReference**</span><span class="sxs-lookup"><span data-stu-id="0a39e-152">**SetProcessReference**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-setprocessreference)<br/>           | <span data-ttu-id="0a39e-153">提供 COM 物件，可允許裝載的 Shell 擴充和其他元件，以防止其主機進程提前關閉。</span><span class="sxs-lookup"><span data-stu-id="0a39e-153">Provides a COM object that allows hosted Shell extensions and other components to prevent their host process from closing prematurely.</span></span> <span data-ttu-id="0a39e-154">主機進程通常是 Windows 檔案總管或 Internet Explorer，但其他應用程式也可以使用此函數。</span><span class="sxs-lookup"><span data-stu-id="0a39e-154">The host process is typically Windows Explorer or Internet Explorer, but this function can also be used by other applications.</span></span><br/> |
| [<span data-ttu-id="0a39e-155">**SHAutoComplete**</span><span class="sxs-lookup"><span data-stu-id="0a39e-155">**SHAutoComplete**</span></span>](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete)<br/>                   | <span data-ttu-id="0a39e-156">指示系統編輯控制項使用自動完成功能，以協助完成 Url 或檔案系統路徑。</span><span class="sxs-lookup"><span data-stu-id="0a39e-156">Instructs system edit controls to use AutoComplete to help complete URLs or file system paths.</span></span><br/>                                                                                                                                                                        |
| [<span data-ttu-id="0a39e-157">**SHCreateMemStream**</span><span class="sxs-lookup"><span data-stu-id="0a39e-157">**SHCreateMemStream**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatememstream)<br/>               | <span data-ttu-id="0a39e-158">使用與 [**CreateStreamOnHGlobal**](/windows/win32/api/combaseapi/nf-combaseapi-createstreamonhglobal)類似的進程來建立記憶體資料流程。</span><span class="sxs-lookup"><span data-stu-id="0a39e-158">Creates a memory stream using a similar process to [**CreateStreamOnHGlobal**](/windows/win32/api/combaseapi/nf-combaseapi-createstreamonhglobal).</span></span><br/>                                                                                                                                                            |
| [<span data-ttu-id="0a39e-159">**SHCreateStreamOnFileEx**</span><span class="sxs-lookup"><span data-stu-id="0a39e-159">**SHCreateStreamOnFileEx**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatestreamonfileex)<br/>     | <span data-ttu-id="0a39e-160">開啟或建立檔案，並抓取資料流程以讀取或寫入該檔案。</span><span class="sxs-lookup"><span data-stu-id="0a39e-160">Opens or creates a file and retrieves a stream to read or write to that file.</span></span><br/>                                                                                                                                                                                         |
| [<span data-ttu-id="0a39e-161">**SHCreateThread**</span><span class="sxs-lookup"><span data-stu-id="0a39e-161">**SHCreateThread**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread)<br/>                     | <span data-ttu-id="0a39e-162">建立執行緒。</span><span class="sxs-lookup"><span data-stu-id="0a39e-162">Creates a thread.</span></span><br/>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="0a39e-163">**SHCreateThreadRef**</span><span class="sxs-lookup"><span data-stu-id="0a39e-163">**SHCreateThreadRef**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadref)<br/>               | <span data-ttu-id="0a39e-164">建立 COM 物件的每個執行緒參考。</span><span class="sxs-lookup"><span data-stu-id="0a39e-164">Creates a per-thread reference to a COM object.</span></span><br/>                                                                                                                                                                                                                       |
| [<span data-ttu-id="0a39e-165">**SHCreateThreadWithHandle**</span><span class="sxs-lookup"><span data-stu-id="0a39e-165">**SHCreateThreadWithHandle**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle)<br/> | <span data-ttu-id="0a39e-166">建立新的執行緒，並抓取其控制碼。</span><span class="sxs-lookup"><span data-stu-id="0a39e-166">Creates a new thread and retrieves its handle.</span></span><br/>                                                                                                                                                                                                                        |
| [<span data-ttu-id="0a39e-167">**SHGetThreadRef**</span><span class="sxs-lookup"><span data-stu-id="0a39e-167">**SHGetThreadRef**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shgetthreadref)<br/>                     | <span data-ttu-id="0a39e-168">抓取 [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref)所設定的每個執行緒物件參考。</span><span class="sxs-lookup"><span data-stu-id="0a39e-168">Retrieves the per-thread object reference set by [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).</span></span><br/>                                                                                                                                                                            |
| [<span data-ttu-id="0a39e-169">**SHGlobalCounterDecrement**</span><span class="sxs-lookup"><span data-stu-id="0a39e-169">**SHGlobalCounterDecrement**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcounterdecrement)<br/> | <span data-ttu-id="0a39e-170">遞減全域計數器。</span><span class="sxs-lookup"><span data-stu-id="0a39e-170">Decrements a global counter.</span></span><br/>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="0a39e-171">**SHGlobalCounterGetValue**</span><span class="sxs-lookup"><span data-stu-id="0a39e-171">**SHGlobalCounterGetValue**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcountergetvalue)<br/>   | <span data-ttu-id="0a39e-172">取得全域計數器的目前值。</span><span class="sxs-lookup"><span data-stu-id="0a39e-172">Gets the current value of a global counter.</span></span><br/>                                                                                                                                                                                                                           |
| [<span data-ttu-id="0a39e-173">**SHGlobalCounterIncrement**</span><span class="sxs-lookup"><span data-stu-id="0a39e-173">**SHGlobalCounterIncrement**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcounterincrement)<br/> | <span data-ttu-id="0a39e-174">遞增全域計數器。</span><span class="sxs-lookup"><span data-stu-id="0a39e-174">Increments a global counter.</span></span><br/>                                                                                                                                                                                                                                          |
| [<span data-ttu-id="0a39e-175">**SHIsLowMemoryMachine**</span><span class="sxs-lookup"><span data-stu-id="0a39e-175">**SHIsLowMemoryMachine**</span></span>](/windows/desktop/api/shlwapi/nf-shlwapi-shislowmemorymachine)<br/>         |                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="0a39e-176">**SHReleaseThreadRef**</span><span class="sxs-lookup"><span data-stu-id="0a39e-176">**SHReleaseThreadRef**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shreleasethreadref)<br/>             | <span data-ttu-id="0a39e-177">線上程程式傳回之前釋放執行緒參考。</span><span class="sxs-lookup"><span data-stu-id="0a39e-177">Releases a thread reference before the thread procedure returns.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="0a39e-178">**SHSetThreadRef**</span><span class="sxs-lookup"><span data-stu-id="0a39e-178">**SHSetThreadRef**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref)<br/>                     | <span data-ttu-id="0a39e-179">將每個執行緒的參考儲存至 COM 物件。</span><span class="sxs-lookup"><span data-stu-id="0a39e-179">Stores a per-thread reference to a COM object.</span></span> <span data-ttu-id="0a39e-180">這可讓呼叫者控制執行緒的存留期，以確保在呼叫端就緒之前，Windows 不會關閉執行緒。</span><span class="sxs-lookup"><span data-stu-id="0a39e-180">This allows the caller to control the thread's lifetime so that it can ensure that Windows won't shut down the thread before the caller is ready.</span></span><br/>                                                                      |



 

 

 
