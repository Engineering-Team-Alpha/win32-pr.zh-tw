---
description: 線上說明可以有各式各樣的表單，從詳細的概念資訊到快速定義。 本主題包含下列各節。
title: 處理線上說明
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 2a3f6034-6ba6-4204-a2e1-59995fbf40fe
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f1c125df135068c2eee37cb33a8a9d2b281b1f83
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991571"
---
# <a name="handling-online-help"></a><span data-ttu-id="13616-104">處理線上說明</span><span class="sxs-lookup"><span data-stu-id="13616-104">Handling Online Help</span></span>

<span data-ttu-id="13616-105">線上說明可以有各式各樣的表單，從詳細的概念資訊到快速定義。</span><span class="sxs-lookup"><span data-stu-id="13616-105">Online help can come in a variety of forms, from detailed conceptual information to quick definitions.</span></span> <span data-ttu-id="13616-106">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="13616-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="13616-107">關於說明</span><span class="sxs-lookup"><span data-stu-id="13616-107">About Help</span></span>](#about-help)
    -   [<span data-ttu-id="13616-108">協助要求</span><span class="sxs-lookup"><span data-stu-id="13616-108">Help Requests</span></span>](#help-requests)
    -   [<span data-ttu-id="13616-109">說明顯示和 Windows 說明</span><span class="sxs-lookup"><span data-stu-id="13616-109">Help Display and Windows Help</span></span>](#help-display-and-windows-help)
-   [<span data-ttu-id="13616-110">使用說明</span><span class="sxs-lookup"><span data-stu-id="13616-110">Using Help</span></span>](#using-help)
    -   [<span data-ttu-id="13616-111">在對話方塊中提供協助</span><span class="sxs-lookup"><span data-stu-id="13616-111">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
    -   [<span data-ttu-id="13616-112">設定次要說明視窗的外觀</span><span class="sxs-lookup"><span data-stu-id="13616-112">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

## <a name="about-help"></a><span data-ttu-id="13616-113">關於說明</span><span class="sxs-lookup"><span data-stu-id="13616-113">About Help</span></span>

<span data-ttu-id="13616-114">方便使用的應用程式有一個重要元素，可在線上說明中立即取得。</span><span class="sxs-lookup"><span data-stu-id="13616-114">An important element of a user-friendly application is readily available in online help.</span></span> <span data-ttu-id="13616-115">Windows 提供的函式和訊息，與 Windows 說明應用程式搭配使用時，可讓您輕鬆地在應用程式中執行線上說明。</span><span class="sxs-lookup"><span data-stu-id="13616-115">Windows provides functions and messages that, when used in conjunction with the Windows Help application, make it easy to implement online help in your application.</span></span> <span data-ttu-id="13616-116">本總覽討論支援線上說明的 Windows 元素。</span><span class="sxs-lookup"><span data-stu-id="13616-116">This overview discusses the elements of Windows that support online help.</span></span> <span data-ttu-id="13616-117">它說明如何使用這些專案來提供使用者要求協助的方法，並說明如何使用 Windows 說明應用程式來顯示說明。</span><span class="sxs-lookup"><span data-stu-id="13616-117">It describes how to use these elements to give users a means to request help, and it explains how to use the Windows Help application to display help.</span></span>

### <a name="help-requests"></a><span data-ttu-id="13616-118">協助要求</span><span class="sxs-lookup"><span data-stu-id="13616-118">Help Requests</span></span>

<span data-ttu-id="13616-119">大部分的 Windows 應用程式會以各種不同的形式提供線上說明資訊，範圍從概念說明，到說明應用程式功能的快顯說明用途，以提供應用程式使用者介面中個別元素的快速定義。</span><span class="sxs-lookup"><span data-stu-id="13616-119">Most Windows-based applications provide online help information in a variety of forms, ranging from conceptual help that explains the purpose of an application's features to pop-up help that provides quick definitions of individual elements in the application's user interface.</span></span> <span data-ttu-id="13616-120">您可以使用函式和訊息，為使用者提供各種不同的方法來要求存取此資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-120">You use functions and messages to give users a variety of ways to request access to this information.</span></span> <span data-ttu-id="13616-121">下列各節將說明這些說明要求。</span><span class="sxs-lookup"><span data-stu-id="13616-121">The following sections describe these help requests.</span></span>

### <a name="help-menu"></a><span data-ttu-id="13616-122">說明功能表</span><span class="sxs-lookup"><span data-stu-id="13616-122">Help menu</span></span>

<span data-ttu-id="13616-123">大部分的應用程式會在主視窗中包含 [說明 **] 功能表，** 以提供使用者存取說明資訊的許可權。</span><span class="sxs-lookup"><span data-stu-id="13616-123">Most applications provide user access to help information by including a **Help** menu in the main window.</span></span> <span data-ttu-id="13616-124">當使用者從 [說明 **] 功能表選取** 專案時，對應的視窗程式會收到一個可識別所選取專案的 [**WM \_ 命令**](../menurc/wm-command.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-124">When the user selects an item from a **Help** menu, the corresponding window procedure receives a [**WM\_COMMAND**](../menurc/wm-command.md) message that identifies the selected item.</span></span> <span data-ttu-id="13616-125">應用程式會藉由顯示適當的說明資訊來回應，例如說明主題清單、索引或應用程式簡介。</span><span class="sxs-lookup"><span data-stu-id="13616-125">The application responds by displaying the appropriate help information, such as a list of help topics, an index, or an introduction to the application.</span></span>

### <a name="help-from-the-keyboard"></a><span data-ttu-id="13616-126">鍵盤上的協助</span><span class="sxs-lookup"><span data-stu-id="13616-126">Help from the keyboard</span></span>

<span data-ttu-id="13616-127">當使用者按下 F1 鍵時，Windows 會通知應用程式，讓使用者可以從鍵盤存取協助資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-127">Windows provides user access to help information from the keyboard by notifying the application whenever the user presses the F1 key.</span></span> <span data-ttu-id="13616-128">當使用者按下按鍵時，系統會將 [**WM \_**](wm-help.md) 說明訊息傳送至具有鍵盤焦點的視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-128">The system sends a [**WM\_HELP**](wm-help.md) message to the window that had the keyboard focus when the user pressed the key.</span></span> <span data-ttu-id="13616-129">如果視窗是子視窗 (例如) 對話方塊中的控制項， [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式會將訊息傳遞至父視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-129">If the window is a child window (for example, a control in a dialog box), the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="13616-130">如果按下 F1 時，功能表為使用中狀態，系統會將訊息傳送至與功能表相關聯的視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-130">If a menu is active when F1 is pressed, the system sends the message to the window associated with the menu.</span></span> <span data-ttu-id="13616-131">應用程式會顯示與焦點或作用中的視窗、控制項或功能表相關聯的說明資訊來回應。</span><span class="sxs-lookup"><span data-stu-id="13616-131">The application responds by displaying help information associated with the window, control, or menu that has the focus or is active.</span></span> <span data-ttu-id="13616-132">例如，如果使用者在對話方塊中選取控制項，並按 F1 鍵，則應用程式會顯示該控制項的說明資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-132">For example, if the user selects a control in a dialog box and presses F1, the application displays help information for that control.</span></span>

<span data-ttu-id="13616-133">WM 說明的 *lParam* 參數是 [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo)結構的指標，其中包含要求說明之專案的詳細資訊。 [**\_**](wm-help.md)</span><span class="sxs-lookup"><span data-stu-id="13616-133">The *lParam* parameter of [**WM\_HELP**](wm-help.md) is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested.</span></span> <span data-ttu-id="13616-134">您可以使用此資訊來決定要顯示的說明主題。</span><span class="sxs-lookup"><span data-stu-id="13616-134">You use this information to determine the help topic to display.</span></span> <span data-ttu-id="13616-135">**HELPINFO** 結構也包含使用者按下按鍵時，滑鼠游標的座標。</span><span class="sxs-lookup"><span data-stu-id="13616-135">The **HELPINFO** structure also includes the coordinates of the mouse cursor at the time the user pressed the key.</span></span> <span data-ttu-id="13616-136">您可以使用這項資訊，根據滑鼠游標的位置提供說明。</span><span class="sxs-lookup"><span data-stu-id="13616-136">You can use this information to provide help based on the location of the mouse cursor.</span></span>

### <a name="help-from-the-mouse"></a><span data-ttu-id="13616-137">滑鼠的協助</span><span class="sxs-lookup"><span data-stu-id="13616-137">Help from the mouse</span></span>

<span data-ttu-id="13616-138">Windows 會在使用者按一下滑鼠右鍵，或按一下 [問題 (？] ) 按鈕後，每次使用者按一下滑鼠右鍵，或按一下視窗、控制項或功能表，以提供使用者存取滑鼠的協助資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-138">Windows provides the user access to help information from the mouse by notifying the application whenever the user clicks the right mouse button or clicks a window, control, or menu after clicking the Question (?) button.</span></span> <span data-ttu-id="13616-139">應用程式會顯示與指定視窗、控制項或功能表相關聯的說明資訊來回應。</span><span class="sxs-lookup"><span data-stu-id="13616-139">The application responds by displaying help information associated with the given window, control, or menu.</span></span>

<span data-ttu-id="13616-140">當使用者按一下滑鼠右鍵時，系統會傳送 [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-140">The system sends a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message when the user clicks the right mouse button.</span></span> <span data-ttu-id="13616-141">按一下的視窗會接收訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-141">The window that was clicked receives the message.</span></span> <span data-ttu-id="13616-142">如果視窗是子視窗（例如控制項），則 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式會將訊息傳遞至父視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-142">If the window is a child window, such as a control, the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="13616-143">**WM \_ CONTEXTMENU** 訊息會指定滑鼠游標的座標。</span><span class="sxs-lookup"><span data-stu-id="13616-143">The **WM\_CONTEXTMENU** message specifies the coordinates of the mouse cursor.</span></span> <span data-ttu-id="13616-144">X 座標是在 *lParam* 參數的低序位字組中，而 y 座標則是在高序位字中。</span><span class="sxs-lookup"><span data-stu-id="13616-144">The x-coordinate is in the low-order word of the *lParam* parameter, and the y-coordinate is in the high-order word.</span></span> <span data-ttu-id="13616-145">如果使用者按一下控制項， *wParam* 參數就是收到點擊之控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="13616-145">If the user clicked a control, the *wParam* parameter is the handle to the control that received the click.</span></span>

<span data-ttu-id="13616-146">當使用者按一下視窗標題列中出現的 [問題 (？] ) 按鈕後，系統會傳送一則 WM 說明訊息， [**\_ 讓**](wm-help.md) 使用者在視窗中按一下某個專案。</span><span class="sxs-lookup"><span data-stu-id="13616-146">The system sends a [**WM\_HELP**](wm-help.md) message when the user clicks an item in a window after clicking the Question (?) button that appears in the title bar of the window.</span></span> <span data-ttu-id="13616-147">建立視窗時，您可以在 [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa)函式中指定 **WS \_ EX \_ CONTEXTHELP** 樣式，以將問題按鈕新增至標題列。</span><span class="sxs-lookup"><span data-stu-id="13616-147">You can add a Question button to a title bar by specifying the **WS\_EX\_CONTEXTHELP** style in the [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) function when creating the window.</span></span> <span data-ttu-id="13616-148">WM 說明的 *lParam* 參數是 [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo)結構的指標，其中包含要求說明之專案的詳細資訊，包括使用者按下滑鼠按鍵時的滑鼠游標座標。 **\_**</span><span class="sxs-lookup"><span data-stu-id="13616-148">The *lParam* parameter of **WM\_HELP** is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested, including the coordinates of the mouse cursor at the time the user clicked the mouse button.</span></span>

<span data-ttu-id="13616-149">建議您只在對話方塊中使用 [問題] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="13616-149">The Question button is recommended for use in dialog boxes only.</span></span> <span data-ttu-id="13616-150">在過去，應用程式會提供對話方塊 **中的 [說明] 按鈕，** 以提供使用者存取對話方塊的協助資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-150">In the past, applications have provided user access to help information about a dialog box by providing a **Help** button in the dialog box.</span></span> <span data-ttu-id="13616-151">不再建議使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="13616-151">This method is no longer recommended.</span></span> <span data-ttu-id="13616-152">請改用 [問題] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="13616-152">Use the Question button instead.</span></span>

### <a name="help-display-and-windows-help"></a><span data-ttu-id="13616-153">說明顯示和 Windows 說明</span><span class="sxs-lookup"><span data-stu-id="13616-153">Help Display and Windows Help</span></span>

<span data-ttu-id="13616-154">一旦應用程式收到協助的要求，它應該會顯示適當的說明資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-154">Once an application receives a request for help, it should display the appropriate help information.</span></span> <span data-ttu-id="13616-155">由於 Windows Help 應用程式提供一致的使用者介面，建議應用程式使用 Windows 說明，而不是其他方法。</span><span class="sxs-lookup"><span data-stu-id="13616-155">Because the Windows Help application supplies a consistent user interface, it is recommended that applications use Windows Help rather than other methods.</span></span> <span data-ttu-id="13616-156">若要指示 Windows 說明來顯示說明資訊，應用程式會使用 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式，指定詳細資料，例如要顯示的資訊，以及要在其中顯示的視窗表單。</span><span class="sxs-lookup"><span data-stu-id="13616-156">To direct Windows Help to display help information, an application uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, specifying details such as the information to display and the form of the window in which to display it.</span></span> <span data-ttu-id="13616-157">下列各節說明如何使用 **WinHelp** 來顯示說明資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-157">The following sections explain how to use **WinHelp** to display help information.</span></span>

### <a name="help-files"></a><span data-ttu-id="13616-158">說明檔</span><span class="sxs-lookup"><span data-stu-id="13616-158">Help files</span></span>

<span data-ttu-id="13616-159">若要查看說明資訊，您必須在呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函數時指定說明檔。</span><span class="sxs-lookup"><span data-stu-id="13616-159">To view help information, you must specify a help file when calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="13616-160">說明檔必須有 Windows 說明 ( .hlp) 檔案格式和一或多個主題。</span><span class="sxs-lookup"><span data-stu-id="13616-160">The help file must have the Windows Help (.hlp) file format and one or more topics.</span></span> <span data-ttu-id="13616-161">每個主題都是不同的資訊單位，例如概念描述、一組指示、圖片、詞彙定義等等。</span><span class="sxs-lookup"><span data-stu-id="13616-161">Each topic is a distinct unit of information, such as a conceptual description, a set of instructions, a picture, a glossary definition, and so on.</span></span> <span data-ttu-id="13616-162">主題必須是唯一識別的，讓 Windows 說明可以在每次要求時找到它們。</span><span class="sxs-lookup"><span data-stu-id="13616-162">Topics must be uniquely identified so that Windows Help can locate them whenever they are requested.</span></span> <span data-ttu-id="13616-163">就內部而言，Windows 說明會使用主題識別碼來尋找主題，但是應用程式最常使用內容識別碼 (唯一的整數值) 來指定要顯示的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-163">Internally, Windows Help uses topic identifiers to locate topics, but applications most often use context identifiers (unique integer values) to specify the topics to display.</span></span> <span data-ttu-id="13616-164">說明檔作者必須明確地將內容識別碼對應至 \[ \] 用來建立說明檔之專案檔的 [對應] 區段中的主題識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-164">The help file author must explicitly map context identifiers to topic identifiers in the \[MAP\] section of the project file used to build the help file.</span></span>

<span data-ttu-id="13616-165">當您指定說明檔，但未指定路徑時， [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 會尋找說明目錄或 path 環境變數所指定之目錄中的說明檔。</span><span class="sxs-lookup"><span data-stu-id="13616-165">When you specify a help file but you do not specify a path, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) looks for the help file in the help directory or in a directory specified by the PATH environment variable.</span></span> <span data-ttu-id="13616-166">此外， **WinHelp** 可以找到名稱列于下列登錄位置的說明檔：</span><span class="sxs-lookup"><span data-stu-id="13616-166">In addition, **WinHelp** can find a help file whose name is listed in the following registry location:</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            Help
```

<span data-ttu-id="13616-167">若要利用登錄，您必須建立與您的說明檔名稱相同的值名稱。</span><span class="sxs-lookup"><span data-stu-id="13616-167">To take advantage of the registry, you must create a value name that has the same name as your help file.</span></span> <span data-ttu-id="13616-168">指派給該名稱的值必須是說明檔所在的目錄。</span><span class="sxs-lookup"><span data-stu-id="13616-168">The value assigned to that name must be the directory where the help file resides.</span></span>

<span data-ttu-id="13616-169">如果 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 找不到指定的說明檔，則會顯示一個對話方塊，讓使用者指定說明檔的位置。</span><span class="sxs-lookup"><span data-stu-id="13616-169">If [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) cannot find the given help file, it displays a dialog box that allows the user to specify the location of the help file.</span></span> <span data-ttu-id="13616-170">因為 **WinHelp** 會將位置資訊儲存在登錄中，所以不會再詢問相同說明檔的位置。</span><span class="sxs-lookup"><span data-stu-id="13616-170">Because **WinHelp** saves the location information in the registry, it does not ask again for the location of the same help file.</span></span>

<span data-ttu-id="13616-171">如需有關如何撰寫和建立說明檔的詳細資訊，請參閱您的開發工具所提供的檔。</span><span class="sxs-lookup"><span data-stu-id="13616-171">For more information about how to author and build a help file, see the documentation provided with your development tools.</span></span>

### <a name="starting-windows-help"></a><span data-ttu-id="13616-172">啟動 Windows 說明</span><span class="sxs-lookup"><span data-stu-id="13616-172">Starting Windows Help</span></span>

<span data-ttu-id="13616-173">下列範例會使用 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式來啟動 Windows 說明應用程式，並開啟其內容主題的說明檔。</span><span class="sxs-lookup"><span data-stu-id="13616-173">The following example uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to start the Windows Help application and open the help file to its Contents topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_CONTENTS, 0L);
```



<span data-ttu-id="13616-174">下一個範例會開啟使用者說明檔、在檔案中搜尋與關鍵字字串相關聯的主題，然後顯示主題。</span><span class="sxs-lookup"><span data-stu-id="13616-174">This next example opens the user help file, searches the file for the topic associated with a keyword string, and then displays the topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_KEY, (DWORD) "finding topics");
```



### <a name="help-topics-dialog-box"></a><span data-ttu-id="13616-175">說明主題對話方塊</span><span class="sxs-lookup"><span data-stu-id="13616-175">Help Topics dialog box</span></span>

<span data-ttu-id="13616-176">您可以使用 **help \_ FINDER** 命令呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa)函式來顯示 [**說明主題**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="13616-176">You can display the **Help Topics** dialog box by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the **HELP\_FINDER** command.</span></span> <span data-ttu-id="13616-177">[ **說明主題** ] 對話方塊可讓使用者藉由查看主題的標題、與主題相關聯的關鍵字，或主題中找到的單字和片語，來選取要顯示的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-177">The **Help Topics** dialog box lets the user select topics to display by viewing the titles of the topics, the keywords associated with the topics, or the words and phrases found in the topics.</span></span> <span data-ttu-id="13616-178">當使用者選擇 [說明] 功能表中的命令（例如說明主題）時，應用程式通常會顯示此對話方塊。</span><span class="sxs-lookup"><span data-stu-id="13616-178">Applications typically display this dialog box when the user chooses a command, such as Help Topics, from the Help menu.</span></span> <span data-ttu-id="13616-179">如果應用程式中沒有特定的視窗、控制項或功能表具有焦點或作用中，應用程式也可能會顯示此對話方塊。</span><span class="sxs-lookup"><span data-stu-id="13616-179">An application may also display this dialog box if the user presses the key when no specific window, control, or menu in the application has the focus or is active.</span></span>

<span data-ttu-id="13616-180">在過去，應用程式已使用「說明」 **\_ 內容** 和「 **協助」 \_ 索引** 命令搭配 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式來顯示「內容」主題和說明檔的關鍵字索引。</span><span class="sxs-lookup"><span data-stu-id="13616-180">In the past, applications have used the **HELP\_CONTENTS** and **HELP\_INDEX** commands with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to display the Contents topic and the keyword index of the Help file.</span></span> <span data-ttu-id="13616-181">不再建議使用這些命令。</span><span class="sxs-lookup"><span data-stu-id="13616-181">These commands are no longer recommended.</span></span> <span data-ttu-id="13616-182">請改用 **HELP \_ FINDER** 命令。</span><span class="sxs-lookup"><span data-stu-id="13616-182">Use the **HELP\_FINDER** command instead.</span></span>

### <a name="information-topics"></a><span data-ttu-id="13616-183">資訊主題</span><span class="sxs-lookup"><span data-stu-id="13616-183">Information topics</span></span>

<span data-ttu-id="13616-184">您可以使用 HELP CONTEXT 命令呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式 \_ ，並指定主題的內容識別碼，來顯示特定主題。</span><span class="sxs-lookup"><span data-stu-id="13616-184">You can display a specific topic by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_CONTEXT command and specifying the context identifier for the topic.</span></span> <span data-ttu-id="13616-185">應用程式通常會使用說明 \_ 內容命令來回應使用者對於包含概念性資訊或程式說明的主題，而不是特定控制項或功能表的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-185">Applications typically use the HELP\_CONTEXT command in response to user requests for topics containing conceptual information or procedural help rather than information about a specific control or menu.</span></span> <span data-ttu-id="13616-186">在這種情況下，使用者可能會在返回應用程式之前，繼續流覽說明檔尋找相關資訊。</span><span class="sxs-lookup"><span data-stu-id="13616-186">In such cases, the user may continue to browse the help file looking for related information before returning to the application.</span></span>

<span data-ttu-id="13616-187">HELP \_ CONTEXT 命令會叫用一般的 Windows 說明實例，讓使用者能夠尋找說明檔中的其他主題。</span><span class="sxs-lookup"><span data-stu-id="13616-187">The HELP\_CONTEXT command invokes a regular instance of Windows Help, enabling the user to find other topics in the help file.</span></span> <span data-ttu-id="13616-188">它通常會顯示主要的 [說明] 視窗，其中包含標題列、系統功能表、最小化和最大化按鈕、主功能表、選擇性巡覽列、調整大小框線和工作區。</span><span class="sxs-lookup"><span data-stu-id="13616-188">It typically displays the main Help window, which includes a title bar, a system menu, minimize and maximize buttons, a main menu, an optional navigation bar, a sizing border, and a client area.</span></span> <span data-ttu-id="13616-189">所選主題的文字會出現在工作區中，使用者可以使用主視窗中的 [熱連結] 或 [流覽] 按鈕，流覽說明檔。</span><span class="sxs-lookup"><span data-stu-id="13616-189">The text of the selected topic appears in the client area, and the user can navigate through the help file by using hot links or navigation buttons in the main window.</span></span> <span data-ttu-id="13616-190">Windows 說明的一般實例也可以用來顯示一或多個次要視窗中的說明，而不是主視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-190">The regular instance of Windows Help can also be used to display help in one or more secondary windows instead of the main window.</span></span>

### <a name="pop-up-topics"></a><span data-ttu-id="13616-191">彈出主題</span><span class="sxs-lookup"><span data-stu-id="13616-191">Pop-up topics</span></span>

<span data-ttu-id="13616-192">您可以使用 HELP [](/windows/desktop/api/Winuser/nf-winuser-winhelpa) \_ WM \_ help 或 Help CONTEXTMENU 命令呼叫 WinHelp 函式，來顯示包含特定控制項或功能表資訊的彈出主題 \_ 。</span><span class="sxs-lookup"><span data-stu-id="13616-192">You can display a pop-up topic that contains information for a specific control or menu by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_WM\_HELP or HELP\_CONTEXTMENU command.</span></span> <span data-ttu-id="13616-193">這些命令會在相對應的控制項或功能表附近的快顯視窗中顯示主題。</span><span class="sxs-lookup"><span data-stu-id="13616-193">These commands display a topic in a pop-up window near the corresponding control or menu.</span></span> <span data-ttu-id="13616-194">為了讓使用者在應用程式中立即返回工作，當使用者按下按鍵或按下滑鼠左鍵時，快顯視窗就會立即終結。</span><span class="sxs-lookup"><span data-stu-id="13616-194">To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.</span></span>

<span data-ttu-id="13616-195">\_ \_ 當您處理適用于控制項視窗的 [**WM 說明 \_**](wm-help.md)訊息時，請使用 help WM help 命令。</span><span class="sxs-lookup"><span data-stu-id="13616-195">You use the HELP\_WM\_HELP command when processing [**WM\_HELP**](wm-help.md) messages for control windows.</span></span> <span data-ttu-id="13616-196">因為大部分的控制項都會將 WM 說明訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca)函式，所以對應的對話方塊程式 (或父視窗程式) 處理此訊息。 **\_**</span><span class="sxs-lookup"><span data-stu-id="13616-196">Because most controls pass the **WM\_HELP** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="13616-197">對話方塊程式必須將控制項的陣列和內容識別碼組傳遞給 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) ，以及 [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo)結構的 **hItemHandle** 成員中指定的控制控制碼，而不是提供特定的內容識別碼。 **\_**</span><span class="sxs-lookup"><span data-stu-id="13616-197">Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) along with the control handle specified in the **hItemHandle** member of the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure passed with the **WM\_HELP** message.</span></span> <span data-ttu-id="13616-198">函式會判斷已產生 **WM \_** 說明訊息之控制項的識別碼，並使用相符的內容識別碼來顯示適當的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-198">The function determines the identifier of the control for which the **WM\_HELP** message was generated and uses the matching context identifier to display the appropriate topic.</span></span>

<span data-ttu-id="13616-199">\_處理 [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md)訊息時，請使用 HELP CONTEXTMENU 命令。</span><span class="sxs-lookup"><span data-stu-id="13616-199">You use the HELP\_CONTEXTMENU command when processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="13616-200">因為大部分的控制項都會將 **WM \_ CONTEXTMENU** 訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式，所以對應的對話方塊程式 (或父視窗程式) 處理此訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-200">Because most controls pass the **WM\_CONTEXTMENU** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="13616-201">此程式會指定控制項的陣列和內容識別碼組;它也會在呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa)時指定 *wParam* 參數中的控制碼，讓函式可以從陣列中挑選適當的內容識別碼，並顯示適當的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-201">The procedure specifies an array of control and context identifier pairs; it also specifies the handle in the *wParam* parameter when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) so that the function can pick the appropriate context identifier from the array and display the appropriate topic.</span></span> <span data-ttu-id="13616-202">不同于 HELP \_ WM \_ help 命令，help \_ CONTEXTMENU 會先在功能表中顯示 [ **這是什麼？** ] 命令。</span><span class="sxs-lookup"><span data-stu-id="13616-202">Unlike the HELP\_WM\_HELP command, HELP\_CONTEXTMENU first displays a **What's This?** command in a menu.</span></span> <span data-ttu-id="13616-203">如果使用者選擇命令， **WinHelp** 會顯示主題。</span><span class="sxs-lookup"><span data-stu-id="13616-203">If the user chooses the command, **WinHelp** displays the topic.</span></span> <span data-ttu-id="13616-204">否則，就會取消要求。</span><span class="sxs-lookup"><span data-stu-id="13616-204">Otherwise, the request is canceled.</span></span>

<span data-ttu-id="13616-205">您也可以使用 HELP \_ CONTEXTPOPUP 命令，並指定主題的內容識別碼，以顯示快捷方式主題。</span><span class="sxs-lookup"><span data-stu-id="13616-205">You can also display pop-up topics by using the HELP\_CONTEXTPOPUP command and specifying a context identifier of the topic.</span></span> <span data-ttu-id="13616-206">此命令與 HELP CONTEXT 命令類似，但會叫 \_ 用 help \_ WM HELP \_ 和 help CONTEXTMENU 所使用之 Windows 說明的快顯實例 \_ 。</span><span class="sxs-lookup"><span data-stu-id="13616-206">This command is similar to the HELP\_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP\_WM\_HELP and HELP\_CONTEXTMENU.</span></span> <span data-ttu-id="13616-207">應用程式可以使用此命令來回應 [**WM \_**](wm-help.md) 說明訊息，以顯示在對話方塊中不是控制項的功能表和視窗的說明。</span><span class="sxs-lookup"><span data-stu-id="13616-207">Applications can use this command in response to [**WM\_HELP**](wm-help.md) messages to display help for menus and for windows that are not controls in a dialog box.</span></span> <span data-ttu-id="13616-208">若要最有效地使用此命令，應用程式應該將內容識別碼指派給這些功能表和視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-208">To use this command most effectively, the application should assign context identifiers to these menus and windows.</span></span>

<span data-ttu-id="13616-209">您可以將內容識別碼指派給應用程式中的任何視窗或功能表。</span><span class="sxs-lookup"><span data-stu-id="13616-209">You can assign a context identifier to any window or menu in the application.</span></span> <span data-ttu-id="13616-210">當產生 [**wm \_**](wm-help.md) 說明訊息時，系統會在 [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) 結構中包含內容識別碼，該結構會傳遞至 **WM \_** 說明訊息中的父視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-210">When a [**WM\_HELP**](wm-help.md) message is generated, the system includes the context identifier in the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that is passed to the parent window in the **WM\_HELP** message.</span></span> <span data-ttu-id="13616-211">父視窗接著可以將內容識別碼傳遞給 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) ，以顯示要求的說明主題。</span><span class="sxs-lookup"><span data-stu-id="13616-211">The parent window can then pass the context identifier to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) to display the requested help topic.</span></span>

<span data-ttu-id="13616-212">您可以使用 [**SetWindowCoNtextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) 函式，將內容識別碼指派給視窗或控制項，並使用 [**SetMenuCoNtextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) 函式將內容識別碼指派給功能表。</span><span class="sxs-lookup"><span data-stu-id="13616-212">You use the [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) function to assign a context identifier to a window or control and the [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) function to assign a context identifier to a menu.</span></span> <span data-ttu-id="13616-213">您可以使用 [**GetWindowCoNtextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) 或 [**GetMenuCoNtextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) 函式，來取得視窗或功能表的內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-213">You can retrieve the context identifier for a window or menu by using the [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) or [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) function.</span></span>

### <a name="keyword-searches"></a><span data-ttu-id="13616-214">關鍵字搜尋</span><span class="sxs-lookup"><span data-stu-id="13616-214">Keyword searches</span></span>

<span data-ttu-id="13616-215">您可以藉由將關鍵字指派給說明檔中的主題，讓使用者尋找和查看主題。</span><span class="sxs-lookup"><span data-stu-id="13616-215">You can enable the user to find and view topics by assigning keywords to topics in the help file.</span></span> <span data-ttu-id="13616-216">關鍵字只是與一或多個主題相關聯的字串。</span><span class="sxs-lookup"><span data-stu-id="13616-216">A keyword is simply a string that is associated with one or more topics.</span></span> <span data-ttu-id="13616-217">Windows 說明會收集說明檔中的所有關鍵詞，將它們放在資料表中，並顯示在 [ **說明主題** ] 對話方塊的 [索引] 清單中。</span><span class="sxs-lookup"><span data-stu-id="13616-217">Windows Help collects all keywords in a help file, places them in a table, and displays them in the Index list of the **Help Topics** dialog box.</span></span> <span data-ttu-id="13616-218">當使用者選取關鍵字時，Windows 說明會顯示相關聯的說明主題，或者，如果有一個以上的主題與關鍵字相關聯，則會顯示使用者可以選擇的主題清單。</span><span class="sxs-lookup"><span data-stu-id="13616-218">When the user selects a keyword, Windows Help displays the associated help topic or, if there is more than one topic associated with the keyword, displays a list of topics from which the user can choose.</span></span>

<span data-ttu-id="13616-219">在應用程式中，您可以使用 HELP \_ 鍵、help \_ PARTIALKEY 或 help \_ MULTIKEY 命令搭配 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式，根據整個或部分關鍵字來搜尋和顯示說明主題。</span><span class="sxs-lookup"><span data-stu-id="13616-219">In an application, you can use the HELP\_KEY, HELP\_PARTIALKEY, or HELP\_MULTIKEY command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to search for and display help topics based on whole or partial keywords.</span></span> <span data-ttu-id="13616-220">您可以指定命令、關鍵字字串、說明檔，以及主控視窗的控制碼。</span><span class="sxs-lookup"><span data-stu-id="13616-220">You specify the command, the keyword string, the help file, and the handle to the owner window.</span></span> <span data-ttu-id="13616-221">在所有情況下，如果找到單一相符項， **WinHelp** 會顯示對應的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-221">In all cases, if a single match is found, **WinHelp** displays the corresponding topic.</span></span> <span data-ttu-id="13616-222">如果找到多個相符的函式，此函式會顯示 [找到的主題] 對話方塊，而使用者可以選擇要查看的主題。</span><span class="sxs-lookup"><span data-stu-id="13616-222">If more than one match is found, the function displays the Topics Found dialog box, and the user can choose which topic to view.</span></span> <span data-ttu-id="13616-223">如果找不到相符項， **WinHelp** 會顯示 [說明] 索引鍵的索引清單 (以及 [說明] \_ \_ PARTIALKEY) 或顯示錯誤訊息 ([說明 \_ MULTIKEY) ]。</span><span class="sxs-lookup"><span data-stu-id="13616-223">If no match is found, **WinHelp** either displays the Index list (for HELP\_KEY and HELP\_PARTIALKEY) or displays an error message (for HELP\_MULTIKEY).</span></span>

<span data-ttu-id="13616-224">您的應用程式可以 [**藉由使用**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 分號分隔關鍵字，在單一呼叫中搜尋多個關鍵字。</span><span class="sxs-lookup"><span data-stu-id="13616-224">Your application can search for multiple keywords in a single call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) by separating the keywords with semicolons.</span></span> <span data-ttu-id="13616-225">針對 Windows 第3版建立的說明檔，不支援搜尋多個關鍵字的 (。*x*) 它也可以在多個說明檔中搜尋關鍵字。如果指定的說明檔具有包含： Index 或： Link 命令的 ( cnt) 檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="13616-225">(Searching for multiple keywords is not supported for help files created for Windows version 3.*x*) It can also search for keywords across multiple help files if the help file that is specified has a contents(.cnt) file that contains :Index or :Link commands.</span></span> <span data-ttu-id="13616-226">使用 HELP \_ KEY 命令， **WinHelp** 會在這些命令指定的所有檔案中搜尋關鍵字。</span><span class="sxs-lookup"><span data-stu-id="13616-226">With the HELP\_KEY command, **WinHelp** searches for keywords in all files specified by these commands.</span></span> <span data-ttu-id="13616-227">透過 [說明] MULTIKEY 和 [說明] \_ \_ PARTIALKEY 命令，此函式會搜尋除了： Link 命令指定的所有檔案。</span><span class="sxs-lookup"><span data-stu-id="13616-227">With the HELP\_MULTIKEY and HELP\_PARTIALKEY commands, the function searches all files except those specified by :Link commands.</span></span>

<span data-ttu-id="13616-228">根據預設，Windows 說明只會辨識說明來源檔案中的 K 註腳字元所識別的關鍵字表。</span><span class="sxs-lookup"><span data-stu-id="13616-228">By default, Windows Help recognizes only the keyword table identified by the K footnote character in the help source file.</span></span> <span data-ttu-id="13616-229">您可以藉由在說明來源檔案中新增 K 以外的註腳字元（含關鍵字定義），指示 Windows 說明建立額外的關鍵字表。</span><span class="sxs-lookup"><span data-stu-id="13616-229">You can direct Windows Help to create additional keyword tables by adding a footnote character other than K, with the keyword definition, in the help source file.</span></span> <span data-ttu-id="13616-230">不過 (註腳字元 A 是保留的。 ) 您必須在建立說明檔時，于專案檔的 [選項] 區段中使用 MULTIKEY 語句，以定義任何其他關鍵字資料表 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="13616-230">(The footnote character A, however, is reserved.) You must define any additional keyword tables by using MULTIKEY statements in the \[OPTIONS\] section of the project file when building the help file.</span></span>

<span data-ttu-id="13616-231">應用程式可以使用 HELP \_ SETINDEX 命令搭配 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式來指示 Windows 說明，以在其索引清單中顯示 K 以外的關鍵字表格。</span><span class="sxs-lookup"><span data-stu-id="13616-231">An application can use the HELP\_SETINDEX command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to direct Windows Help to display a keyword table other than K in its Index list.</span></span> <span data-ttu-id="13616-232">若要指示 Windows 協助搜尋替代關鍵字表中的關鍵字，應用程式可以使用 HELP \_ MULTIKEY 命令。</span><span class="sxs-lookup"><span data-stu-id="13616-232">To direct Windows Help to search for a keyword in an alternate keyword table, an application can use the HELP\_MULTIKEY command.</span></span> <span data-ttu-id="13616-233">您可以在 [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) 結構中指定關鍵字和關鍵字表，並將它傳遞給 **WinHelp**。</span><span class="sxs-lookup"><span data-stu-id="13616-233">You specify the keyword and keyword table in a [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) structure, which you pass to **WinHelp**.</span></span>

<span data-ttu-id="13616-234">當 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 顯示主題時，它會在主題的 ">" 註腳所指定的視窗中，顯示在內容檔案的： Base 命令所指定的視窗中，或在主視窗中。</span><span class="sxs-lookup"><span data-stu-id="13616-234">When [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) displays a topic, it displays it in the window specified by the ">" footnote for the topic, in the window specified by the :Base command in the contents file, or in the main window.</span></span> <span data-ttu-id="13616-235">如果當您呼叫 **WinHelp** 時，主視窗已經開啟至不同的說明檔，則函式會在搜尋時隱藏主視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-235">If the main window is already open to a different help file when you call **WinHelp**, the function hides the main window while searching.</span></span> <span data-ttu-id="13616-236">在此情況下，請取消 [ **找到的主題** ] 和 [ **說明主題** ] 對話方塊關閉主視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-236">In this case, canceling both the **Topics Found** and **Help Topics** dialog boxes closes the main window.</span></span>

### <a name="secondary-help-windows"></a><span data-ttu-id="13616-237">次要說明視窗</span><span class="sxs-lookup"><span data-stu-id="13616-237">Secondary Help windows</span></span>

<span data-ttu-id="13616-238">Windows 輔助應用程式的主視窗稱為主視窗。</span><span class="sxs-lookup"><span data-stu-id="13616-238">The main window of the Windows Help application is called the primary window.</span></span> <span data-ttu-id="13616-239">Windows 說明也可以在次要視窗中顯示說明主題。</span><span class="sxs-lookup"><span data-stu-id="13616-239">Windows Help can also display help topics in a secondary window.</span></span> <span data-ttu-id="13616-240">不同于主要說明視窗，次要視窗不包含功能表列。</span><span class="sxs-lookup"><span data-stu-id="13616-240">Unlike the primary Help window, a secondary window does not contain a menu bar.</span></span> <span data-ttu-id="13616-241">您可以在次要視窗中包含巡覽列，也可以將按鈕加入至橫條。</span><span class="sxs-lookup"><span data-stu-id="13616-241">You can include a navigation bar in a secondary window, and you can add buttons to the bar.</span></span> <span data-ttu-id="13616-242">您也可以選擇讓 Windows 協助自動調整次要視窗的高度，以配合主題。</span><span class="sxs-lookup"><span data-stu-id="13616-242">You can also choose to have Windows Help automatically adjust the height of the secondary window to accommodate the topic.</span></span>

<span data-ttu-id="13616-243">您必須在說明專案檔的 [windows] 區段中定義次要視窗 \[ \] ，以提供每個視窗的名稱和選擇性的初始大小和位置。</span><span class="sxs-lookup"><span data-stu-id="13616-243">You must define secondary windows in the \[WINDOWS\] section of your help project file, providing the name and, optionally, initial size and position of each window.</span></span> <span data-ttu-id="13616-244">您可以藉由將角括弧 (>) ，以及您為次要視窗定義的名稱附加至說明檔的名稱，指示 Windows 說明應用程式在次要視窗中顯示主題。</span><span class="sxs-lookup"><span data-stu-id="13616-244">You can direct the Windows Help application to display a topic in a secondary window by appending an angle bracket (>) and the name you have defined for the secondary window to the name of the help file.</span></span> <span data-ttu-id="13616-245">產生的字串接著會傳遞至 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函數。</span><span class="sxs-lookup"><span data-stu-id="13616-245">The resulting string is then passed to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="13616-246">應用程式可以變更主要或次要視窗的大小和位置，方法是在 WinHelp 的呼叫中指定 [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa)結構的位址和 HELP \_ SETWINPOS 命令。 [](/windows/desktop/api/Winuser/nf-winuser-winhelpa)</span><span class="sxs-lookup"><span data-stu-id="13616-246">An application can change the size and position of a primary or secondary window by specifying the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure and the HELP\_SETWINPOS command in a call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="13616-247">**HELPWININFO** 指定視窗的名稱，以及其新的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="13616-247">**HELPWININFO** specifies the name of the window and its new size and position.</span></span>

### <a name="training-card-help"></a><span data-ttu-id="13616-248">訓練卡說明</span><span class="sxs-lookup"><span data-stu-id="13616-248">Training card help</span></span>

<span data-ttu-id="13616-249">使用「智慧卡說明」時，應用程式可以顯示一連串的指示，引導使用者完成工作的步驟。</span><span class="sxs-lookup"><span data-stu-id="13616-249">Using training card help, an application can display a sequence of instructions to guide the user through the steps of a task.</span></span> <span data-ttu-id="13616-250">訓練卡通常包含說明與 TCard 宏相關聯之特定步驟和按鈕的文字，可讓使用者告訴應用程式接下來該怎麼做。</span><span class="sxs-lookup"><span data-stu-id="13616-250">A training card typically consists of text that explains a particular step and buttons that are associated with TCard macros, which allow the user to tell the application what to do next.</span></span> <span data-ttu-id="13616-251">定型卡只能顯示在次要視窗中，而且不能包含說明檔中其他主題的熱連結。</span><span class="sxs-lookup"><span data-stu-id="13616-251">Training cards can only be displayed in secondary windows and must not contain hot links to other topics in the help file.</span></span>

<span data-ttu-id="13616-252">應用程式會藉由呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式並指定 help \_ TCARD 命令與其他命令（例如說明內容）來初始化 Windows 說明的定型卡實例 \_ 。</span><span class="sxs-lookup"><span data-stu-id="13616-252">An application initiates the training card instance of Windows Help by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_TCARD command in combination with another command, such as HELP\_CONTEXT.</span></span> <span data-ttu-id="13616-253">接著，當使用者按一下訓練卡中的按鈕時，按一下指派給 TCard 宏的作用點，或關閉訓練卡，Windows 說明就會傳送一則 [**WM \_ TCard**](wm-tcard.md) 訊息來通知應用程式。</span><span class="sxs-lookup"><span data-stu-id="13616-253">Subsequently, when the user clicks a button in the training card, clicks a hot spot assigned to the TCard macro, or closes the training card, Windows Help notifies the application by sending it a [**WM\_TCARD**](wm-tcard.md) message.</span></span> <span data-ttu-id="13616-254">*WParam* 參數會識別按鈕或使用者動作，而 *lParam* 參數會包含其他資料，其意義取決於 *wParam* 的值。</span><span class="sxs-lookup"><span data-stu-id="13616-254">The *wParam* parameter identifies the button or user action, and the *lParam* parameter contains additional data, the meaning of which depends on the value of *wParam*.</span></span>

### <a name="canceling-help"></a><span data-ttu-id="13616-255">取消說明</span><span class="sxs-lookup"><span data-stu-id="13616-255">Canceling Help</span></span>

<span data-ttu-id="13616-256">Windows 說明需要應用程式明確地取消說明，讓它可以釋放用來追蹤應用程式及其說明檔的任何資源。</span><span class="sxs-lookup"><span data-stu-id="13616-256">Windows Help requires an application to explicitly cancel help so that it can free any resources used to keep track of the application and its help files.</span></span> <span data-ttu-id="13616-257">應用程式可以隨時呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式並指定 HELP QUIT 命令，來進行這項作業 \_ 。</span><span class="sxs-lookup"><span data-stu-id="13616-257">The application can do this at any time by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_QUIT command.</span></span> <span data-ttu-id="13616-258">請注意，這對 Windows [說明] 的快顯實例而言並不正確。</span><span class="sxs-lookup"><span data-stu-id="13616-258">Note that this is not true for the pop-up instance of Windows Help.</span></span> <span data-ttu-id="13616-259">應用程式不應該嘗試關閉快顯視窗實例。</span><span class="sxs-lookup"><span data-stu-id="13616-259">An application should not try to close a pop-up instance.</span></span>

<span data-ttu-id="13616-260">如果應用程式已對 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa)進行任何呼叫，它必須在關閉其主視窗之前先取消說明 (例如，以回應 \_ 主視窗程式) 中的 WM 終結訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-260">If an application has made any calls to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), it must cancel help before it closes its main window (for example, in response to the WM\_DESTROY message in the main window procedure).</span></span> <span data-ttu-id="13616-261">應用程式只需要呼叫一次 **WinHelp** 即可取消說明，無論它已開啟多少說明檔。</span><span class="sxs-lookup"><span data-stu-id="13616-261">An application needs to call **WinHelp** only once to cancel help, no matter how many help files it has opened.</span></span> <span data-ttu-id="13616-262">在所有應用程式或 Dll 都已取消說明之前，Windows 說明會保持執行狀態。</span><span class="sxs-lookup"><span data-stu-id="13616-262">Windows Help remains running until all applications or DLLs have canceled help.</span></span>

<span data-ttu-id="13616-263">若要關閉 [Windows 說明] 的訓練卡實例，您必須同時指定 [說明 TCARD] 和 [說明]，以在 \_ \_ 呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa)時結束命令。</span><span class="sxs-lookup"><span data-stu-id="13616-263">To close the training card instance of Windows Help, you must specify both the HELP\_TCARD and HELP\_QUIT commands when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="13616-264">如果使用者先取消，則應用程式不需要取消 Windows 說明的訓練卡實例。</span><span class="sxs-lookup"><span data-stu-id="13616-264">An application does not need to cancel the training card instance of Windows Help if the user cancels it first.</span></span> <span data-ttu-id="13616-265">當使用者取消定型卡實例時，Windows 說明會將 *wParam* 參數設定為 IDCLOSE 來傳送 [**WM \_ TCARD**](wm-tcard.md)訊息，以通知應用程式。</span><span class="sxs-lookup"><span data-stu-id="13616-265">Windows Help notifies an application when the user cancels the training card instance by sending the [**WM\_TCARD**](wm-tcard.md) message with the *wParam* parameter set to IDCLOSE.</span></span>

## <a name="using-help"></a><span data-ttu-id="13616-266">使用說明</span><span class="sxs-lookup"><span data-stu-id="13616-266">Using Help</span></span>

<span data-ttu-id="13616-267">本節說明如何為對話方塊提供即時線上說明，以及如何設定次要說明視窗的外觀。</span><span class="sxs-lookup"><span data-stu-id="13616-267">This section shows how to provide context-sensitive help for a dialog box and how to set the appearance of a secondary Help window.</span></span>

-   [<span data-ttu-id="13616-268">在對話方塊中提供協助</span><span class="sxs-lookup"><span data-stu-id="13616-268">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
-   [<span data-ttu-id="13616-269">設定次要說明視窗的外觀</span><span class="sxs-lookup"><span data-stu-id="13616-269">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

### <a name="providing-help-in-a-dialog-box"></a><span data-ttu-id="13616-270">在對話方塊中提供協助</span><span class="sxs-lookup"><span data-stu-id="13616-270">Providing Help in a Dialog Box</span></span>

<span data-ttu-id="13616-271">若要在對話方塊中提供即時線上說明，您必須建立由 **DWORD** 值配對所組成的陣列。</span><span class="sxs-lookup"><span data-stu-id="13616-271">To provide context-sensitive help in a dialog box, you must create an array consisting of pairs of **DWORD** values.</span></span> <span data-ttu-id="13616-272">每一組中的第一個值都是對話方塊中控制項的識別碼，而第二個值則是控制項之說明主題的內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-272">The first value in each pair is the identifier of a control in the dialog box, and the second is the context identifier of the help topic for the control.</span></span> <span data-ttu-id="13616-273">陣列應該在對話方塊中包含每個控制項的一對識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-273">The array should contain one pair of identifiers for each control in the dialog box.</span></span>

<span data-ttu-id="13616-274">對話方塊程式必須處理 [**wm \_**](wm-help.md) 說明和 [**wm \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="13616-274">The dialog box procedure must process the [**WM\_HELP**](wm-help.md) and [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="13616-275">當使用者按一下滑鼠右鍵時，對話方塊程式會收到 Wm 說明，當使用者按下按鍵和 **WM \_ CONTEXTMENU** 時。 **\_**</span><span class="sxs-lookup"><span data-stu-id="13616-275">The dialog box procedure receives **WM\_HELP** when the user presses the key and **WM\_CONTEXTMENU** when the user clicks the right mouse button.</span></span>

<span data-ttu-id="13616-276">WM 說明的 *lParam* 參數包含 [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo)結構的位址。 [**\_**](wm-help.md)</span><span class="sxs-lookup"><span data-stu-id="13616-276">The *lParam* parameter of [**WM\_HELP**](wm-help.md) contains the address of a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure.</span></span> <span data-ttu-id="13616-277">此結構的 **hItemHandle** 成員會識別使用者已要求協助的控制項。</span><span class="sxs-lookup"><span data-stu-id="13616-277">The **hItemHandle** member of this structure identifies the control for which the user has requested help.</span></span> <span data-ttu-id="13616-278">您必須將這個控制碼傳遞給 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式，以及 help \_ WM \_ help 命令、說明檔的名稱，以及識別碼陣列的指標。</span><span class="sxs-lookup"><span data-stu-id="13616-278">You must pass this handle to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function along with the HELP\_WM\_HELP command, the name of your help file, and a pointer to the array of identifiers.</span></span> <span data-ttu-id="13616-279">**WinHelp** 函式會在陣列中搜尋指定控制項的控制項識別碼，然後取得對應的說明內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-279">The **WinHelp** function searches the array for the control identifier of the specified control and then retrieves the corresponding help context identifier.</span></span> <span data-ttu-id="13616-280">接下來，此函式會將說明內容識別碼傳遞至 Windows 說明，這會尋找對應的主題，並將其顯示在快顯視窗中。</span><span class="sxs-lookup"><span data-stu-id="13616-280">Next, the function passes the help context identifier to Windows Help, which finds the corresponding topic and displays it in a pop-up window.</span></span> <span data-ttu-id="13616-281">如果控制項有-1 的識別碼，系統會搜尋下一個控制項，此控制項是 tab 鍵停止，然後使用它的識別碼來尋找說明內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="13616-281">If the control has an identifier of -1, the system searches for the next control that is a tab stop and then uses its identifier to find the help context identifier.</span></span> <span data-ttu-id="13616-282">基於這個理由，請務必將靜態文字放在資源檔中的控制項之前。</span><span class="sxs-lookup"><span data-stu-id="13616-282">For this reason, it is important that you place static text before controls in a resource file.</span></span>

<span data-ttu-id="13616-283">呼叫 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函式時，處理 [**wm \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) 類似于處理具有下列兩個例外狀況的 [**wm \_**](wm-help.md) 說明：</span><span class="sxs-lookup"><span data-stu-id="13616-283">When calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) is similar to processing [**WM\_HELP**](wm-help.md) with these two exceptions:</span></span>

-   <span data-ttu-id="13616-284">您可以從 [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md)傳遞 *wParam* 參數，這是傳送訊息之控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="13616-284">You pass the *wParam* parameter from [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md), which is the handle to the control that sent the message.</span></span>
-   <span data-ttu-id="13616-285">您可以指定 **help \_ CONTEXTMENU** 命令，而不是 **help \_ WM \_ help**。</span><span class="sxs-lookup"><span data-stu-id="13616-285">You specify the **HELP\_CONTEXTMENU** command instead of **HELP\_WM\_HELP**.</span></span>

<span data-ttu-id="13616-286">**Help \_ CONTEXTMENU** 命令會在顯示說明主題之前，讓 Windows 說明顯示功能表。</span><span class="sxs-lookup"><span data-stu-id="13616-286">The **HELP\_CONTEXTMENU** command causes Windows Help to display a menu before it displays the help topic.</span></span> <span data-ttu-id="13616-287">此功能表為系統定義。</span><span class="sxs-lookup"><span data-stu-id="13616-287">The menu is system-defined.</span></span> <span data-ttu-id="13616-288">它可讓使用者顯示控制項的說明，或顯示 [ **說明主題** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="13616-288">It allows the user to display help for the control or to display the **Help Topics** dialog box.</span></span>

<span data-ttu-id="13616-289">下列範例顯示如何在對話方塊中執行即時線上說明。</span><span class="sxs-lookup"><span data-stu-id="13616-289">The following example shows how to implement context-sensitive help in a dialog box.</span></span>


```
LRESULT CALLBACK EditDlgProc(HWND hwndDlg, UINT uMsg, 
                             WPARAM wParam, LPARAM lParam) 
{ 
    // Create an array of control identifiers and context identifiers. 
    static DWORD aIds[ ] = 
    { 
        ID_SAVE,   IDH_SAVE, 
        ID_DELETE, IDH_DELETE, 
        ID_COPY,   IDH_COPY, 
        ID_PASTE,  IDH_PASTE, 
        0,0 
    }; 

    switch (uMsg) 
    { 
        case WM_HELP: 
            WinHelp(((LPHELPINFO)lParam)->hItemHandle, "helpfile.hlp", 
                    HELP_WM_HELP, (DWORD)(LPSTR)aIds); 
            break; 

        case WM_CONTEXTMENU: 
            WinHelp((HWND)wParam, "helpfile.hlp", HELP_CONTEXTMENU, 
                    (DWORD)(LPVOID)aIds); 
            break; 
        
        // Process other messages here. 
    } 
    return FALSE; 
}
```



### <a name="setting-the-appearance-of-a-secondary-help-window"></a><span data-ttu-id="13616-290">設定次要說明視窗的外觀</span><span class="sxs-lookup"><span data-stu-id="13616-290">Setting the Appearance of a Secondary Help Window</span></span>

<span data-ttu-id="13616-291">應用程式可以藉由將說明 \_ SETWINPOS 命令和 [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) 結構的位址傳遞至 [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) 函數，來設定次要說明視窗的大小、位置和顯示狀態。</span><span class="sxs-lookup"><span data-stu-id="13616-291">An application can set the size, position, and show state of a secondary help window by passing the HELP\_SETWINPOS command and the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="13616-292">**HELPWININFO** 的成員會指定要變更的視窗名稱，以及視窗的新大小、位置和顯示狀態。</span><span class="sxs-lookup"><span data-stu-id="13616-292">The members of **HELPWININFO** specify the name of the window to change and the window's new size, position, and show state.</span></span>

<span data-ttu-id="13616-293">下列範例會設定名為 "wnd<> menu" 的次要視窗外觀 \_ 。</span><span class="sxs-lookup"><span data-stu-id="13616-293">The following example sets the appearance of a secondary window named "wnd\_menu".</span></span> <span data-ttu-id="13616-294">您必須在說明專案檔的 [WINDOWS] 區段中定義該名稱 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="13616-294">The name must be defined in the \[WINDOWS\] section of the help project file.</span></span>


```
BOOL DoWindowSize(VOID) 
{ 
    HANDLE hhwi; 
    LPHELPWININFO lphwi; 
    WORD wSize; 
    char *szWndName = "wnd_menu"; 
    size_t NameLength;      // Does not include the terminating null character
    HRESULT hr
    BOOL retval;

    hr = StringCbLengthA(szWndName, STRSAFE_MAX_CCH, &NameLength);
    
    if (SUCCEEDED(hr))
    {
        // Add 1 to account for the name string's terminating null character.
        NameLength++;
        
        // The HELPWININFO structure contains a minimal TCHAR array of size [2] 
        // that is used for the window name. Since sizeof(HELPWININFO) 
        // includes those two TCHARS, they must be subtracted from the 
        // total when adding the actual string length to calculate the  
        // size of the structure. 
        wSize = sizeof(HELPWININFO) - 2 + NameLength; 
    }
    else
        // Something's amiss with the string.
        return FALSE;
        
    hhwi  = GlobalAlloc(GHND, wSize); 
    lphwi = (LPHELPWININFO)GlobalLock(hhwi); 

    lphwi->wStructSize = wSize; 
    lphwi->x    = 256;      // horizontal position 
    lphwi->y    = 256;      // vertical position 
    lphwi->dx   = 767;      // width 
    lphwi->dy   = 512;      // height 
    lphwi->wMax = SW_SHOW;  // show the window 
    
    // secondary window
    hr = StringCbCopyA(lphwi->rgchMember, sizeof(lphwi->rgchMember), szWndName);
    
    if (SUCCEEDED(hr))
    {
        WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, (DWORD)lphwi); 
     
        GlobalUnlock(hhwi); 
        GlobalFree(hhwi); 

        return TRUE; 
    }
    else
        // There was a problem copying the window name.
        return FALSE;
}
```



 

 
