---
description: Shell 剪貼簿格式是用來識別透過剪貼簿傳輸之 Shell 資料的類型。
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Shell 剪貼簿格式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103689811"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="053f8-103">Shell 剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="053f8-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="053f8-104">Shell 剪貼簿格式是用來識別透過剪貼簿傳輸之 Shell 資料的類型。</span><span class="sxs-lookup"><span data-stu-id="053f8-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="053f8-105">大部分的 Shell 剪貼簿格式都會識別資料類型，例如檔案名或專案識別碼清單的指標清單 (Pidl) 。</span><span class="sxs-lookup"><span data-stu-id="053f8-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="053f8-106">不過，某些格式會用於來源與目標之間的通訊。</span><span class="sxs-lookup"><span data-stu-id="053f8-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="053f8-107">藉由支援 Shell 作業（例如 [優化的移動](datascenarios.md) 和 [delete_on_paste](datascenarios.md)），他們可以加速資料傳輸流程。</span><span class="sxs-lookup"><span data-stu-id="053f8-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="053f8-108">Shell 資料一律包含在使用 [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc)結構作為資料特性之一般方式的 [資料物件](dataobject.md)中。</span><span class="sxs-lookup"><span data-stu-id="053f8-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="053f8-109">結構的 **cfFormat** 成員會設定為特定資料項目目的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="053f8-110">其他成員則提供其他資訊，例如資料傳輸機制。</span><span class="sxs-lookup"><span data-stu-id="053f8-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="053f8-111">資料會包含在隨附的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構中。</span><span class="sxs-lookup"><span data-stu-id="053f8-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="053f8-112">標準剪貼簿格式識別碼的格式為 CF_ *XXX*。</span><span class="sxs-lookup"><span data-stu-id="053f8-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="053f8-113">常見的範例是 CF_TEXT，用來傳送 ANSI 文字資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="053f8-114">這些識別碼具有預先定義的值，而且可以直接搭配 [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) 結構使用。</span><span class="sxs-lookup"><span data-stu-id="053f8-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="053f8-115">除了 [CF_HDROP](#cf_hdrop)之外，不會預先定義 Shell 格式識別碼。</span><span class="sxs-lookup"><span data-stu-id="053f8-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="053f8-116">除了 DragWindow 之外，它們的格式 CFSTR_ *XXX*。</span><span class="sxs-lookup"><span data-stu-id="053f8-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="053f8-117">為了區分這些值與預先定義的格式，這些值通常稱為單純 *格式*。</span><span class="sxs-lookup"><span data-stu-id="053f8-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="053f8-118">不過，與預先定義的格式不同的是，它們必須由來源和目標注冊，才能用來傳送資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="053f8-119">若要註冊 Shell 格式，請包含 Shlobj.h .h 標頭檔，並將 CFSTR_ *XXX* 格式識別碼傳遞至 [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)。</span><span class="sxs-lookup"><span data-stu-id="053f8-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="053f8-120">此函式會傳回有效的剪貼簿格式值，然後用來做為 **FORMATETC** 結構的 **cfFormat** 成員。</span><span class="sxs-lookup"><span data-stu-id="053f8-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="053f8-121">Shell 剪貼簿格式會根據使用方式，分成三個群組。</span><span class="sxs-lookup"><span data-stu-id="053f8-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="053f8-122">傳送檔案系統物件的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="053f8-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="053f8-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="053f8-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="053f8-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="053f8-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="053f8-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="053f8-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="053f8-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="053f8-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="053f8-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="053f8-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="053f8-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="053f8-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="053f8-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="053f8-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="053f8-131">傳輸虛擬物件的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="053f8-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="053f8-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="053f8-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="053f8-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="053f8-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="053f8-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="053f8-135">CFSTR_SHELLURL (已淘汰) </span><span class="sxs-lookup"><span data-stu-id="053f8-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="053f8-136">來源與目標之間通訊的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="053f8-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="053f8-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="053f8-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="053f8-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="053f8-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="053f8-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="053f8-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="053f8-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="053f8-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="053f8-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="053f8-144">DragWindow</span><span class="sxs-lookup"><span data-stu-id="053f8-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="053f8-145">傳送檔案系統物件的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="053f8-146">這些格式是用來傳送一個或多個檔案或其他 Shell 物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="053f8-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="053f8-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="053f8-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="053f8-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="053f8-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="053f8-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="053f8-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="053f8-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="053f8-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="053f8-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="053f8-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="053f8-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="053f8-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="053f8-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="053f8-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="053f8-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-155">CF_HDROP</span></span>

<span data-ttu-id="053f8-156">傳送現有檔案群組的位置時，會使用此剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="053f8-157">與其他 Shell 格式不同的是，它是預先定義的，因此不需要呼叫 [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)。</span><span class="sxs-lookup"><span data-stu-id="053f8-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="053f8-158">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-159">結構的 **hGlobal** 成員會指向 [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) 結構作為其 **hGlobal** 成員。</span><span class="sxs-lookup"><span data-stu-id="053f8-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="053f8-160">[**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles)結構的 **pFiles** 成員包含雙精度浮點數（以 **null** 結束的字元陣列）的位移，該陣列包含檔案名。</span><span class="sxs-lookup"><span data-stu-id="053f8-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="053f8-161">如果您要從資料物件中解壓縮 CF_HDROP 格式，您可以使用 [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) 從全域記憶體物件中解壓縮個別的檔案名。</span><span class="sxs-lookup"><span data-stu-id="053f8-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="053f8-162">如果您要建立要在資料物件中放置 CF_HDROP 格式，就必須建立檔案名陣列。</span><span class="sxs-lookup"><span data-stu-id="053f8-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="053f8-163">檔案名陣列是由一連串的字串所組成，每個字串都包含一個檔案的完整路徑，包括結束的 **Null** 字元。</span><span class="sxs-lookup"><span data-stu-id="053f8-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="053f8-164">最後一個字串會附加 **null** 字元，以終止陣列。</span><span class="sxs-lookup"><span data-stu-id="053f8-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="053f8-165">例如，如果正在傳送檔案 c： \\temp1.txt 和 c： \\temp2.txt，則字元陣列看起來像這樣：</span><span class="sxs-lookup"><span data-stu-id="053f8-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="053f8-166">在此範例中，' \\ 0 ' 是用來表示 **null** 字元，而不是應該包含的常值字元。</span><span class="sxs-lookup"><span data-stu-id="053f8-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="053f8-167">如果將物件複製到剪貼簿做為拖放作業的一部分， [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles)結構的 **pt** 成員就會包含卸載物件之點的座標。</span><span class="sxs-lookup"><span data-stu-id="053f8-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="053f8-168">您可以使用 [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) 來將資料指標座標解壓縮。</span><span class="sxs-lookup"><span data-stu-id="053f8-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="053f8-169">如果資料物件中有此格式，OLE 拖曳迴圈會模擬具有非 OLE 卸載目標的 [**WM_DROPFILES**](wm-dropfiles.md) 功能。</span><span class="sxs-lookup"><span data-stu-id="053f8-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="053f8-170">如果您的應用程式是 Windows 3.1 系統上拖放作業的來源，這就很重要。</span><span class="sxs-lookup"><span data-stu-id="053f8-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="053f8-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="053f8-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="053f8-172">此格式識別碼會搭配 [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) 格式使用，以像是檔案一樣傳送資料，而不論實際儲存的方式為何。</span><span class="sxs-lookup"><span data-stu-id="053f8-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="053f8-173">資料包含代表一個檔案內容的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="053f8-174">檔案通常會表示為數據流物件，以避免必須將檔案的內容放在記憶體中。</span><span class="sxs-lookup"><span data-stu-id="053f8-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="053f8-175">在這種情況下， **STGMEDIUM** 結構的 **tymed** 成員會設定為 TYMED_ISTREAM，而檔案是由 [**ISTREAM**](/windows/win32/api/objidl/nn-objidl-istream)介面表示。</span><span class="sxs-lookup"><span data-stu-id="053f8-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="053f8-176">檔案也可以是儲存或全域記憶體物件 (TYMED_ISTORAGE 或 TYMED_HGLOBAL) 。</span><span class="sxs-lookup"><span data-stu-id="053f8-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="053f8-177">相關聯的 CFSTR_FILEDESCRIPTOR 格式會包含每個檔案的 [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) 結構，以指定檔案的名稱和屬性。</span><span class="sxs-lookup"><span data-stu-id="053f8-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="053f8-178">目標會將與 CFSTR_FILECONTENTS 格式相關聯的資料視為檔案。</span><span class="sxs-lookup"><span data-stu-id="053f8-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="053f8-179">當目標呼叫 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) FILEDESCRIPTOR 來解壓縮資料時，它會藉由將 FORMATETC 結構的 lindex 成員設定為隨附的 [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor)格式，將 [](/windows/win32/api/objidl/ns-objidl-formatetc)結構的成員設定為檔案 [](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora)結構的以零為起始的索引，以指定特定的檔案。</span><span class="sxs-lookup"><span data-stu-id="053f8-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="053f8-180">目標接著會使用傳回的介面指標或全域記憶體控制碼來將資料解壓縮。</span><span class="sxs-lookup"><span data-stu-id="053f8-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="053f8-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="053f8-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="053f8-182">此格式識別碼會搭配 [CFSTR_FILECONTENTS](#cfstr_filecontents) 格式使用，以將資料當做一組檔案來傳送。</span><span class="sxs-lookup"><span data-stu-id="053f8-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="053f8-183">這兩種格式是傳輸 Shell 物件（不會儲存為檔案系統檔案）的慣用方法。</span><span class="sxs-lookup"><span data-stu-id="053f8-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="053f8-184">例如，這些格式可以用來將一組電子郵件訊息當作個別檔案來傳送，即使每封電子郵件實際上都儲存為資料庫中的資料區塊也是一樣。</span><span class="sxs-lookup"><span data-stu-id="053f8-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="053f8-185">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-186">結構的 **hGlobal** 成員指向 [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) 結構，後面接著一個陣列，其中包含群組中每個檔案的一個 [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="053f8-187">針對每個 **FILEDESCRIPTOR** 結構，有一個包含檔案內容的個別 CFSTR_FILECONTENTS 格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="053f8-188">若要識別特定檔案的 CFSTR_FILECONTENTS 格式，請將 [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc)結構的 **lIndex** 值設定為檔案 **FILEDESCRIPTOR** 結構的以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="053f8-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="053f8-189">CFSTR_FILEDESCRIPTOR 格式通常用來傳送資料，就像是一組檔案一樣，不論實際儲存的方式為何。</span><span class="sxs-lookup"><span data-stu-id="053f8-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="053f8-190">從目標的觀點來看，每個 CFSTR_FILECONTENTS 格式都代表一個檔案，並據此處理。</span><span class="sxs-lookup"><span data-stu-id="053f8-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="053f8-191">不過，來源可以用任何選擇的方式來儲存資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="053f8-192">雖然 CSFTR_FILECONTENTS 格式可能對應至單一檔案，但它也可能代表從資料庫或文字檔中的來源所解壓縮的資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="053f8-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="053f8-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="053f8-194">此格式識別碼是用來傳送單一檔案。</span><span class="sxs-lookup"><span data-stu-id="053f8-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="053f8-195">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-196">結構的 **hGlobal** 成員指向單一以 **null** 終止的字串，其中包含檔案的完整檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="053f8-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="053f8-197">[CF_HDROP](#cf_hdrop)已取代此格式，但支援與 Windows 3.1 應用程式的回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="053f8-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="053f8-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="053f8-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="053f8-199">當 [CF_HDROP](#cf_hdrop) 格式的檔案群組重新命名及傳輸時，就會使用此格式識別碼。</span><span class="sxs-lookup"><span data-stu-id="053f8-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="053f8-200">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-201">結構的 **hGlobal** 成員指向雙 **null** 結束的字元陣列。</span><span class="sxs-lookup"><span data-stu-id="053f8-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="053f8-202">此陣列包含每個檔案的新名稱，順序與隨附的 CF_HDROP 格式相同。</span><span class="sxs-lookup"><span data-stu-id="053f8-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="053f8-203">字元陣列的格式與 CF_HDROP 用來列出已傳送檔案的格式相同。</span><span class="sxs-lookup"><span data-stu-id="053f8-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="053f8-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="053f8-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="053f8-205">此格式識別碼是用來在載入的磁片區上傳送路徑。</span><span class="sxs-lookup"><span data-stu-id="053f8-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="053f8-206">它類似于 [CF_HDROP](#cf_hdrop)，但它只包含單一路徑，而且可以處理在資料夾上掛接磁片區時，可能需要用來代表路徑的較長路徑字串。</span><span class="sxs-lookup"><span data-stu-id="053f8-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="053f8-207">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-208">結構的 **hGlobal** 成員指向單一以 **null** 終止的字串，其中包含完整的檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="053f8-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="053f8-209">路徑字串的結尾必須是 ' \\ ' 字元，後面接著終止的 **Null**。</span><span class="sxs-lookup"><span data-stu-id="053f8-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="053f8-210">在 Windows 2000 之前，只能將磁片區掛接在磁碟機號上。</span><span class="sxs-lookup"><span data-stu-id="053f8-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="053f8-211">針對具有 NTFS 格式化磁片磁碟機的 Windows 2000 和更新版本的系統，您也可以在空的資料夾上裝載磁片區。</span><span class="sxs-lookup"><span data-stu-id="053f8-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="053f8-212">這項功能可讓您掛接磁片區，而不需要佔用磁碟機號。</span><span class="sxs-lookup"><span data-stu-id="053f8-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="053f8-213">載入的磁片區可以使用任何目前支援的格式，包括 FAT、FAT32、NTFS 和 CDFS.SYS。</span><span class="sxs-lookup"><span data-stu-id="053f8-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="053f8-214">您可以藉由執行 [屬性工作表處理常式](propsheet-handlers.md)，將頁面加入至磁片磁碟機屬性屬性工作表。</span><span class="sxs-lookup"><span data-stu-id="053f8-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="053f8-215">如果磁片區是掛接在磁碟機號上，Shell 會將路徑資訊傳遞給具有 [CF_HDROP](#cf_hdrop) 格式的處理常式。</span><span class="sxs-lookup"><span data-stu-id="053f8-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="053f8-216">在 Windows 2000 和更新版本的系統中，將磁片區掛接到磁碟機號時，就會使用 CF_HDROP 格式，就像舊版系統一樣。</span><span class="sxs-lookup"><span data-stu-id="053f8-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="053f8-217">但是，如果磁片區掛接在資料夾上，則會使用 [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) 格式識別碼，而不是 CF_HDROP。</span><span class="sxs-lookup"><span data-stu-id="053f8-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="053f8-218">如果只會使用磁碟機號來裝載磁片區，則只會使用 [CF_HDROP](#cf_hdrop) ，而現有的屬性工作表處理常式會像處理舊版系統一樣運作。</span><span class="sxs-lookup"><span data-stu-id="053f8-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="053f8-219">但是，如果您想要讓處理常式針對掛接于資料夾以及磁碟機號的磁片區顯示頁面，則處理常式必須能夠同時瞭解 CSFTR_MOUNTEDVOLUME 和 CF_HDROP 格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="053f8-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="053f8-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="053f8-221">傳送一個或多個現有命名空間物件的位置時，會使用此格式識別碼。</span><span class="sxs-lookup"><span data-stu-id="053f8-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="053f8-222">它的使用方式與 [CF_HDROP](#cf_hdrop)很類似，但它包含 pidl，而不是檔案系統路徑。</span><span class="sxs-lookup"><span data-stu-id="053f8-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="053f8-223">使用 Pidl 可讓 CFSTR_SHELLIDLIST 格式處理虛擬物件以及檔案系統物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="053f8-224">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-225">結構的 **hGlobal** 成員會指向 [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="053f8-226">[**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida)結構的 **aoffset** 成員是一個陣列，其中包含要傳送之每個 PIDL 的 [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist)結構開頭位移。</span><span class="sxs-lookup"><span data-stu-id="053f8-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="053f8-227">若要解壓縮特定的 PIDL，請先決定其索引。</span><span class="sxs-lookup"><span data-stu-id="053f8-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="053f8-228">然後，將對應至該索引的 **aoffset** 值加入至 **CIDA** 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="053f8-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="053f8-229">**Aoffset** 的第一個元素包含父資料夾完整 PIDL 的位移。</span><span class="sxs-lookup"><span data-stu-id="053f8-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="053f8-230">如果這個 PIDL 是空的，則上層資料夾是桌面。</span><span class="sxs-lookup"><span data-stu-id="053f8-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="053f8-231">陣列其餘的每個元素都包含要傳送的其中一個 Pidl 的位移。</span><span class="sxs-lookup"><span data-stu-id="053f8-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="053f8-232">這些 Pidl 都是相對於父資料夾的 PIDL。</span><span class="sxs-lookup"><span data-stu-id="053f8-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="053f8-233">下列兩個宏可以用來從 [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) 結構取出 pidl。</span><span class="sxs-lookup"><span data-stu-id="053f8-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="053f8-234">第一個會接受結構的指標，並抓取父資料夾的 PIDL。</span><span class="sxs-lookup"><span data-stu-id="053f8-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="053f8-235">第二個會使用結構的指標，並取得以零為基底之索引所識別的其他 Pidl 之一。</span><span class="sxs-lookup"><span data-stu-id="053f8-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="053f8-236">這些宏所傳回的值是 PIDL 之 [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="053f8-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="053f8-237">因為這些結構的長度不同，所以您必須透過逐步執行每個 **ITEMIDLIST** 結構的 [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) 結構來判斷結構的結尾，直到達到標示結尾的雙位元組 **Null** 為止。</span><span class="sxs-lookup"><span data-stu-id="053f8-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="053f8-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="053f8-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="053f8-239">此格式識別碼會搭配 [CF_HDROP](#cf_hdrop)、 [CFSTR_SHELLIDLIST](#cfstr_shellidlist)和 [CFSTR_FILECONTENTS](#cfstr_filecontents) 等格式使用，以指定在傳輸之後物件群組的位置。</span><span class="sxs-lookup"><span data-stu-id="053f8-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="053f8-240">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所組成。</span><span class="sxs-lookup"><span data-stu-id="053f8-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-241">結構的 **hGlobal** 成員指向 [**點**](/previous-versions//dd162805(v=vs.85)) 結構的陣列。</span><span class="sxs-lookup"><span data-stu-id="053f8-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="053f8-242">第一個結構指定包圍群組之矩形左上角的螢幕座標（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="053f8-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="053f8-243">結構的其餘部分會指定相對於群組位置之個別物件的位置。</span><span class="sxs-lookup"><span data-stu-id="053f8-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="053f8-244">它們的順序必須與用來列出相關格式之物件的順序相同。</span><span class="sxs-lookup"><span data-stu-id="053f8-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="053f8-245">傳輸虛擬物件的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="053f8-246">CFSTR_SHELLIDLIST 格式可以用來傳送檔案系統和虛擬物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="053f8-247">不過，也有數種特殊格式可用於傳輸特定類型的虛擬物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="053f8-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="053f8-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="053f8-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="053f8-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="053f8-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="053f8-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="053f8-251">CFSTR_SHELLURL (已淘汰) </span><span class="sxs-lookup"><span data-stu-id="053f8-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="053f8-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="053f8-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="053f8-253">傳輸網路資源（例如網域或伺服器）時，會使用此格式識別碼。</span><span class="sxs-lookup"><span data-stu-id="053f8-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="053f8-254">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-255">結構的 **hGlobal** 成員會指向 [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="053f8-256">該結構的 **nr** 成員表示 [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) 結構，其 **lpRemoteName** 成員包含可識別網路資源的以 **null** 終止的字串。</span><span class="sxs-lookup"><span data-stu-id="053f8-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="053f8-257">然後，卸載目標可將資料與任何 [Windows 網路 (WNet)](../wnet/windows-networking-wnet-.md) API 函式（例如 [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona)）搭配使用，以在物件上執行網路作業。</span><span class="sxs-lookup"><span data-stu-id="053f8-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="053f8-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="053f8-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="053f8-259">傳送易記的印表機名稱時，會使用此格式識別碼。</span><span class="sxs-lookup"><span data-stu-id="053f8-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="053f8-260">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-261">結構的 **hGlobal** 成員會指向與 [CF_HDROP](#cf_hdrop)搭配使用之格式相同的字串。</span><span class="sxs-lookup"><span data-stu-id="053f8-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="053f8-262">但是， [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles)結構的 **pFiles** 成員會包含一或多個易記的印表機名稱，而不是檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="053f8-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="053f8-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="053f8-263">CFSTR_INETURL</span></span>

<span data-ttu-id="053f8-264">此格式識別碼會取代 [CFSTR_SHELLURL (已淘汰的) ](#cfstr_shellurl-deprecated)。</span><span class="sxs-lookup"><span data-stu-id="053f8-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="053f8-265">如果您想要讓應用程式操作剪貼簿 Url，請使用 CFSTR_INETURL 而不是 CFSTR_SHELLURL (已淘汰的) 。</span><span class="sxs-lookup"><span data-stu-id="053f8-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="053f8-266">這種格式可提供最佳的單一 URL 剪貼簿表示。</span><span class="sxs-lookup"><span data-stu-id="053f8-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="053f8-267">如果未定義 UNICODE，則應用程式會抓取 URL 的 CF_TEXT/CFSTR_SHELLURL 版本。</span><span class="sxs-lookup"><span data-stu-id="053f8-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="053f8-268">如果已定義 UNICODE，則應用程式會抓取 URL 的 CF_UNICODE 版本。</span><span class="sxs-lookup"><span data-stu-id="053f8-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="053f8-269">CFSTR_SHELLURL (已淘汰) </span><span class="sxs-lookup"><span data-stu-id="053f8-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="053f8-270">此格式識別碼已被取代;請改用 CFSTR_INETURL。</span><span class="sxs-lookup"><span data-stu-id="053f8-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="053f8-271">來源與目標之間通訊的格式</span><span class="sxs-lookup"><span data-stu-id="053f8-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="053f8-272">這些格式識別碼允許來源與目標之間的通訊。</span><span class="sxs-lookup"><span data-stu-id="053f8-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="053f8-273">伴隨資料的格式，並讓應用程式更能掌控與 Shell 物件有關的移動-複製貼上或拖放作業。</span><span class="sxs-lookup"><span data-stu-id="053f8-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="053f8-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="053f8-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="053f8-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="053f8-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="053f8-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="053f8-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="053f8-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="053f8-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="053f8-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="053f8-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="053f8-281">DragWindow</span><span class="sxs-lookup"><span data-stu-id="053f8-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="053f8-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="053f8-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="053f8-283">資料物件會使用此格式識別碼來指出它是否在拖放迴圈中。</span><span class="sxs-lookup"><span data-stu-id="053f8-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="053f8-284">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-285">結構的 **hGlobal** 成員指向 **DWORD** 值。</span><span class="sxs-lookup"><span data-stu-id="053f8-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="053f8-286">如果 **DWORD** 值為非零值，則資料物件在拖放迴圈內。</span><span class="sxs-lookup"><span data-stu-id="053f8-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="053f8-287">如果值設定為零，則資料物件不在拖放迴圈內。</span><span class="sxs-lookup"><span data-stu-id="053f8-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="053f8-288">某些卸載目標可能會呼叫 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) ，並在物件仍在拖放迴圈內時嘗試將資料解壓縮。</span><span class="sxs-lookup"><span data-stu-id="053f8-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="053f8-289">針對每個這種情況完全呈現物件，可能會導致拖曳游標停止。</span><span class="sxs-lookup"><span data-stu-id="053f8-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="053f8-290">如果資料物件支援 [CFSTR_INDRAGLOOP](#cfstr_indragloop)，目標可以改為使用該格式來檢查拖放迴圈的狀態，並避免物件的記憶體密集轉譯，直到實際卸載為止。</span><span class="sxs-lookup"><span data-stu-id="053f8-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="053f8-291">記憶體密集轉譯的格式應該仍包含在 [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) 列舉值中，以及 [**IDataObject：： QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata)的呼叫中。</span><span class="sxs-lookup"><span data-stu-id="053f8-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="053f8-292">如果資料物件未設定 CFSTR_INDRAGLOOP，則應該將值設定為零。</span><span class="sxs-lookup"><span data-stu-id="053f8-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="053f8-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="053f8-294">[版本5.0。](versions.md)此格式識別碼可讓卸載來源呼叫資料物件的 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) 的方法，以判斷 Shell 資料傳輸的結果。</span><span class="sxs-lookup"><span data-stu-id="053f8-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="053f8-295">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-296">結構的 **hGlobal** 成員會指向包含 [**DROPEFFECT**](../com/dropeffect-constants.md) 值的 DWORD。</span><span class="sxs-lookup"><span data-stu-id="053f8-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="053f8-297">[CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect)格式識別碼的目的是要讓目標向資料物件指出實際發生的作業。</span><span class="sxs-lookup"><span data-stu-id="053f8-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="053f8-298">不過，Shell 會盡可能針對檔案系統物件使用 [優化的移動](datascenarios.md) 。</span><span class="sxs-lookup"><span data-stu-id="053f8-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="053f8-299">在此情況下，Shell 通常會將 CFSTR_PERFORMEDDROPEFFECT 值設定為 DROPEFFECT_NONE，以向資料物件表示已刪除原始資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="053f8-300">因此，來源無法使用 CFSTR_PERFORMEDDROPEFFECT 值來判斷發生了哪些作業。</span><span class="sxs-lookup"><span data-stu-id="053f8-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="053f8-301">雖然大部分的來源都不需要這項資訊，但還是有一些例外狀況。</span><span class="sxs-lookup"><span data-stu-id="053f8-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="053f8-302">例如，即使優化的移動不需要讓來源刪除任何資料，來源可能仍需要更新相關的資料庫，以指出檔案已移動或複製。</span><span class="sxs-lookup"><span data-stu-id="053f8-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="053f8-303">如果來源需要知道發生的是哪一個作業，它可以呼叫資料物件的 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) 的方法，並要求 CFSTR_LOGICALPERFORMEDDROPEFFECT 格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="053f8-304">這種格式基本上會反映在作業完成之後，從使用者的觀點來看，會發生什麼事。</span><span class="sxs-lookup"><span data-stu-id="053f8-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="053f8-305">如果已建立新的檔案，並刪除原始檔案，則使用者會看見移動作業，而且格式的資料值會設定為 DROPEFFECT_MOVE。</span><span class="sxs-lookup"><span data-stu-id="053f8-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="053f8-306">如果原始檔案仍在該處，則使用者會看到複製作業，而且格式的資料值會設定為 DROPEFFECT_COPY。</span><span class="sxs-lookup"><span data-stu-id="053f8-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="053f8-307">如果已建立連結，將會 DROPEFFECT_LINK 格式的資料值。</span><span class="sxs-lookup"><span data-stu-id="053f8-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="053f8-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="053f8-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="053f8-309">目標會使用此格式識別碼，透過其 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) 方法來通知資料物件，即刪除貼上作業已成功。</span><span class="sxs-lookup"><span data-stu-id="053f8-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="053f8-310">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-311">結構的 **hGlobal** 成員會指向包含 [**DROPEFFECT**](../com/dropeffect-constants.md)值的 **DWORD** 。</span><span class="sxs-lookup"><span data-stu-id="053f8-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="053f8-312">這種格式是用來通知資料物件應完成剪下作業，並視需要刪除原始資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="053f8-313">如需詳細資訊，請參閱「 [刪除時刪除」作業](datascenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="053f8-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="053f8-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="053f8-315">目標會使用此格式識別碼，透過資料傳輸結果的 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) 方法來通知資料物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="053f8-316">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-317">結構的 **hGlobal** 成員會指向設定為適當 [**DROPEFFECT**](../com/dropeffect-constants.md)值的 **DWORD** ，通常是 DROPEFFECT_MOVE 或 DROPEFFECT_COPY。</span><span class="sxs-lookup"><span data-stu-id="053f8-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="053f8-318">這種格式通常會在作業的結果可以是移動或複製時使用，例如在 [優化的移動](datascenarios.md) 或刪除貼上作業中。</span><span class="sxs-lookup"><span data-stu-id="053f8-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="053f8-319">它提供可靠的方式，讓目標知道實際發生的資料物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="053f8-320">這是因為 [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop)所傳回的 *pdwEffect* 值未可靠地指出發生了哪些作業而引進的。</span><span class="sxs-lookup"><span data-stu-id="053f8-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="053f8-321">[CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect)格式是表示已進行未優化移動的可靠方式。</span><span class="sxs-lookup"><span data-stu-id="053f8-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="053f8-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="053f8-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="053f8-323">來源會使用此格式識別碼來指定其慣用的資料傳輸方法是移動或複製。</span><span class="sxs-lookup"><span data-stu-id="053f8-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="053f8-324">放置目標會藉由呼叫資料物件的 [**IDataObject：：：：：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) 的方法來要求此格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="053f8-325">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-326">結構的 **hGlobal** 成員指向 **DWORD** 值。</span><span class="sxs-lookup"><span data-stu-id="053f8-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="053f8-327">如果慣用移動作業，則此值會設定為 DROPEFFECT_MOVE，如果偏好複製作業則為 DROPEFFECT_COPY。</span><span class="sxs-lookup"><span data-stu-id="053f8-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="053f8-328">當來源可以支援移動或複製作業時，就會使用這項功能。</span><span class="sxs-lookup"><span data-stu-id="053f8-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="053f8-329">它會使用 [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) 格式，將其喜好設定與目標通訊。</span><span class="sxs-lookup"><span data-stu-id="053f8-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="053f8-330">因為目標並不負責接受要求，所以目標必須以 [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect)格式呼叫來源的 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata)方法，以告知資料物件實際執行的作業。</span><span class="sxs-lookup"><span data-stu-id="053f8-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="053f8-331">使用「 [刪除時刪除](datascenarios.md) 」作業時，CFSTR_PREFERREDDROPFORMAT 格式會用來告知目標來源是否已剪下或複製。</span><span class="sxs-lookup"><span data-stu-id="053f8-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="053f8-332">使用拖放作業時，您可以使用 CFSTR_PREFERREDDROPFORMAT 來指定 Shell 的動作。</span><span class="sxs-lookup"><span data-stu-id="053f8-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="053f8-333">如果不存在此格式，Shell 會根據內容執行預設動作。</span><span class="sxs-lookup"><span data-stu-id="053f8-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="053f8-334">比方說，如果使用者從某個磁片區拖曳檔案，然後將它放在另一個磁片區上，則 Shell 的預設動作是複製檔案。</span><span class="sxs-lookup"><span data-stu-id="053f8-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="053f8-335">藉由在資料物件中包含 CFSTR_PREFERREDDROPFORMAT 格式，您可以覆寫預設動作，並明確地指示 Shell 複製、移動或連結檔案。</span><span class="sxs-lookup"><span data-stu-id="053f8-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="053f8-336">如果使用者選擇使用右邊的按鈕拖曳，CFSTR_PREFERREDDROPFORMAT 會在 [拖放](context-menu-handlers.md) 快捷方式功能表上指定預設命令。</span><span class="sxs-lookup"><span data-stu-id="053f8-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="053f8-337">使用者仍然可以自由選擇功能表上的其他命令。</span><span class="sxs-lookup"><span data-stu-id="053f8-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="053f8-338">在 Microsoft Internet Explorer 4.0 之前，應用程式會藉由在 [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora)結構的 **dwFlags** 成員中設定 FD_LINKUI，來指出它正在傳送快捷方式檔案類型。</span><span class="sxs-lookup"><span data-stu-id="053f8-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="053f8-339">目標接著必須使用可能耗時的 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) 呼叫，以找出是否已設定 FD_LINKUI 旗標。</span><span class="sxs-lookup"><span data-stu-id="053f8-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="053f8-340">現在，要用來表示快速鍵的慣用方式是使用設定為 DROPEFFECT_LINK 的 CFSTR_PREFERREDDROPEFFECT 格式。</span><span class="sxs-lookup"><span data-stu-id="053f8-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="053f8-341">不過，為了與舊版系統回溯相容，來源仍應設定 FD_LINKUI 旗標。</span><span class="sxs-lookup"><span data-stu-id="053f8-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="053f8-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="053f8-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="053f8-343">目標會使用此格式識別碼，將其 CLSID 提供給來源。</span><span class="sxs-lookup"><span data-stu-id="053f8-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="053f8-344">資料是包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。</span><span class="sxs-lookup"><span data-stu-id="053f8-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-345">結構的 **hGlobal** 成員指向放置目標的 CLSID GUID。</span><span class="sxs-lookup"><span data-stu-id="053f8-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="053f8-346">此格式主要用於將物件拖曳至資源回收筒，以允許將物件刪除。</span><span class="sxs-lookup"><span data-stu-id="053f8-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="053f8-347">在資源回收筒中卸載物件時，會呼叫來源的 [**IDataObject：： SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) 方法，並將 CFSTR_TARGETCLSID 格式設定為資源回收筒的 CLSID (CLSID_RecycleBin) 。</span><span class="sxs-lookup"><span data-stu-id="053f8-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="053f8-348">然後，來源可以刪除原始物件。</span><span class="sxs-lookup"><span data-stu-id="053f8-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="053f8-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="053f8-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="053f8-350">Windows Internet Explorer 和 Windows Shell 會使用此格式識別碼，以提供一種機制，用來封鎖或提示源自 Internet Explorer 的拖放作業，以及 [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) 旗標。</span><span class="sxs-lookup"><span data-stu-id="053f8-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="053f8-351">**CFSTR_UNTRUSTEDDRAGDROP** 是由拖放作業的來源加入，以指定資料物件可能包含不信任的資料。</span><span class="sxs-lookup"><span data-stu-id="053f8-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="053f8-352">資料是由包含全域記憶體物件的 [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構所表示。</span><span class="sxs-lookup"><span data-stu-id="053f8-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="053f8-353">結構的 **hGlobal** 成員會指向一個 **DWORD** 設定為適當的 [**URL 動作**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85))旗標，以使用 [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85))旗標，透過 [**IInternetSecurityManager：:P rocessurlaction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85))方法來檢查原則。</span><span class="sxs-lookup"><span data-stu-id="053f8-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="053f8-354">DragWindow</span><span class="sxs-lookup"><span data-stu-id="053f8-354">DragWindow</span></span>

<span data-ttu-id="053f8-355">這種格式會在拖放作業中用來識別物件的拖曳影像 (視窗) ，讓其視覺效果資訊可以動態更新。</span><span class="sxs-lookup"><span data-stu-id="053f8-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="053f8-356">將物件拖曳至放置目標上時，應用程式會更新其 [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) 結構，以回應 [**IDropTarget：:D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) 或 [**IDropSource：： system.windows.dragdrop.givefeedback>**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) 方法。</span><span class="sxs-lookup"><span data-stu-id="053f8-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="053f8-357">**DROPDESCRIPTION** 會更新為新的 [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype)值，指出要套用至拖曳視窗視覺效果的裝飾;例如，指出檔案正在複製而不是移動，或物件無法卸載至該位置。</span><span class="sxs-lookup"><span data-stu-id="053f8-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="053f8-358">不過，在物件收到 [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) 訊息之前，不會更新視覺效果。</span><span class="sxs-lookup"><span data-stu-id="053f8-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="053f8-359">此格式會將收件者拖曳視窗的 **HWND** 提供給 **DDWM_UPDATEWINDOW** 訊息的傳送者。</span><span class="sxs-lookup"><span data-stu-id="053f8-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="053f8-360">剪貼簿資料的類型 [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed)。</span><span class="sxs-lookup"><span data-stu-id="053f8-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="053f8-361">它是 **HWND** 的 **DWORD** 標記法。</span><span class="sxs-lookup"><span data-stu-id="053f8-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="053f8-362">資料可以傳遞至 **ULongToHandle** 函數（定義于 Basetsd 中），以提供要在64位 Windows 上使用的64位 **HWND** 。</span><span class="sxs-lookup"><span data-stu-id="053f8-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="053f8-363">此格式不需要包含 Shlobj.h。</span><span class="sxs-lookup"><span data-stu-id="053f8-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
