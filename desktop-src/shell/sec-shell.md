---
description: 本主題提供與 Windows Shell 相關之安全性考慮的資訊。
ms.assetid: eca31652-2659-456d-b082-c84d6fd39094
title: 安全性考慮： Microsoft Windows Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 16b11a965a36a403b57a3e5229fc758a4ce37252
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103691200"
---
# <a name="security-considerations-microsoft-windows-shell"></a><span data-ttu-id="34a67-103">安全性考慮： Microsoft Windows Shell</span><span class="sxs-lookup"><span data-stu-id="34a67-103">Security Considerations: Microsoft Windows Shell</span></span>

<span data-ttu-id="34a67-104">本主題提供與 Windows Shell 相關之安全性考慮的資訊。</span><span class="sxs-lookup"><span data-stu-id="34a67-104">This topic provides information about security considerations related to the Windows Shell.</span></span> <span data-ttu-id="34a67-105">本檔無法提供您所需的安全性問題相關資訊，而是將其作為此特定技術領域的起點和參考。</span><span class="sxs-lookup"><span data-stu-id="34a67-105">This document cannot provide all you need to know about security issues—instead, use it as a starting point and reference for this specific technology area.</span></span>

<span data-ttu-id="34a67-106">Shell 會控制系統的一些重要層面，包括有許多可能會在未適當處理的情況下呈現潛在的安全性風險。</span><span class="sxs-lookup"><span data-stu-id="34a67-106">The Shell controls a number of important aspects of the system, including several that present potential security risks if they are not properly handled.</span></span> <span data-ttu-id="34a67-107">本主題將概述一些較常見的問題，以及如何在您的應用程式中解決這些問題。</span><span class="sxs-lookup"><span data-stu-id="34a67-107">This topic outlines some of the more common issues and how to address them in your applications.</span></span> <span data-ttu-id="34a67-108">請記住，安全性並不限於以網際網路為基礎的攻擊。</span><span class="sxs-lookup"><span data-stu-id="34a67-108">Remember that security is not limited to Internet-based exploits.</span></span> <span data-ttu-id="34a67-109">在共用系統（包括可透過終端機服務存取的系統）上，您也必須確保使用者無法執行任何可能會危害共用系統的其他人。</span><span class="sxs-lookup"><span data-stu-id="34a67-109">On shared systems, including systems that are accessible through Terminal Services, you must also ensure that users cannot do anything that could harm others who share the system.</span></span>

-   [<span data-ttu-id="34a67-110">正確安裝您的應用程式</span><span class="sxs-lookup"><span data-stu-id="34a67-110">Installing Your Application Properly</span></span>](#installing-your-application-properly)
-   [<span data-ttu-id="34a67-111">Shlwapi</span><span class="sxs-lookup"><span data-stu-id="34a67-111">Shlwapi</span></span>](#shlwapi)
-   [<span data-ttu-id="34a67-112">自動完成</span><span class="sxs-lookup"><span data-stu-id="34a67-112">Autocomplete</span></span>](#autocomplete)
-   [<span data-ttu-id="34a67-113">ShellExecute、ShellExecuteEx 和相關函數</span><span class="sxs-lookup"><span data-stu-id="34a67-113">ShellExecute, ShellExecuteEx, and Related Functions</span></span>](#shellexecute-shellexecuteex-and-related-functions)
-   [<span data-ttu-id="34a67-114">移動和複製檔案</span><span class="sxs-lookup"><span data-stu-id="34a67-114">Moving and Copying Files</span></span>](#moving-and-copying-files)
-   [<span data-ttu-id="34a67-115">撰寫安全的命名空間延伸模組</span><span class="sxs-lookup"><span data-stu-id="34a67-115">Writing Secure Namespace Extensions</span></span>](#writing-secure-namespace-extensions)
-   [<span data-ttu-id="34a67-116">安全性警示</span><span class="sxs-lookup"><span data-stu-id="34a67-116">Security Alerts</span></span>](#security-alerts)
-   [<span data-ttu-id="34a67-117">相關主題</span><span class="sxs-lookup"><span data-stu-id="34a67-117">Related topics</span></span>](#related-topics)

## <a name="installing-your-application-properly"></a><span data-ttu-id="34a67-118">正確安裝您的應用程式</span><span class="sxs-lookup"><span data-stu-id="34a67-118">Installing Your Application Properly</span></span>

<span data-ttu-id="34a67-119">藉由正確安裝您的應用程式，可減輕大部分的潛在 Shell 安全性問題。</span><span class="sxs-lookup"><span data-stu-id="34a67-119">The majority of potential Shell security issues can be mitigated by correctly installing your application.</span></span>

-   <span data-ttu-id="34a67-120">在 [Program Files] 資料夾下安裝應用程式。</span><span class="sxs-lookup"><span data-stu-id="34a67-120">Install the application under the Program Files folder.</span></span> 

    | <span data-ttu-id="34a67-121">作業系統</span><span class="sxs-lookup"><span data-stu-id="34a67-121">Operating System</span></span>                             | <span data-ttu-id="34a67-122">Location</span><span class="sxs-lookup"><span data-stu-id="34a67-122">Location</span></span>                                                                                                                                                                                                                                   |
    |----------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="34a67-123">Windows XP、Windows Server 2003 及更早版本</span><span class="sxs-lookup"><span data-stu-id="34a67-123">Windows XP, Windows Server 2003, and earlier</span></span> | <span data-ttu-id="34a67-124">CSIDL \_ PROGRAM \_ FILES</span><span class="sxs-lookup"><span data-stu-id="34a67-124">CSIDL\_PROGRAM\_FILES</span></span>                                                                                                                                                                                                                      |
    | <span data-ttu-id="34a67-125">Windows Vista 和更新版本</span><span class="sxs-lookup"><span data-stu-id="34a67-125">Windows Vista and later</span></span>                      | <span data-ttu-id="34a67-126">FOLDERID \_ ProgramFiles、FOLDERID \_ PROGRAMFILESX86、FOLDERID \_ ProgramFilesX64、FOLDERID \_ ProgramFilesCommon、FOLDERID \_ ProgramFilesCommonX86 或 FOLDERID \_ ProgramFilesCommonX64。</span><span class="sxs-lookup"><span data-stu-id="34a67-126">FOLDERID\_ProgramFiles, FOLDERID\_ProgramFilesX86, FOLDERID\_ProgramFilesX64, FOLDERID\_ProgramFilesCommon, FOLDERID\_ProgramFilesCommonX86, or FOLDERID\_ProgramFilesCommonX64.</span></span> <span data-ttu-id="34a67-127">如需詳細資訊，請參閱 [**KNOWNFOLDERID**](knownfolderid.md) 。</span><span class="sxs-lookup"><span data-stu-id="34a67-127">See [**KNOWNFOLDERID**](knownfolderid.md) for specifics.</span></span> |

    

     

-   <span data-ttu-id="34a67-128">請勿在 [Program Files] 資料夾下儲存使用者資料。</span><span class="sxs-lookup"><span data-stu-id="34a67-128">Do not store user data under the Program Files folder.</span></span>

    <span data-ttu-id="34a67-129">針對所有使用者通用的資料使用適當的 [資料] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="34a67-129">Use the appropriate data folder for data that is common to all users.</span></span>

    

    | <span data-ttu-id="34a67-130">作業系統</span><span class="sxs-lookup"><span data-stu-id="34a67-130">Operating System</span></span>                             | <span data-ttu-id="34a67-131">Location</span><span class="sxs-lookup"><span data-stu-id="34a67-131">Location</span></span>               |
    |----------------------------------------------|------------------------|
    | <span data-ttu-id="34a67-132">Windows XP、Windows Server 2003 及更早版本</span><span class="sxs-lookup"><span data-stu-id="34a67-132">Windows XP, Windows Server 2003, and earlier</span></span> | <span data-ttu-id="34a67-133">CSIDL \_ 一般 \_ APPDATA</span><span class="sxs-lookup"><span data-stu-id="34a67-133">CSIDL\_COMMON\_APPDATA</span></span> |
    | <span data-ttu-id="34a67-134">Windows Vista 和更新版本</span><span class="sxs-lookup"><span data-stu-id="34a67-134">Windows Vista and later</span></span>                      | <span data-ttu-id="34a67-135">FOLDERID \_ ProgramData</span><span class="sxs-lookup"><span data-stu-id="34a67-135">FOLDERID\_ProgramData</span></span>  |

    

     

    <span data-ttu-id="34a67-136">針對屬於特定使用者的資料，請使用適當的使用者資料檔案夾。</span><span class="sxs-lookup"><span data-stu-id="34a67-136">Use the appropriate user data folder for data that belongs to a particular user.</span></span>

    

    | <span data-ttu-id="34a67-137">作業系統</span><span class="sxs-lookup"><span data-stu-id="34a67-137">Operating System</span></span>                             | <span data-ttu-id="34a67-138">Location</span><span class="sxs-lookup"><span data-stu-id="34a67-138">Location</span></span>                                                   |
    |----------------------------------------------|------------------------------------------------------------|
    | <span data-ttu-id="34a67-139">Windows XP、Windows Server 2003 及更早版本</span><span class="sxs-lookup"><span data-stu-id="34a67-139">Windows XP, Windows Server 2003, and earlier</span></span> | <span data-ttu-id="34a67-140">CSIDL \_ APPDATA、CSIDL \_ PERSONAL 及其他。</span><span class="sxs-lookup"><span data-stu-id="34a67-140">CSIDL\_APPDATA, CSIDL\_PERSONAL, and others.</span></span>               |
    | <span data-ttu-id="34a67-141">Windows Vista 和更新版本</span><span class="sxs-lookup"><span data-stu-id="34a67-141">Windows Vista and later</span></span>                      | <span data-ttu-id="34a67-142">FOLDERID \_ RoamingAppData、FOLDERID \_ 檔和其他檔。</span><span class="sxs-lookup"><span data-stu-id="34a67-142">FOLDERID\_RoamingAppData, FOLDERID\_Documents, and others.</span></span> |

    

     

-   <span data-ttu-id="34a67-143">如果您必須將安裝到 [Program Files] 資料夾以外的位置，請確定您已正確設定 (Acl 的存取控制清單) ，讓使用者無法存取檔案系統的不當部分。</span><span class="sxs-lookup"><span data-stu-id="34a67-143">If you must install to a location other than the Program Files folder, make sure that you set access control lists (ACLs) properly so that users do not have access to inappropriate parts of the file system.</span></span> <span data-ttu-id="34a67-144">特定使用者專屬的任何資料都應該有 ACL，以防止其他使用者存取它。</span><span class="sxs-lookup"><span data-stu-id="34a67-144">Any data that is specific to a particular user should have an ACL that prevents any other user from accessing it.</span></span>
-   <span data-ttu-id="34a67-145">當您設定檔案關聯時，請務必適當地指定命令列。</span><span class="sxs-lookup"><span data-stu-id="34a67-145">When you set up file associations, be sure to properly specify the command line.</span></span> <span data-ttu-id="34a67-146">使用完整路徑，並以引號括住包含空格的任何元素。</span><span class="sxs-lookup"><span data-stu-id="34a67-146">Use a fully qualified path and wrap any elements that contain white space in quotation marks.</span></span> <span data-ttu-id="34a67-147">以個別的引號括住命令參數。</span><span class="sxs-lookup"><span data-stu-id="34a67-147">Wrap command parameters in separate quotation marks.</span></span> <span data-ttu-id="34a67-148">否則，字串可能會不正確地剖析，而且應用程式將無法正常啟動。</span><span class="sxs-lookup"><span data-stu-id="34a67-148">Otherwise, the string might be incorrectly parsed and the application will not launch properly.</span></span> <span data-ttu-id="34a67-149">這裡顯示正確格式命令列的兩個範例。</span><span class="sxs-lookup"><span data-stu-id="34a67-149">Two examples of properly formed command lines are shown here.</span></span>

    ```
    "C:\Program Files\MyApp\MyApp.exe" "%1" "%2"
    C:\MyAppDir\MyApp\MyApp.exe "%1"
    ```

    

> [!Note]  
> <span data-ttu-id="34a67-150">標準安裝資料夾的位置可能會因系統而異。</span><span class="sxs-lookup"><span data-stu-id="34a67-150">The location of the standard installation folders might vary from system to system.</span></span> <span data-ttu-id="34a67-151">若要在特定的 Windows Vista 或更新版本的系統上取得標準資料夾的位置，請使用適當的 [**KNOWNFOLDERID**](knownfolderid.md)值來呼叫 [**SHGetKnownFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath) 。</span><span class="sxs-lookup"><span data-stu-id="34a67-151">To get the location of a standard folder on a particular Windows Vista or later system, call [**SHGetKnownFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath) with the appropriate [**KNOWNFOLDERID**](knownfolderid.md) value.</span></span> <span data-ttu-id="34a67-152">在 Windows XP、Windows Server 2003 或舊版的系統中，使用適當的 [**CSIDL**](csidl.md)值來呼叫 [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)或 [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) 。</span><span class="sxs-lookup"><span data-stu-id="34a67-152">In Windows XP, Windows Server 2003, or earlier systems, call [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with the appropriate [**CSIDL**](csidl.md) value.</span></span>

 

## <a name="shlwapi"></a><span data-ttu-id="34a67-153">Shlwapi</span><span class="sxs-lookup"><span data-stu-id="34a67-153">Shlwapi</span></span>

<span data-ttu-id="34a67-154">Shell 輕量 API (Shlwapi) 包含許多字串操作函數。</span><span class="sxs-lookup"><span data-stu-id="34a67-154">The Shell Lightweight API (Shlwapi) includes a number of string manipulation functions.</span></span> <span data-ttu-id="34a67-155">不當使用這些函式可能會導致意外截斷的字串，而不會傳回截斷的通知。</span><span class="sxs-lookup"><span data-stu-id="34a67-155">Using these functions incorrectly can lead to unexpectedly truncated strings with no notification of the truncation being returned.</span></span> <span data-ttu-id="34a67-156">在下列情況下，不應該使用 Shlwapi 函數。</span><span class="sxs-lookup"><span data-stu-id="34a67-156">In the following cases, the Shlwapi functions should not be used.</span></span> <span data-ttu-id="34a67-157">列出的替代函式（有較少的風險）應該在其位置使用。</span><span class="sxs-lookup"><span data-stu-id="34a67-157">The listed alternative functions, which pose fewer risks, should be used in their place.</span></span>



| <span data-ttu-id="34a67-158">Shlwapi 函式</span><span class="sxs-lookup"><span data-stu-id="34a67-158">Shlwapi Function</span></span>                                                 | <span data-ttu-id="34a67-159">替代函數</span><span class="sxs-lookup"><span data-stu-id="34a67-159">Alternative Function</span></span>                                                                                             |
|------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="34a67-160">[**StrCat**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcatw)、[**StrNCat**](/windows/desktop/api/Shlwapi/nf-shlwapi-strncata)</span><span class="sxs-lookup"><span data-stu-id="34a67-160">[**StrCat**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcatw),[**StrNCat**](/windows/desktop/api/Shlwapi/nf-shlwapi-strncata)</span></span>              | <span data-ttu-id="34a67-161">[**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata)、 [**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata) 和相關函數</span><span class="sxs-lookup"><span data-stu-id="34a67-161">[**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata) and related functions</span></span>             |
| <span data-ttu-id="34a67-162">[**StrCpy**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpyw)、 [ **StrCpyN**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpynw)</span><span class="sxs-lookup"><span data-stu-id="34a67-162">[**StrCpy**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpyw), [**StrCpyN**](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpynw)</span></span>             | <span data-ttu-id="34a67-163">[**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya)、 [**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) 和相關函數</span><span class="sxs-lookup"><span data-stu-id="34a67-163">[**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) and related functions</span></span>         |
| <span data-ttu-id="34a67-164">[**wnsprintf**](/windows/desktop/api/Shlwapi/nf-shlwapi-wnsprintfa)、 [ **wvnsprintf**](/windows/desktop/api/Shlwapi/nf-shlwapi-wvnsprintfa)</span><span class="sxs-lookup"><span data-stu-id="34a67-164">[**wnsprintf**](/windows/desktop/api/Shlwapi/nf-shlwapi-wnsprintfa), [**wvnsprintf**](/windows/desktop/api/Shlwapi/nf-shlwapi-wvnsprintfa)</span></span> | <span data-ttu-id="34a67-165">[**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa)、 [**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa) 和相關函數</span><span class="sxs-lookup"><span data-stu-id="34a67-165">[**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa) and related functions</span></span> |



 

<span data-ttu-id="34a67-166">使用會傳回檔案路徑的函式（例如 [**pathrelativepathto 式**](/windows/desktop/api/Shlwapi/nf-shlwapi-pathrelativepathtoa) ），一律將緩衝區的大小設定為最大 \_ 路徑字元。</span><span class="sxs-lookup"><span data-stu-id="34a67-166">With functions such as [**PathRelativePathTo**](/windows/desktop/api/Shlwapi/nf-shlwapi-pathrelativepathtoa) that return a file path, always set the size of the buffer to MAX\_PATH characters.</span></span> <span data-ttu-id="34a67-167">這麼做可確保緩衝區夠大，足以容納最大的可能檔案路徑，再加上終止的 null 字元。</span><span class="sxs-lookup"><span data-stu-id="34a67-167">Doing so ensures that the buffer is large enough to hold the largest possible file path, plus a terminating null character.</span></span>

<span data-ttu-id="34a67-168">如需有關替代字串函數的詳細資訊，請參閱[關於 >strsafe.h。](../menurc/strsafe-ovw.md)</span><span class="sxs-lookup"><span data-stu-id="34a67-168">For more information on the alternative string functions, see [About Strsafe.h](../menurc/strsafe-ovw.md).</span></span>

## <a name="autocomplete"></a><span data-ttu-id="34a67-169">自動完成</span><span class="sxs-lookup"><span data-stu-id="34a67-169">Autocomplete</span></span>

<span data-ttu-id="34a67-170">請勿使用密碼的自動完成功能。</span><span class="sxs-lookup"><span data-stu-id="34a67-170">Do not use the Autocomplete feature for passwords.</span></span>

## <a name="shellexecute-shellexecuteex-and-related-functions"></a><span data-ttu-id="34a67-171">ShellExecute、ShellExecuteEx 和相關函數</span><span class="sxs-lookup"><span data-stu-id="34a67-171">ShellExecute, ShellExecuteEx, and Related Functions</span></span>

<span data-ttu-id="34a67-172">您可以使用數個 Shell 函數來啟動應用程式： [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea)、 [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa)、 [**WinExec**](/windows/win32/api/winbase/nf-winbase-winexec)和 [**SHCreateProcessAsUserW**](/windows/desktop/api/Shellapi/nf-shellapi-shcreateprocessasuserw)。</span><span class="sxs-lookup"><span data-stu-id="34a67-172">There are several Shell functions that you can use to launch applications: [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea), [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa), [**WinExec**](/windows/win32/api/winbase/nf-winbase-winexec), and [**SHCreateProcessAsUserW**](/windows/desktop/api/Shellapi/nf-shellapi-shcreateprocessasuserw).</span></span> <span data-ttu-id="34a67-173">請確定您為要執行的應用程式提供明確的定義。</span><span class="sxs-lookup"><span data-stu-id="34a67-173">Make sure you provide an unambiguous definition of the application that is to be executed.</span></span>

-   <span data-ttu-id="34a67-174">提供可執行檔的路徑時，請提供完整路徑。</span><span class="sxs-lookup"><span data-stu-id="34a67-174">When providing the executable file's path, provide the fully qualified path.</span></span> <span data-ttu-id="34a67-175">請勿依賴 Shell 來尋找檔案。</span><span class="sxs-lookup"><span data-stu-id="34a67-175">Do not depend on the Shell to locate the file.</span></span>
-   <span data-ttu-id="34a67-176">如果您提供的命令列字串包含空白字元，請使用引號括住字串。</span><span class="sxs-lookup"><span data-stu-id="34a67-176">If you provide a command-line string that contains white space, wrap the string in quotation marks.</span></span> <span data-ttu-id="34a67-177">否則，剖析器可能會將包含空格的單一元素解釋為多個元素。</span><span class="sxs-lookup"><span data-stu-id="34a67-177">Otherwise, the parser might interpret a single element that contains spaces as multiple elements.</span></span>

## <a name="moving-and-copying-files"></a><span data-ttu-id="34a67-178">移動和複製檔案</span><span class="sxs-lookup"><span data-stu-id="34a67-178">Moving and Copying Files</span></span>

<span data-ttu-id="34a67-179">系統安全性的一個關鍵就是正確指派 Acl。</span><span class="sxs-lookup"><span data-stu-id="34a67-179">One key to system security is properly assigning ACLs.</span></span> <span data-ttu-id="34a67-180">您也可以使用加密的檔案。</span><span class="sxs-lookup"><span data-stu-id="34a67-180">You also might use encrypted files.</span></span> <span data-ttu-id="34a67-181">當您移動或複製檔案時，請確定它們已獲指派正確的 ACL，而且未不慎解密。</span><span class="sxs-lookup"><span data-stu-id="34a67-181">Make sure that when you move or copy files, that they are assigned the correct ACL and that they have not been accidentally decrypted.</span></span> <span data-ttu-id="34a67-182">這包括將檔案移至 **資源回收筒** 以及檔案系統中。</span><span class="sxs-lookup"><span data-stu-id="34a67-182">This includes moving files to the **Recycle Bin**, as well as within the file system.</span></span> <span data-ttu-id="34a67-183">使用 [**IFileOperation**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileoperation) (windows Vista 或更新版本) 或 [**SHFILEOPERATION**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) (windows XP 及更早的) 。</span><span class="sxs-lookup"><span data-stu-id="34a67-183">Use [**IFileOperation**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileoperation) (Windows Vista or later) or [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) (Windows XP and earlier).</span></span> <span data-ttu-id="34a67-184">請勿使用 [**MoveFile**](/windows/win32/api/winbase/nf-winbase-movefile)，這可能不會為目的地檔案設定預期的 ACL。</span><span class="sxs-lookup"><span data-stu-id="34a67-184">Do not use [**MoveFile**](/windows/win32/api/winbase/nf-winbase-movefile), which might not set the expected ACL for the destination file.</span></span>

## <a name="writing-secure-namespace-extensions"></a><span data-ttu-id="34a67-185">撰寫安全的命名空間延伸模組</span><span class="sxs-lookup"><span data-stu-id="34a67-185">Writing Secure Namespace Extensions</span></span>

<span data-ttu-id="34a67-186">Shell 命名空間延伸模組是將資料呈現給使用者的功能強大且有彈性的方式。</span><span class="sxs-lookup"><span data-stu-id="34a67-186">Shell namespace extensions are a powerful and flexible way to present data to the user.</span></span> <span data-ttu-id="34a67-187">但是，如果未正確寫入，它們可能會導致系統失敗。</span><span class="sxs-lookup"><span data-stu-id="34a67-187">However, they can cause system failure if they are not correctly written.</span></span> <span data-ttu-id="34a67-188">以下是一些要牢記在心的重點：</span><span class="sxs-lookup"><span data-stu-id="34a67-188">Some key points to keep in mind:</span></span>

-   <span data-ttu-id="34a67-189">請勿假設影像之類的資料已正確格式化。</span><span class="sxs-lookup"><span data-stu-id="34a67-189">Do not assume that data such as images are formatted correctly.</span></span>
-   <span data-ttu-id="34a67-190">請勿假設最大 \_ 路徑相當於字串中的 *位元組* 數目。</span><span class="sxs-lookup"><span data-stu-id="34a67-190">Do not assume that MAX\_PATH is equivalent to the number of *bytes* in a string.</span></span> <span data-ttu-id="34a67-191">這是 *字元* 數。</span><span class="sxs-lookup"><span data-stu-id="34a67-191">It is the number of *characters*.</span></span>

## <a name="security-alerts"></a><span data-ttu-id="34a67-192">安全性警示</span><span class="sxs-lookup"><span data-stu-id="34a67-192">Security Alerts</span></span>

<span data-ttu-id="34a67-193">下表列出某些功能（如果使用不正確），會危及應用程式的安全性。</span><span class="sxs-lookup"><span data-stu-id="34a67-193">The following table lists some features that can, if used incorrectly, compromise the security of your applications.</span></span>



| <span data-ttu-id="34a67-194">功能</span><span class="sxs-lookup"><span data-stu-id="34a67-194">Feature</span></span>                                                                        | <span data-ttu-id="34a67-195">降低</span><span class="sxs-lookup"><span data-stu-id="34a67-195">Mitigation</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="34a67-196">[**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea)、 [ **ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa)</span><span class="sxs-lookup"><span data-stu-id="34a67-196">[**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea), [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa)</span></span> | <span data-ttu-id="34a67-197">相依于檢查一連串預設位置以尋找特定檔案的搜尋，可以在詐騙攻擊中使用。</span><span class="sxs-lookup"><span data-stu-id="34a67-197">Searches that depend on checking a series of default locations to find a specific file can be used in a spoofing attack.</span></span> <span data-ttu-id="34a67-198">使用完整路徑，以確保您可以存取所需的檔案。</span><span class="sxs-lookup"><span data-stu-id="34a67-198">Use a fully qualified path to ensure that you access the desired file.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="34a67-199">**StrCat**</span><span class="sxs-lookup"><span data-stu-id="34a67-199">**StrCat**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strcatw)                                                       | <span data-ttu-id="34a67-200">第一個引數 *psz1* 必須夠大，才能容納 *psz2* 和結尾 ' \\ 0 '，否則可能會發生緩衝區溢位。</span><span class="sxs-lookup"><span data-stu-id="34a67-200">The first argument, *psz1*, must be large enough to hold *psz2* and the closing '\\0', otherwise a buffer overrun might occur.</span></span> <span data-ttu-id="34a67-201">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-201">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-202">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata)、 [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa)、 [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna)、 [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa)、 [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata)、 [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)、 [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna)或 [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-202">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata), [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa), [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna), [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa), [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa), [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna), or [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa).</span></span>                                                                                                                                                             |
| [<span data-ttu-id="34a67-203">**StrCatBuff**</span><span class="sxs-lookup"><span data-stu-id="34a67-203">**StrCatBuff**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strcatbuffa)                                               | <span data-ttu-id="34a67-204">最終字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-204">The final string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-205">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-205">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-206">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata)、 [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa)、 [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna)、 [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa)、 [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata)、 [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)、 [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna)或 [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-206">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata), [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa), [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna), [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa), [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa), [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna), or [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa).</span></span>                                                                                                                                                                                                                                  |
| [<span data-ttu-id="34a67-207">**StrCatChainW**</span><span class="sxs-lookup"><span data-stu-id="34a67-207">**StrCatChainW**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strcatchainw)                                           | <span data-ttu-id="34a67-208">最終字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-208">The final string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-209">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-209">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-210">[**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa)、 [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa)、 [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)或 [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-210">[**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa), [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa), [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa), or [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="34a67-211">**StrCpy**</span><span class="sxs-lookup"><span data-stu-id="34a67-211">**StrCpy**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpyw)                                                       | <span data-ttu-id="34a67-212">第一個引數 *psz1* 必須夠大，才能容納 *psz2* 和結尾 ' \\ 0 '，否則可能會發生緩衝區溢位。</span><span class="sxs-lookup"><span data-stu-id="34a67-212">The first argument, *psz1*, must be large enough to hold *psz2* and the closing '\\0', otherwise a buffer overrun might occur.</span></span> <span data-ttu-id="34a67-213">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-213">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-214">[**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya)、 [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa)、 [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna)、 [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa)、 [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya)、 [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa)、 [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna)或 [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-214">[**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya), [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa), [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna), [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa), [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa), [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna), or [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa).</span></span>                                                                                                                                             |
| [<span data-ttu-id="34a67-215">**StrCpyN**</span><span class="sxs-lookup"><span data-stu-id="34a67-215">**StrCpyN**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strcpynw)                                                     | <span data-ttu-id="34a67-216">複製的字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-216">The copied string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-217">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-217">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-218">[**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya)、 [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa)、 [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna)、 [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa)、 [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya)、 [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa)、 [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna)、 [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-218">[**StringCbCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya), [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa), [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna), [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa), [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa), [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna), [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa).</span></span>                                                                                                                                                                                                                    |
| [<span data-ttu-id="34a67-219">**StrDup**</span><span class="sxs-lookup"><span data-stu-id="34a67-219">**StrDup**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strdupa)                                                       | <span data-ttu-id="34a67-220">[**StrDup**](/windows/desktop/api/Shlwapi/nf-shlwapi-strdupa) 假設 *lpsz* 是以 null 終止的字串。</span><span class="sxs-lookup"><span data-stu-id="34a67-220">[**StrDup**](/windows/desktop/api/Shlwapi/nf-shlwapi-strdupa) assumes that *lpsz* is a null-terminated string.</span></span> <span data-ttu-id="34a67-221">此外，傳回的字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-221">Further, the returned string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-222">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-222">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-223">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata)、 [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa)、 [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna)、 [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa)、 [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya)、 [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa)、 [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna)或 [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-223">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata), [**StringCbCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyexa), [**StringCbCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopyna), [**StringCbCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopynexa), [**StringCchCopy**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopya), [**StringCchCopyEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyexa), [**StringCchCopyN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopyna), or [**StringCchCopyNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcopynexa).</span></span>                                                                                                                              |
| [<span data-ttu-id="34a67-224">**StrNCat**</span><span class="sxs-lookup"><span data-stu-id="34a67-224">**StrNCat**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-strncata)                                                     | <span data-ttu-id="34a67-225">第一個引數 *pszFront* 必須夠大，才能容納 *pszBack* 和結尾 ' \\ 0 '，否則可能會發生緩衝區溢位。</span><span class="sxs-lookup"><span data-stu-id="34a67-225">The first argument, *pszFront*, must be large enough to hold *pszBack* and the closing '\\0', otherwise a buffer overrun might occur.</span></span> <span data-ttu-id="34a67-226">請注意，最後一個引數 *cchMax* 是要複製到 *pszFront* 中的字元數，而不一定是 *pszFront* 的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="34a67-226">Be aware that the last argument, *cchMax*, is the number of characters to copy into *pszFront*, not necessarily the size of the *pszFront* in bytes.</span></span> <span data-ttu-id="34a67-227">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-227">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-228">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata)、 [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa)、 [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna)、 [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa)、 [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata)、 [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa)、 [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna)或 [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-228">[**StringCbCat**](/windows/win32/api/strsafe/nf-strsafe-stringcbcata), [**StringCbCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatexa), [**StringCbCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatna), [**StringCbCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbcatnexa), [**StringCchCat**](/windows/win32/api/strsafe/nf-strsafe-stringcchcata), [**StringCchCatEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatexa), [**StringCchCatN**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatna), or [**StringCchCatNEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchcatnexa).</span></span> |
| [<span data-ttu-id="34a67-229">**wnsprintf**</span><span class="sxs-lookup"><span data-stu-id="34a67-229">**wnsprintf**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-wnsprintfa)                                                 | <span data-ttu-id="34a67-230">複製的字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-230">The copied string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-231">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-231">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-232">[**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa)、 [**StringCbPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfexa)、 [**StringCbVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfa)、 [**StringCbVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfexa)、 [**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa)、 [**StringCchPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfexa)、 [**StringCchVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfa)或 [**StringCchVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-232">[**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa), [**StringCbPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfexa), [**StringCbVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfa), [**StringCbVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfexa), [**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfa), or [**StringCchVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfexa).</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="34a67-233">**wvnsprintf**</span><span class="sxs-lookup"><span data-stu-id="34a67-233">**wvnsprintf**</span></span>](/windows/desktop/api/Shlwapi/nf-shlwapi-wvnsprintfa)                                               | <span data-ttu-id="34a67-234">複製的字串不保證會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="34a67-234">The copied string is not guaranteed to be null-terminated.</span></span> <span data-ttu-id="34a67-235">請改用下列其中一個替代方案。</span><span class="sxs-lookup"><span data-stu-id="34a67-235">Use one of the following alternatives instead.</span></span> <span data-ttu-id="34a67-236">[**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa)、 [**StringCbPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfexa)、 [**StringCbVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfa)、 [**StringCbVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfexa)、 [**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa)、 [**StringCchPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfexa)、 [**StringCchVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfa)或 [**StringCchVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfexa)。</span><span class="sxs-lookup"><span data-stu-id="34a67-236">[**StringCbPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfa), [**StringCbPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbprintfexa), [**StringCbVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfa), [**StringCbVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcbvprintfexa), [**StringCchPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfa), or [**StringCchVPrintfEx**](/windows/win32/api/strsafe/nf-strsafe-stringcchvprintfexa).</span></span>                                                                                                                                                                                 |



 

## <a name="related-topics"></a><span data-ttu-id="34a67-237">相關主題</span><span class="sxs-lookup"><span data-stu-id="34a67-237">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="34a67-238">Microsoft 安全性</span><span class="sxs-lookup"><span data-stu-id="34a67-238">Microsoft Security</span></span>](https://www.microsoft.com/security/default.aspx)
</dt> <dt>

[<span data-ttu-id="34a67-239">安全性開發人員中心</span><span class="sxs-lookup"><span data-stu-id="34a67-239">Security Developer Center</span></span>](https://msdn.microsoft.com/security/)
</dt> <dt>

<span data-ttu-id="34a67-240">[Microsoft Solution Accelerator](/previous-versions/tn-archive/cc936627(v=technet.10))</span><span class="sxs-lookup"><span data-stu-id="34a67-240">[Microsoft Solution Accelerators](/previous-versions/tn-archive/cc936627(v=technet.10))</span></span>
</dt> <dt>

[<span data-ttu-id="34a67-241">資訊安全技術中心</span><span class="sxs-lookup"><span data-stu-id="34a67-241">Security TechCenter</span></span>](https://technet.microsoft.com/security/default.aspx)
</dt> <dt>

[<span data-ttu-id="34a67-242">關於 >strsafe.h。h</span><span class="sxs-lookup"><span data-stu-id="34a67-242">About Strsafe.h</span></span>](../menurc/strsafe-ovw.md)
</dt> </dl>

 

 
