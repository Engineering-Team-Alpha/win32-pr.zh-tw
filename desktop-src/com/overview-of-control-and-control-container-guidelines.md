---
title: 控制和控制容器指導方針
description: 控制和控制容器指導方針
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/29/2020
ms.locfileid: "103679567"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="fdf02-103">控制和控制容器指導方針</span><span class="sxs-lookup"><span data-stu-id="fdf02-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="fdf02-104">ActiveX 控制項基本上是簡單的 OLE 物件，可支援 [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) 介面。</span><span class="sxs-lookup"><span data-stu-id="fdf02-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="fdf02-105">它通常會支援更多介面以提供功能，但所有其他介面可能會被視為選擇性，因此控制項容器不應依賴任何其他支援的介面。</span><span class="sxs-lookup"><span data-stu-id="fdf02-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="fdf02-106">藉由不指定控制項必須支援的其他介面，控制項可以有效率地鎖定特定功能區域，而不需要支援特定的介面來作為控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf02-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="fdf02-107">如同使用 OLE，無論是在控制項或控制項容器中，絕對不應該假設介面可供使用，而且應該一律遵循標準的傳回檢查慣例。</span><span class="sxs-lookup"><span data-stu-id="fdf02-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="fdf02-108">如果無法使用所需的介面，控制項或控制容器必須正常地降級，並提供替代功能。</span><span class="sxs-lookup"><span data-stu-id="fdf02-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="fdf02-109">ActiveX 控制項容器必須能夠裝載基本的 ActiveX 控制項;它也會支援 [容器](containers.md)中指定的一些額外介面。</span><span class="sxs-lookup"><span data-stu-id="fdf02-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="fdf02-110">容器可以選擇性地支援許多介面和方法，這些介面和方法會分組為稱為 *元件類別* 的功能區域。</span><span class="sxs-lookup"><span data-stu-id="fdf02-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="fdf02-111">容器可支援元件類別的任何組合，例如，資料系結的元件類別存在，而且容器可能會支援資料系結功能，視容器的市場需求而定。</span><span class="sxs-lookup"><span data-stu-id="fdf02-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="fdf02-112">如果控制項需要容器的資料系結支援來運作，則會在登錄中輸入此需求。</span><span class="sxs-lookup"><span data-stu-id="fdf02-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="fdf02-113">如此一來，控制項容器就只能插入其知道可以成功裝載的控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf02-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="fdf02-114">請務必注意，元件類別會指定為 OLE 的一部分，而且並非 ActiveX 控制項專用，而控制項架構會使用元件類別來識別 OLE 元件可能支援的功能區域。</span><span class="sxs-lookup"><span data-stu-id="fdf02-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="fdf02-115">元件類別並非累積或排除，因此控制項容器可以支援一個類別，而不一定支援另一個類別。</span><span class="sxs-lookup"><span data-stu-id="fdf02-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="fdf02-116">對於需要選擇性功能的控制項而言很重要，或特定容器的特定功能必須清楚地封裝並隨這些需求行銷。</span><span class="sxs-lookup"><span data-stu-id="fdf02-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="fdf02-117">同樣地，提供特定功能或元件類別的容器，必須在裝載 ActiveX 控制項時，以提供這些支援層級的方式進行行銷和封裝。</span><span class="sxs-lookup"><span data-stu-id="fdf02-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="fdf02-118">如果無法使用介面或方法，建議控制項盡可能以最多的容器做為目標和測試，並可正常地降級以提供較少或替代的功能。</span><span class="sxs-lookup"><span data-stu-id="fdf02-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="fdf02-119">如果控制項無法在不支援元件類別的情況下執行其指定的工作函式，則應該在登錄中輸入該類別做為需求，以防止控制項插入不適當的容器中。</span><span class="sxs-lookup"><span data-stu-id="fdf02-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="fdf02-120">這些指導方針會定義控制項可能會預期控制項容器可支援的介面和方法，不過當您在使用 [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) 或其他方法來取得這些介面的指標時，一定會有控制項檢查傳回值。</span><span class="sxs-lookup"><span data-stu-id="fdf02-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="fdf02-121">容器不應預期控制項支援超過 [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) 介面的任何內容，而且這些指導方針會識別控制項可支援的介面，以及特定介面的存在意義。</span><span class="sxs-lookup"><span data-stu-id="fdf02-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="fdf02-122">ActiveX 控制項和控制項容器指導方針的重要性</span><span class="sxs-lookup"><span data-stu-id="fdf02-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="fdf02-123">ActiveX 控制項已成為開發可程式化軟體元件的主要架構，可用於各種不同的容器，範圍從軟體發展工具到使用者生產力工具。</span><span class="sxs-lookup"><span data-stu-id="fdf02-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="fdf02-124">為了讓控制項可在各種不同的容器中運作正常，控制項必須能夠假設它可在所有容器中使用的最低層級功能。</span><span class="sxs-lookup"><span data-stu-id="fdf02-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="fdf02-125">藉由遵循這些指導方針，控制項和容器開發人員可讓其控制項和容器更可靠且互通，最後是更好且更有用的元件來建立以元件為基礎的解決方案。</span><span class="sxs-lookup"><span data-stu-id="fdf02-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="fdf02-126">當您需要的介面無法使用時該怎麼辦</span><span class="sxs-lookup"><span data-stu-id="fdf02-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="fdf02-127">OLE 程式應該使用 [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) 來取得介面指標，而且必須檢查傳回值。</span><span class="sxs-lookup"><span data-stu-id="fdf02-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="fdf02-128">OLE 應用程式無法安全地假設 **QueryInterface** 會成功。</span><span class="sxs-lookup"><span data-stu-id="fdf02-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="fdf02-129">這項需求適用于所有的 OLE 應用程式。</span><span class="sxs-lookup"><span data-stu-id="fdf02-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="fdf02-130">如果要求的介面無法使用 (也就是說， [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) 會傳回 E \_ NOINTERFACE) ，則控制項或容器必須正常地降級，即使這表示它無法執行其指定的工作函式。</span><span class="sxs-lookup"><span data-stu-id="fdf02-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fdf02-131">相關主題</span><span class="sxs-lookup"><span data-stu-id="fdf02-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fdf02-132">ActiveX 控制項和控制項容器指導方針</span><span class="sxs-lookup"><span data-stu-id="fdf02-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




